{"version":3,"file":"main.js","mappings":"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","sources":["./projects/reactome-cytoscape-style/src/lib/model/reactome-event.model.ts","./projects/reactome-cytoscape-style/src/lib/properties-utils.ts","./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/diagram-iterator/diagram-iterator.component.ts","./src/app/diagram-iterator/diagram-iterator.component.html","./src/app/diagram/diagram.component.ts","./src/app/diagram/diagram.component.html","./src/app/guard/legacy.guard.ts","./src/app/interactors/common/overlay-resource.ts","./src/app/interactors/custom-interactor-dialog/custom-interactor-dialog.component.ts","./src/app/interactors/custom-interactor-dialog/custom-interactor-dialog.component.html","./src/app/interactors/layout/interactors-layout.ts","./src/app/interactors/model/interactor-entity.model.ts","./src/app/interactors/services/interactor.service.ts","./src/app/services/analysis.service.ts","./src/app/services/dark.service.ts","./src/app/services/diagram-state.service.ts","./src/app/services/diagram.service.ts","./src/app/services/utils.ts","./src/environments/environment.development.ts","./src/main.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/gene-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/molecule-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/protein-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/rna-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/gee-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/complex-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/entity-sets-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/cell-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/interacting-pathway-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/disease-interactor-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/shape/sub-pathway-shape.ts","./projects/reactome-cytoscape-style/src/lib/drawer/image-builder.ts","./projects/reactome-cytoscape-style/src/lib/properties.ts","./projects/reactome-cytoscape-style/src/lib/interactivity.ts","./projects/reactome-cytoscape-style/src/lib/style.ts","./projects/reactome-cytoscape-style/src/public-api.ts","./projects/reactome-cytoscape-style/src/reactome-cytoscape-style.ts"],"sourcesContent":["import cytoscape from \"cytoscape\";\n\nexport interface ReactomeEventTarget {\n  reactomeId: string,\n  type: 'PhysicalEntity' | 'Pathway' | 'reaction' | 'Interactor' | 'Any',\n  element: cytoscape.NodeSingular,\n  cy: cytoscape.Core\n}\n\nexport enum ReactomeEventTypes {\n  hover = 'reactome::hover',\n  leave = 'reactome::leave',\n\n  select = 'reactome::select',\n  unselect = 'reactome::unselect',\n\n  open = 'reactome::open',\n  close = 'reactome::close',\n}\n\nexport class ReactomeEvent extends CustomEvent<ReactomeEventTarget> {\n  constructor(type: ReactomeEventTypes, target: ReactomeEventTarget) {\n    super(type, {detail: target});\n  }\n\n}\n","import {Properties} from \"./properties\";\n\nexport type Provider<T> = () => T;\n\nexport type Property<T> = T | Provider<T>;\n\n/**\n * This is a guard function to check if a property is a Provider function, or a direct value\n *\n * @param property The value to check\n * @return true if is a Provider function\n */\nexport function isProvider<T>(property: Property<T>): property is Provider<T> {\n  return (property as Provider<T>).apply !== undefined;\n}\n\n/**\n * This function extracts the value from a property, and if the property is a Provider<T>, it calls the property function to get the actual value.\n *\n * @param property A value of type Property<T>.\n */\nexport function extract<T>(property: Property<T>): T {\n  return isProvider(property) ? property() : property;\n}\n\nexport type PropertiesType = {\n  [k: string]: Property<any>\n}\n\nexport type Defaultable<T, K extends keyof T = never> = T & {\n  setDefault<KA extends keyof T, VA extends T[KA]>(key: KA, defaultValue: VA): Defaultable<T, K | KA>;\n} & {\n  [P in K]-?: T[P];\n}\n\n\nexport function defaultable<T>(object: T): Defaultable<T> {\n  const defaultable = (object) as Defaultable<T>;\n\n  defaultable.setDefault = function <K extends keyof T, KA extends keyof T, VA extends T[KA]>(this: Defaultable<T, K>, key: KA, defaultValue: VA): Defaultable<T, K | KA> {\n    if (!object[key]) object[key] = defaultValue;\n    return defaultable as Defaultable<T, K | KA>;\n  };\n\n  return defaultable;\n}\n\nexport const propertyExtractor = (properties: Properties) => <G extends keyof Properties, K extends keyof Properties[G]>(group: G, key: K) => properties[group][key]\nexport const propertyMapper = (properties: Properties) => <G extends keyof Properties, K extends keyof Properties[G], T extends Properties[G][K] extends Property<infer X> ? X : never, M extends (t: T) => any>(group: G, key: K, mapper: M) => mapper(extract(properties[group][key]))\n\n\n","import {RouterModule, Routes} from \"@angular/router\";\nimport {NgModule} from \"@angular/core\";\nimport {DiagramComponent} from \"./diagram/diagram.component\";\nimport {DiagramIteratorComponent} from \"./diagram-iterator/diagram-iterator.component\";\nimport {legacyGuard} from \"./guard/legacy.guard\";\n\nexport const routes: Routes = [\n  {path: 'iterate', component: DiagramIteratorComponent},\n  {path: 'iterate/:id', component: DiagramIteratorComponent, },\n  {path: ':id', component: DiagramComponent},\n  {path: '**', component: DiagramComponent,  canActivate: [legacyGuard], runGuardsAndResolvers: 'always'}\n]\n\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes, {bindToComponentInputs: true})],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import {Component} from '@angular/core';\n\n@Component({\n  selector: 'cr-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  title = 'PathwayBrowser'\n}\n","<router-outlet></router-outlet>\n","import {NgModule} from '@angular/core';\nimport {BrowserModule} from '@angular/platform-browser';\n\nimport {AppComponent} from './app.component';\nimport {FormsModule, ReactiveFormsModule} from \"@angular/forms\";\nimport {CommonModule} from \"@angular/common\";\nimport {HttpClientModule} from \"@angular/common/http\";\nimport {DiagramComponent} from './diagram/diagram.component';\nimport {RouterOutlet} from \"@angular/router\";\nimport {AppRoutingModule} from \"./app-routing.module\";\nimport {BrowserAnimationsModule, NoopAnimationsModule} from '@angular/platform-browser/animations';\nimport {MatButtonModule} from \"@angular/material/button\";\nimport {MatSlideToggleModule} from \"@angular/material/slide-toggle\";\nimport {CdkDrag, CdkDragHandle} from \"@angular/cdk/drag-drop\";\nimport {DiagramIteratorComponent} from './diagram-iterator/diagram-iterator.component';\nimport {MatInputModule} from \"@angular/material/input\";\nimport {MatSelectModule} from \"@angular/material/select\";\nimport {MatProgressSpinnerModule} from \"@angular/material/progress-spinner\";\nimport {CustomInteractorDialogComponent } from './interactors/custom-interactor-dialog/custom-interactor-dialog.component';\nimport {MatDialogModule} from \"@angular/material/dialog\";\nimport {MatTabsModule} from \"@angular/material/tabs\";\nimport {MatCheckboxModule} from \"@angular/material/checkbox\";\nimport {MatRadioModule} from \"@angular/material/radio\";\nimport {NgxMatFileInputModule} from \"@angular-material-components/file-input\";\nimport {MatIconModule} from \"@angular/material/icon\";\nimport {MatListModule} from \"@angular/material/list\";\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    DiagramComponent,\n    DiagramIteratorComponent,\n    CustomInteractorDialogComponent\n  ],\n    imports: [\n        BrowserModule,\n        FormsModule,\n        CommonModule,\n        HttpClientModule,\n        RouterOutlet,\n        AppRoutingModule,\n        // NoopAnimationsModule,\n        MatButtonModule,\n        MatSlideToggleModule,\n        CdkDragHandle,\n        CdkDrag,\n        MatInputModule,\n        MatSelectModule,\n        ReactiveFormsModule,\n        MatProgressSpinnerModule,\n        BrowserAnimationsModule,\n        MatDialogModule,\n        MatTabsModule,\n        MatCheckboxModule,\n        MatRadioModule,\n        NgxMatFileInputModule,\n        MatIconModule,\n        MatListModule\n    ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {\n}\n","import {AfterViewInit, Component, ViewChild} from '@angular/core';\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {DiagramComponent} from \"../diagram/diagram.component\";\nimport {combineLatest} from \"rxjs\";\n\n@Component({\n  selector: 'cr-diagram-iterator',\n  templateUrl: './diagram-iterator.component.html',\n  styleUrls: ['./diagram-iterator.component.scss']\n})\nexport class DiagramIteratorComponent implements AfterViewInit {\n\n  @ViewChild('diagram')\n  diagram!: DiagramComponent;\n\n  diagramId: string = '';\n\n  diagramIndex: number = 0;\n  diagramIds: string[] = [];\n\n  constructor(private route: ActivatedRoute, private client: HttpClient, private router: Router) {\n  }\n\n  ngAfterViewInit(): void {\n    combineLatest([\n      this.route.params,\n      this.client.get('/assets/data/diagrams-dev-no-ehld.txt', {responseType: \"text\"})\n    ]).subscribe(([params, diagrams]) => {\n      this.diagramIds = diagrams.split('\\n').filter(s => s.length !== 0);\n      this.diagramId = this.diagramIds[0];\n    })\n  }\n\n  next() {\n    this.diagramIndex++;\n    if (this.diagramIndex > this.diagramIds.length - 1) this.diagramIndex = 0;\n    this.diagramId = this.diagramIds[this.diagramIndex];\n  }\n  previous() {\n    this.diagramIndex--;\n    if (this.diagramIndex < 0) this.diagramIndex = this.diagramIds.length - 1;\n    this.diagramId = this.diagramIds[this.diagramIndex];\n  }\n\n}\n","<div (keydown.arrowLeft)=\"previous()\" (keydown.arrowRight)=\"next()\">\n  <cr-diagram #diagram [id]=\"diagramId\"></cr-diagram>\n\n  <button mat-raised-button (click)=\"previous()\">Previous</button>\n  <mat-form-field>\n    <mat-label>Diagram ID</mat-label>\n    <input matInput placeholder=\"R-HSA-XXXXXXXX\" [(ngModel)]=\"diagramId\">\n  </mat-form-field>\n  <button mat-raised-button (click)=\"next()\">Next</button>\n\n</div>\n\n\n","import {\n  AfterViewInit,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  Input,\n  OnChanges,\n  Output,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport {DiagramService} from \"../services/diagram.service\";\nimport cytoscape from \"cytoscape\";\n// @ts-ignore\nimport {Interactivity, ReactomeEvent, Style} from \"reactome-cytoscape-style\";\nimport {DarkService} from \"../services/dark.service\";\nimport {InteractorService} from \"../interactors/services/interactor.service\";\nimport {delay, distinctUntilChanged, filter, forkJoin, Observable, share, Subject, take, tap} from \"rxjs\";\nimport {ReactomeEventTypes} from \"../../../projects/reactome-cytoscape-style/src/lib/model/reactome-event.model\";\nimport {PsicquicResource, Resource} from \"../interactors/model/interactor-entity.model\";\nimport {MatSelect} from \"@angular/material/select\";\nimport {FormControl} from \"@angular/forms\";\nimport {DiagramStateService} from \"../services/diagram-state.service\";\nimport {UntilDestroy} from \"@ngneat/until-destroy\";\nimport {MatDialog} from \"@angular/material/dialog\";\nimport {\n  CustomInteractorDialogComponent\n} from \"../interactors/custom-interactor-dialog/custom-interactor-dialog.component\";\nimport {ResourceType} from \"../interactors/common/overlay-resource\";\nimport {extract} from \"../../../projects/reactome-cytoscape-style/src/lib/properties-utils\";\nimport {AnalysisService, Examples} from \"../services/analysis.service\";\nimport {Graph} from \"../model/graph.model\";\nimport {isDefined} from \"../services/utils\";\nimport {Analysis} from \"../model/analysis.model\";\nimport {Router} from \"@angular/router\";\n\nimport {brewer, Scale, scale} from \"chroma-js\";\nimport {group, style} from \"@angular/animations\";\nimport {MatFormField} from \"@angular/material/form-field\";\n\ntype Palette = keyof typeof brewer;\n\ntype PaletteGroup = 'sequential' | 'diverging' | 'continuous';\n\n// type PaletteSummary = { name: Palette, scale: Scale, gradient: string };\n\nexport class PaletteSummary {\n  private readonly _scale: Scale;\n  scale: Scale;\n  gradient: string;\n\n  constructor(private name: Palette) {\n    this._scale = scale(name).mode('oklab')\n    this.scale = this._scale\n    this.gradient = `linear-gradient(to right in oklab, ${brewer[this.name].join(', ')})`\n  }\n\n  classes(n: number) {\n    if (n > 0) {\n      this.scale = this._scale.classes(n)\n      this.gradient = `linear-gradient(to right in oklab, ${this.scale.colors(n).map((c, i) => `${c} ${i / n * 100}%, ${c} ${(i + 1) / n * 100}%`).join(', ')})`\n    } else {\n      this.scale = this._scale\n      this.gradient = `linear-gradient(to right in oklab, ${brewer[this.name].join(', ')})`\n    }\n  }\n\n  domain(min: number, max: number) {\n    this.scale = this.scale.domain([min, max])\n  }\n}\n\n@UntilDestroy({checkProperties: true})\n@Component({\n  selector: 'cr-diagram',\n  templateUrl: './diagram.component.html',\n  styleUrls: ['./diagram.component.scss']\n})\nexport class DiagramComponent implements AfterViewInit, OnChanges {\n  title = 'pathway-browser';\n  @ViewChild('cytoscape') cytoscapeContainer?: ElementRef<HTMLDivElement>;\n  @ViewChild('cytoscapeCompare') compareContainer?: ElementRef<HTMLDivElement>;\n  @ViewChild('legend') legendContainer?: ElementRef<HTMLDivElement>;\n  @ViewChild('psicquicSelect') psicquicSelect?: MatSelect;\n\n  comparing: boolean = false;\n  fit = true;\n  psicquicResources: PsicquicResource[] = []\n  selectedPsicquicResource = new FormControl();\n  isDataFromPsicquicLoading: boolean = false;\n  resourceTokens: Resource[] = [];\n  readonly ResourceType = ResourceType;\n\n\n  palettes: { name: PaletteGroup, palettes: Palette[], valid: boolean }[] = [\n    {\n      name: 'sequential', valid: false, palettes: [\n        'Greys', 'Purples', 'Blues', 'Greens', 'Oranges', 'Reds',\n        'BuPu', 'RdPu', 'PuRd',\n        'GnBu', 'YlGnBu', 'PuBu', 'PuBuGn',\n        'BuGn', 'YlGn',\n        'YlOrBr', 'OrRd', 'YlOrRd'\n      ]\n    },\n    {name: 'diverging', valid: true, palettes: ['RdYlGn', 'RdYlBu', 'RdGy', 'RdBu', 'PuOr', 'PRGn', 'PiYG', 'BrBG']},\n    {name: 'continuous', valid: false, palettes: ['Spectral', 'Viridis']},\n  ]\n\n\n  constructor(private diagram: DiagramService,\n              public dark: DarkService,\n              private interactorsService: InteractorService,\n              private state: DiagramStateService,\n              public dialog: MatDialog,\n              private cdr: ChangeDetectorRef,\n              private analysis: AnalysisService,\n              private router: Router) {\n  }\n\n  cy!: cytoscape.Core;\n  reactomeStyle!: Style;\n  cyCompare!: cytoscape.Core;\n  reactomeStyleCompare!: Style;\n  legend!: cytoscape.Core;\n\n  cys: cytoscape.Core[] = [];\n\n  paletteOptions: Map<Palette, PaletteSummary> = new Map(Object.keys(brewer)\n    .filter(name => name.toLowerCase() !== name)\n    .map(name => ([name as Palette, new PaletteSummary(name as Palette)])));\n\n  palette: PaletteSummary = this.paletteOptions.get('RdBu')!;\n\n\n  @Input('id') diagramId: string = '';\n\n  ngOnChanges(changes: SimpleChanges): void {\n    console.log(this.paletteOptions)\n    if (changes['diagramId']) this.loadDiagram();\n  }\n\n\n  ngAfterViewInit(): void {\n    this.dark.$dark.subscribe(this.updateStyle.bind(this))\n\n    const container = this.cytoscapeContainer!.nativeElement;\n    const compareContainer = this.compareContainer!.nativeElement;\n    const legendContainer = this.legendContainer!.nativeElement;\n\n    Object.values(ReactomeEventTypes).forEach((type) => {\n      container.addEventListener(type, (e) => this._reactomeEvents$.next(e as ReactomeEvent))\n      compareContainer.addEventListener(type, (e) => this._reactomeEvents$.next(e as ReactomeEvent))\n      legendContainer.addEventListener(type, (e) => this._reactomeEvents$.next(e as ReactomeEvent))\n    })\n\n    this.reactomeStyle = new Style(container);\n\n    this.underlayPadding = extract(this.reactomeStyle.properties.shadow.padding)\n\n    this.diagram.getLegend()\n      .subscribe(legend => {\n        this.legend = cytoscape({\n          container: legendContainer,\n          elements: legend,\n          style: this.reactomeStyle?.getStyleSheet(),\n          layout: {name: \"preset\"},\n          boxSelectionEnabled: false\n        });\n        this.reactomeStyle?.bindToCytoscape(this.legend);\n\n        this.legend.zoomingEnabled(false);\n        this.legend.panningEnabled(false);\n        this.legend.minZoom(0)\n        const bb = this.legend.elements().boundingBox();\n        // this.ratio = bb.w / bb.h;\n      });\n\n    this.loadDiagram();\n\n    this.getPsicquicResources();\n  }\n\n  loadDiagram() {\n    if (!this.cytoscapeContainer) return;\n\n    const container = this.cytoscapeContainer!.nativeElement;\n\n    this.diagram.getDiagram(this.diagramId)\n      .subscribe(elements => {\n        this.comparing = elements.nodes.some(node => node.data['isFadeOut']) || elements.edges.some(edge => edge.data['isFadeOut'])\n        this.cy = cytoscape({\n          container: container,\n          elements: elements,\n          style: this.reactomeStyle?.getStyleSheet(),\n          layout: {name: \"preset\"},\n        });\n        this.cys[0] = this.cy;\n        this.reactomeStyle.bindToCytoscape(this.cy);\n        this.reactomeStyle.clearCache();\n        this.cy.on('dblclick', '.Pathway', (e) => this.router.navigate([e.target.data('graph.stId')], {queryParamsHandling: \"preserve\"}))\n\n        this.loadCompare(elements, container);\n\n        this.stateToDiagram();\n      })\n  }\n\n  private initialiseReplaceElements() {\n    if (this.comparing)\n      this.cy.batch(() => {\n        this.cy.elements('[!isBackground]').style('visibility', 'hidden')\n        this.cy.edges('.shadow').style('underlay-padding', 0)\n        this.lastIndex = 0;\n        this.updateReplacementVisibility();\n        this.cy.elements('.Compartment').style('visibility', 'visible')\n      })\n  }\n\n  private loadCompare(elements: cytoscape.ElementsDefinition, container: HTMLDivElement) {\n    const getPosition = (e: cytoscape.SingularElementArgument) => e.is('.Shadow') ? e.data('triggerPosition') : e.boundingBox().x1;\n    if (this.comparing) {\n      this.cy.elements('[!isBackground]').style('visibility', 'hidden')\n      this.replacedElements = this.cy!\n        .elements('[?replacedBy]')\n        .add('[?isCrossed]')\n        .sort((a, b) => getPosition(a) - getPosition(b))\n        .style('visibility', 'hidden')\n        .toArray();\n\n      this.replacedElementsPosition = this.replacedElements.map(getPosition);\n\n\n      this.cy.on('add', e => {\n        const addedElement = e.target;\n        if (addedElement.data('replacedBy') || addedElement.data('isCrossed')) {\n          const x = getPosition(addedElement);\n          let index = this.replacedElementsPosition.findIndex(x1 => x1 >= x);\n          if (index === -1) index = this.replacedElements.length;\n\n          this.replacedElements.splice(index, 0, addedElement);\n          this.replacedElementsPosition.splice(index, 0, x);\n          addedElement.style('visibility', 'hidden');\n        }\n      })\n\n      this.cy.on('remove', e => {\n        const removedElement = e.target;\n        const index = this.replacedElements.indexOf(removedElement);\n        if (index > -1) {\n          this.replacedElements.splice(index, 1);\n          this.replacedElementsPosition.splice(index, 1);\n        }\n      })\n\n      const compareContainer = this.compareContainer!.nativeElement;\n      this.cyCompare = cytoscape({\n        container: compareContainer,\n        elements: elements,\n        style: this.reactomeStyle?.getStyleSheet(),\n        layout: {name: \"preset\"},\n      });\n      this.cys[1] = this.cyCompare;\n\n\n      this.cyCompare.elements('[?isFadeOut]').remove();\n      this.cyCompare.elements('.Compartment').remove();\n      this.cy!.nodes('.crossed').removeClass('crossed');\n\n      this.cyCompare!.on('viewport', () => this.syncViewports(this.cyCompare, compareContainer, this.cy, container))\n      this.cy!.on('viewport', () => this.syncViewports(this.cy, container, this.cyCompare, compareContainer))\n\n      this.reactomeStyleCompare = new Style(compareContainer);\n      this.reactomeStyleCompare?.bindToCytoscape(this.cyCompare);\n      this.cyCompare.minZoom(this.cy!.minZoom())\n      this.cyCompare.maxZoom(this.cy!.maxZoom())\n\n      setTimeout(() => {\n        this.syncViewports(this.cy!, container, this.cyCompare, compareContainer)\n        this.initialiseReplaceElements();\n      })\n    }\n  }\n\n  readonly classRegex = /class:(\\w+)([!.]drug)?/\n\n  getElements(tokens: (string | number)[], cy: cytoscape.Core): cytoscape.CollectionArgument {\n    let elements: cytoscape.Collection;\n\n    elements = cy.collection()\n    tokens.forEach(token => {\n      if (typeof token === 'string') {\n        if (token.startsWith('R-')) {\n          elements = elements.or(`[graph.stId=\"${token}\"]`)\n        } else {\n          const matchArray = token.match(this.classRegex);\n          if (matchArray) {\n            const [_, clazz, drug] = matchArray;\n            if (drug === '.drug') { // Drug physical entity\n              elements = elements.or(`.${clazz}`).and('.drug');\n            } else if (drug === '!drug') { // Non drug physical entity\n              elements = elements.or(`.${clazz}`).not('.drug');\n            } else { // Reactions\n              elements = elements.or(`.${clazz}`);\n              elements = elements.or(elements.nodes('.reaction').connectedEdges());\n            }\n          } else {\n            elements = elements.or(`[acc=\"${token}\"]`)\n          }\n        }\n      } else {\n        elements = elements.or(`[acc=\"${token}\"]`).or(`[reactomeId=\"${token}\"]`)\n      }\n    });\n    return elements;\n  }\n\n  select(tokens: (string | number)[], cy: cytoscape.Core): cytoscape.CollectionArgument {\n    let selected = this.getElements(tokens, cy);\n    selected.select();\n    if (\"connectedNodes\" in selected) {\n      selected = selected.add(selected.connectedNodes());\n    }\n\n    if (this.fit) {\n      cy.fit(selected, 100)\n      this.fit = false;\n    }\n\n    return selected;\n  }\n\n  flag(accs: (string | number)[], cy: cytoscape.Core): cytoscape.CollectionArgument {\n    return this.flagElements(this.getElements(accs, cy), cy)\n  }\n\n  flagElements(toFlag: cytoscape.CollectionArgument, cy: cytoscape.Core): cytoscape.CollectionArgument {\n    const shadowNodes = cy.nodes('.Shadow');\n    const shadowEdges = cy.edges('[?color]');\n    const trivials = cy.elements('.trivial');\n\n    if (toFlag.nonempty()) {\n      cy.batch(() => {\n        this.setSubPathwayVisibility(false, cy);\n        cy.elements().removeClass('flag')\n        toFlag.addClass('flag')\n          .edges().style({'underlay-opacity': 1})\n      })\n\n      return toFlag\n    } else {\n      cy.batch(() => {\n        this.setSubPathwayVisibility(true, cy);\n        cy.elements().removeClass('flag');\n      })\n\n      return cy.collection()\n    }\n  }\n\n  setSubPathwayVisibility(visible: boolean, cy: cytoscape.Core) {\n    const shadowNodes = cy.nodes('.Shadow');\n    const shadowEdges = cy.edges('[?color]');\n    const trivials = cy.elements('.trivial');\n\n    if (visible) {\n      shadowNodes.style({opacity: 1})\n      trivials.style({opacity: 1})\n      shadowEdges.addClass('shadow')\n      cy.on('zoom', cy.data('reactome').interactivity.onZoom.shadow)\n      cy.data('reactome').interactivity.onZoom.shadow()\n    } else {\n      shadowNodes.style({opacity: 0})\n      shadowEdges.removeClass('shadow')\n      cy.off('zoom', cy.data('reactome').interactivity.onZoom.shadow)\n      trivials.style({opacity: 1})\n      cy.edges().style({'underlay-opacity': 0})\n    }\n  }\n\n\n  applyEvent(event: ReactomeEvent, affectedElements: cytoscape.NodeCollection | cytoscape.EdgeCollection) {\n    switch (event.type) {\n      case ReactomeEventTypes.hover:\n        affectedElements.addClass('hover');\n        break;\n      case ReactomeEventTypes.leave:\n        affectedElements.removeClass('hover');\n        break;\n      case ReactomeEventTypes.select:\n        affectedElements.select();\n        break;\n      case ReactomeEventTypes.unselect:\n        affectedElements.unselect();\n        break;\n    }\n  }\n\n\n  ratio = 0.384;\n\n  replacedElements!: cytoscape.SingularElementArgument[];\n  replacedElementsPosition: number[] = [];\n\n  lastIndex = 0;\n  underlayPadding = 0;\n\n  private updateReplacementVisibility() {\n\n    // // Calculate the position of the element that is to the right of the separation\n\n    const extent = this.cyCompare!.extent();\n    let limitIndex = this.replacedElementsPosition.findIndex(x1 => x1 >= extent.x1);\n    if (limitIndex === -1) limitIndex = this.replacedElements.length;\n\n    /// Alternative calculation. In theory more optimised, but seems worse when console is opened for some reason\n\n    // const currentPos = this.cyCompare!.extent().x1;\n    // let limitIndex = this.lastIndex;\n    // let i = this.lastIndex;\n    // if (currentPos > this.lastPosition) { // Dragging to the right\n    //   while (i >= 0 && this.replacedElementsPosition[i] < currentPos) i++;\n    //   limitIndex = i;\n    // } else if (currentPos < this.lastPosition) { // Dragging to the left\n    //   do i--;\n    //   while (i < this.replacedElementsPosition.length  && this.replacedElementsPosition[i] >= currentPos)\n    //   limitIndex = i+1;\n    // }\n    //\n    // this.lastPosition = currentPos;\n    // ---------\n\n    if (this.lastIndex !== limitIndex) {\n      // If at least one element is switched from left to right\n      if (limitIndex < this.lastIndex) this.replacedElements.slice(limitIndex, this.lastIndex)\n        .map(e => e.style('visibility', 'hidden')) // Hide the range of elements\n        .filter(e => e.is('.Shadow')) // And if it is an shadow\n        .forEach(shadow => shadow.data('edges').style('underlay-padding', 0)) // Hide as well the associated reaction underlay\n      // If at least one element is switched from right to left\n      if (limitIndex > this.lastIndex) this.replacedElements.slice(this.lastIndex, limitIndex)\n        .map(e => e.style('visibility', 'visible')) // Show the range of elements\n        .filter(e => e.is('.Shadow')) // And if it is an shadow\n        .forEach(shadow => shadow.data('edges').style('underlay-padding', this.underlayPadding)) // Show as well the associated reaction underlay\n    }\n    this.lastIndex = limitIndex\n  }\n\n  syncing = false;\n  syncViewports = (source: cytoscape.Core, sourceContainer: HTMLElement, target: cytoscape.Core, targetContainer: HTMLElement) => {\n    if (this.syncing) return;\n    this.syncing = true;\n    this.updateReplacementVisibility();\n\n    const position = {...source.pan()};\n    const sourceX = sourceContainer.getBoundingClientRect().x;\n    const targetX = targetContainer.getBoundingClientRect().x;\n    position.x += sourceX - targetX;\n    target.viewport({\n      zoom: source.zoom(),\n      pan: position,\n    })\n    this.syncing = false;\n  };\n\n\n  getInteractors(resource: string) {\n    const isCustom = this.interactorsService.isCustomResource(resource, this.psicquicResources)\n    const isPsicquic = this.psicquicResources.filter(pr => pr.name != ResourceType.STATIC).some(r => r.name === this.state.get('overlay'))\n    this.cys.forEach(cy => {\n      if (!resource) return;\n\n      if (!isPsicquic) {\n        this.selectedPsicquicResource.reset();\n      }\n\n      if (!isCustom) {\n        this.interactorsService.getInteractorData(cy, resource).subscribe(interactors => {\n          this.interactorsService.addInteractorOccurrenceNode(interactors, cy, resource);\n          this.initialiseReplaceElements(); // Avoid floating occurrence nodes when in compare mode\n        });\n      }\n      this.state.set('overlay', resource)\n    })\n  }\n\n  getPsicquicResources() {\n    this.interactorsService.getPsicquicResources().subscribe(resources => {\n      this.psicquicResources = resources;\n    });\n  }\n\n  onPsicquicResourceChange(selectedResource: string) {\n    this.isDataFromPsicquicLoading = true;\n    this.interactorsService.getInteractorData(this.cy, selectedResource).subscribe(interactors => {\n      this.interactorsService.addInteractorOccurrenceNode(interactors, this.cy, selectedResource)\n      this.isDataFromPsicquicLoading = false;\n      this.psicquicSelect?.close();\n      this.state.set('overlay', selectedResource)\n    })\n  }\n\n  openCustomInteractorDialog() {\n    const dialogRef = this.dialog.open(CustomInteractorDialogComponent, {\n      data: {cy: this.cy},\n      restoreFocus: false // Deselect button when closing\n    });\n\n    dialogRef.afterClosed().subscribe(result => {\n      const resource = dialogRef.componentInstance.resource\n      if (resource.token) {\n        this.resourceTokens!.push(resource)\n        this.state.set('overlay', resource.token.summary.token)\n      }\n      this.cdr.detectChanges();\n    })\n  }\n\n  deleteResource(resource: Resource) {\n    const index = this.resourceTokens!.indexOf(resource);\n    if (index !== -1) {\n      this.resourceTokens!.splice(index, 1);\n      this.cy.elements(`[resource = '${resource.token?.summary.token}']`).remove();\n    }\n  }\n\n  onCustomResourceChange(resource: Resource) {\n    this.interactorsService.sendPostRequest(resource.token!, this.cy).subscribe((result) => {\n      this.cys.forEach(cy => {\n        this.interactorsService.addInteractorOccurrenceNode(result.interactors, cy, result.interactors.resource);\n        this.state.set('overlay', resource.token!.summary.token);\n      })\n    })\n  }\n\n  isSelected(resource: Resource): boolean {\n    return this.resourceTokens!.includes(resource);\n  }\n\n  private loadAnalysis(token: string | null) {\n    console.log(token, this.diagramId)\n    if (!token || !this.diagramId) {\n      this.cys.forEach(cy => {\n        cy.batch(() => {\n          cy.nodes().removeData('exp');\n          cy.edges('[?color]').style({\n            'underlay-padding': extract(this.reactomeStyle.properties.shadow.padding)\n          });\n          cy.nodes('.Shadow').style({\n            'font-size': extract(this.reactomeStyle.properties.shadow.fontSize),\n            'text-outline-width': extract(this.reactomeStyle.properties.shadow.fontPadding)\n          })\n        })\n      });\n      return\n    }\n\n    forkJoin({\n      entities: this.analysis.foundEntities(this.diagramId, token),\n      pathways: this.analysis.pathwaysResults(this.cy.nodes('.Pathway').map(p => p.data('reactomeId')), token),\n      result: this.analysis.result$.pipe(filter(isDefined), take(1))\n    }).subscribe(({entities, result, pathways}) => {\n      // TODO Make switching profile work without reloading whole data\n      const analysisProfile = this.state.get('analysisProfile');\n      let analysisIndex = analysisProfile ? entities.expNames.indexOf(analysisProfile) : 0;\n      if (analysisIndex === -1) analysisIndex = 0;\n\n      let analysisEntityMap = new Map<string, number>(entities.entities.flatMap(entity =>\n        entity.mapsTo\n          .flatMap(diagramEntity => diagramEntity.ids)\n          .map(id => [id, entity.exp[analysisIndex] || 1]))\n      )\n      console.log(analysisEntityMap)\n\n      let analysisPathwayMap = new Map<number, Analysis.Pathway['entities']>(pathways.map(p => [p.dbId, p.entities]));\n\n      console.log(analysisPathwayMap)\n\n      const normalize = (x: number, min: number, max: number) => (x - min) / (max - min)\n\n      this.cys.forEach(cy => {\n        cy.batch(() => {\n          const style: Style = cy.data('reactome');\n          const min = style.properties.analysis.min = result.expression.min || 0;\n          const max = style.properties.analysis.max = result.expression.max || 1;\n\n          const hasExpression = result.summary.type !== 'OVERREPRESENTATION';\n\n\n          cy.nodes('.PhysicalEntity').forEach(node => {\n            const leaves: Graph.Node[] = node.data('graph.leaves');\n            const exp = leaves\n              .map(leaf => analysisEntityMap.get(leaf.identifier))\n              .sort((a, b) => a !== undefined ? (b !== undefined ? a - b : -1) : 1);\n\n            console.log(node.data('reactomeId'), leaves, exp)\n\n            // if (hasExpression) exp = exp.map(e => e !== undefined ? 1 - e : undefined);\n            node.data('exp', exp);\n          })\n          cy.nodes('.Pathway').forEach(node => {\n            const dbId: number = node.data('reactomeId');\n            const pathwayData = analysisPathwayMap.get(dbId);\n            if (!pathwayData) {\n              node.data('exp', [undefined]);\n            } else {\n              console.log(dbId, normalize(pathwayData.exp[analysisIndex] || 1 - pathwayData.pValue, min, max))\n              node.data('exp', [\n                [pathwayData.exp[analysisIndex] || 1 - pathwayData.pValue, pathwayData.found],\n                [undefined, pathwayData.total - pathwayData.found]\n              ])\n            }\n          })\n\n          cy.edges('[?color]').style({'underlay-padding': 8});\n          cy.nodes('.Shadow').style({\n            'font-size': extract(style.properties.shadow.fontSize) / 2,\n            'text-outline-width': extract(style.properties.shadow.fontPadding) / 2\n          })\n\n          const validGroups: Set<PaletteGroup> = new Set();\n          if (result.summary.type === 'GSA_REGULATION') {\n            validGroups.add('diverging')\n          } else if (result.summary.type === 'EXPRESSION') {\n            validGroups.add('diverging')\n            validGroups.add('sequential')\n            validGroups.add('continuous')\n          } else if (result.summary.type === 'OVERREPRESENTATION') {\n            validGroups.add('sequential')\n          }\n\n          for (let summary of this.paletteOptions.values()) {\n            summary.classes(result.summary.type === 'GSA_REGULATION' ? 5 : 0);\n            summary.domain(min, max);\n          }\n\n          this.palettes.forEach(group => group.valid = validGroups.has(group.name))\n          this.palette = this.paletteOptions.get(hasExpression ? 'RdBu' : 'GnBu')!;\n          this.reactomeStyle.loadAnalysis(cy, this.palette.scale);\n        })\n      })\n\n    })\n  }\n\n  changePalette() {\n    console.log(this.palette)\n    if (this.palette) this.reactomeStyle.loadAnalysis(this.cy, this.palette.scale);\n  }\n\n  updateStyle() {\n    this.cy ? setTimeout(() => this.reactomeStyle?.update(this.cy), 5) : null;\n    this.cyCompare ? setTimeout(() => this.reactomeStyle?.update(this.cyCompare), 5) : null;\n    this.legend ? setTimeout(() => this.reactomeStyle?.update(this.legend), 5) : null;\n  }\n\n  compareDragging = false;\n\n  dragStart() {\n    this.compareDragging = true;\n  }\n\n  dragEnd() {\n    this.compareDragging = false;\n  }\n\n  dragMove($event: MouseEvent, compareContainer: HTMLDivElement) {\n    if (!this.compareDragging) return;\n    compareContainer.style['left'] = $event.x + 'px';\n    this.cyCompare.resize()\n    this.syncViewports(this.cy!, this.cytoscapeContainer!.nativeElement, this.cyCompare!, this.compareContainer!.nativeElement);\n  }\n\n  updateLegend() {\n    this.legend.resize()\n    this.legend.panningEnabled(true)\n    this.legend.zoomingEnabled(true)\n    this.legend.fit(this.legend.elements(), 2)\n    this.legend.panningEnabled(false)\n    this.legend.zoomingEnabled(false)\n  }\n\n  // ----- Event Syncing -----\n  private _reactomeEvents$: Subject<ReactomeEvent> = new Subject<ReactomeEvent>();\n\n  private _ignore = false;\n\n  @Output()\n  public reactomeEvents$: Observable<ReactomeEvent> = this._reactomeEvents$.asObservable().pipe(\n    distinctUntilChanged((prev, current) => prev.type === current.type && prev.detail.reactomeId === current.detail.reactomeId),\n    tap(e => console.log(e.type, e.detail, e.detail.element.data(), e.detail.cy.container()?.id)),\n    filter(() => !this._ignore),\n    share()\n  );\n\n  flagging = this.state.onChange.flag$.subscribe((value) => this.cys.forEach(cy => this.flag(value, cy)))\n  selecting = this.state.onChange.select$.subscribe((value) => this.cys.forEach(cy => this.select(value, cy)))\n  interactoring = this.state.onChange.overlay$.subscribe((value) => this.getInteractors(value));\n  analysing = this.state.onChange.analysis$.subscribe((value) => this.loadAnalysis(value));\n\n\n  // stateToDiagramSub = this.state.state$.subscribe(() => this.stateToDiagram());\n\n  private stateToDiagram() {\n    for (let cy of this.cys) {\n      this.flag(this.state.get('flag'), cy);\n      this.select(this.state.get(\"select\"), cy);\n    }\n    this.getInteractors(this.state.get(\"overlay\"));\n    this.loadAnalysis(this.state.get('analysis'))\n  }\n\n  compareBackgroundSync = this.reactomeEvents$.pipe(\n    filter(() => this.comparing),\n    filter((e) => e.detail.cy !== this.legend)\n  ).subscribe(event => {\n    const src = event.detail.cy;\n    const tgt = src === this.cy ? this.cyCompare : this.cy;\n\n    let replacedBy = event.detail.element.data('replacedBy');\n    replacedBy = replacedBy || event.detail.element.data('replacement');\n    replacedBy = replacedBy || (event.detail.element.data('isBackground') && !event.detail.element.data('isFadeOut') && event.detail.element.data('id'));\n\n    if (!replacedBy) return;\n\n    let replacements = tgt.getElementById(replacedBy);\n    if (event.detail.type === 'reaction') {\n      replacements = replacements.add(tgt.elements(`[reactionId=${replacedBy}]`))\n    }\n\n    this.applyEvent(event, replacements)\n  });\n\n\n  interactorOpeningHandling = this.reactomeEvents$\n    .pipe(\n      filter((e) => e.detail.cy !== this.legend),\n      filter(e => [ReactomeEventTypes.open, ReactomeEventTypes.close].includes(e.type as ReactomeEventTypes)),\n      filter(e => e.detail.type === 'Interactor'),\n    ).subscribe(e => {\n        [this.reactomeStyle, this.reactomeStyleCompare]\n          .filter(s => s !== undefined && e.detail.cy === s.cy)\n          .forEach(style => {\n              const occurrenceNode = e.detail.element.nodes()[0];\n\n              if (e.type === ReactomeEventTypes.open)\n                this.interactorsService.addInteractorNodes(occurrenceNode, style.cy!);\n              else\n                this.interactorsService.removeInteractorNodes(occurrenceNode);\n\n              style.interactivity.updateProteins();\n              style.interactivity.triggerZoom();\n            }\n          )\n\n        if (this.comparing) {\n          this.initialiseReplaceElements();\n        }\n      }\n    );\n\n  diagram2legend = this.reactomeEvents$.pipe(\n    filter((e) => e.detail.cy !== this.legend),\n  ).subscribe(event => {\n    const classes = event.detail.element.classes();\n    let matchingElement: cytoscape.NodeCollection | cytoscape.EdgeCollection = this.legend.elements(`.${classes[0]}`);\n\n    if (event.detail.type === 'PhysicalEntity') {\n      if (classes.includes('drug')) matchingElement = matchingElement.nodes('.drug')\n      else matchingElement = matchingElement.not('.drug')\n    } else if (event.detail.type === 'reaction') {\n      const reaction = event.detail.element.nodes('.reaction');\n      matchingElement = this.legend.nodes(`.${reaction.classes()[0]}`).first()\n      matchingElement = matchingElement.add(matchingElement.connectedEdges())\n    }\n\n    this._ignore = true;\n    this.applyEvent(event, matchingElement);\n    this._ignore = false;\n  });\n\n  diagramSelect2state = this.reactomeEvents$.pipe(\n    filter((e) => e.detail.cy !== this.legend),\n    delay(0)\n  ).subscribe(e => {\n      if (e.type !== ReactomeEventTypes.select) return;\n      let elements: cytoscape.NodeSingular = e.detail.element;\n      if (e.detail.type === 'reaction') {\n        elements = e.detail.cy.elements('node.reaction:selected')\n      }\n      const reactomeIds = elements.map(el => el.data('graph.stId'));\n      this.state.set('select', reactomeIds)\n    }\n  );\n\n  legend2state = this.reactomeEvents$.pipe(\n    filter((e) => e.detail.cy === this.legend),\n    filter(() => !this._ignore),\n  ).subscribe((e) => {\n    const event = e as ReactomeEvent;\n    const classes = event.detail.element.classes();\n    for (let cy of [this.cy, this.cyCompare].filter(isDefined)) {\n      let matchingElement: cytoscape.NodeCollection | cytoscape.EdgeCollection = cy.elements(`.${classes[0]}`);\n\n      // TODO move everything to use state\n\n      if (event.detail.type === 'PhysicalEntity' || event.detail.type === 'Pathway') {\n        if (classes.includes('drug')) matchingElement = matchingElement.nodes('.drug')\n        else matchingElement = matchingElement.not('.drug')\n      } else if (event.detail.type === 'reaction') {\n        const reaction = event.detail.element.nodes('.reaction');\n        matchingElement = this.cy.nodes(`.${reaction.classes()[0]}`)\n        matchingElement = matchingElement.add(matchingElement.connectedEdges())\n      }\n\n      switch (event.type) {\n        case ReactomeEventTypes.select:\n          this.state.set('flag', ['class:' + classes[0] + (event.detail.type === 'reaction' ? '' : ((classes.includes('drug') ? '.' : '!') + 'drug'))])\n          break;\n        case ReactomeEventTypes.unselect:\n          this.state.set('flag', []);\n          break;\n        case ReactomeEventTypes.hover:\n          matchingElement.addClass('hover')\n          break;\n        case ReactomeEventTypes.leave:\n          matchingElement.removeClass('hover')\n          break;\n      }\n    }\n  });\n\n  logProteins() {\n    console.debug(new Set(this.cy.nodes(\".Protein\").map(node => node.data(\"acc\") || node.data(\"iAcc\"))))\n  }\n\n  analyse(example: Examples) {\n    this.analysis.example(example).subscribe();\n  }\n\n  protected readonly style = style;\n  protected readonly brewer = brewer;\n  protected readonly MatFormField = MatFormField;\n  protected readonly group = group;\n}\n","<div class=\"variables\" [class.dark]=\"dark.isDark\" #container>\n\n  <div id=\"cytoscape\" #cytoscape></div>\n  <div id=\"disease-container\" class=\"drag-container\" #compareContainer [style.display]=\"comparing ? 'flex': 'none'\">\n    <div id=\"handle-limits\" (mouseup)=\"dragEnd()\" (mouseleave)=\"dragEnd()\"\n         (mousemove)=\"dragMove($event, compareContainer)\" [class.active]=\"compareDragging\">\n      <span id=\"disease-handle\" class=\"drag-handle\" (mousedown)=\"dragStart()\"></span>\n    </div>\n\n    <div id=\"cytoscape-compare\" #cytoscapeCompare class=\"drag-content\"></div>\n  </div>\n\n  <div id=\"legend-boundary\" [ngStyle]=\"{'--legend-width': ratio  * container.clientHeight + 'px'}\">\n    <div cdkDrag cdkDragLockAxis=\"x\" cdkDragBoundary=\"#legend-boundary\" id=\"legend-container\"\n         (cdkDragMoved)=\"updateLegend()\"\n         [style.height]=\"container.clientHeight + 'px'\">\n      <button id=\"legend-handle\" cdkDragHandle>LEGEND</button>\n      <div id=\"legend\" #legend></div>\n    </div>\n  </div>\n\n\n  <form id=\"controls\">\n    <button mat-raised-button (click)=\"getInteractors(ResourceType.STATIC)\">IntAct</button>\n    <button mat-raised-button (click)=\"getInteractors(ResourceType.DISGENET)\">DisGeNet</button>\n    <button mat-raised-button (click)=\"updateStyle()\">Update Style</button>\n    <button mat-raised-button (click)=\"logProteins()\">Log Proteins</button>\n    <button mat-raised-button (click)=\"analyse('uniprot')\">Uniprot</button>\n    <button mat-raised-button (click)=\"analyse('microarray')\">Microarray</button>\n    <mat-form-field  style=\"width: 200px\" appearance=\"outline\">\n      <mat-label>Palette</mat-label>\n      <mat-select [(value)]=\"palette\" (selectionChange)=\"changePalette()\" [hideSingleSelectionIndicator]=\"true\">\n        <mat-select-trigger>\n          <div class=\"palette\" [style.background]=\"palette.gradient\" style=\"vertical-align: center\">\n          </div>\n        </mat-select-trigger>\n        <ng-container *ngFor=\"let group of palettes \">\n          <mat-optgroup  *ngIf=\"group.valid\" style=\"align-self: center\">\n            <mat-label align=\"center\">{{group.name}}</mat-label>\n            <mat-option *ngFor=\"let palette of group.palettes\" [value]=\"paletteOptions.get(palette)\">\n              <div class=\"palette option-content\" [style.background]=\"paletteOptions.get(palette)?.gradient\"></div>\n            </mat-option>\n          </mat-optgroup>\n        </ng-container>\n\n      </mat-select>\n    </mat-form-field>\n\n    <mat-form-field appearance=\"outline\">\n      <mat-label>PSICQUIC</mat-label>\n      <mat-select #psicquicSelect [formControl]=\"selectedPsicquicResource\" [hideSingleSelectionIndicator]=true\n                  (selectionChange)=\"onPsicquicResourceChange($event.value)\">\n        <mat-select-trigger>{{selectedPsicquicResource.value}}</mat-select-trigger>\n        <mat-option *ngFor=\"let resource of psicquicResources\" [value]=\"resource.name\" [disabled]=\"!resource.active\"\n                    (click)=\"psicquicSelect.open()\">\n          <div class=\"option-content\">\n            <span><i>{{ resource.name }}</i></span>\n            <mat-spinner diameter=\"20\"\n                         *ngIf=\"isDataFromPsicquicLoading && selectedPsicquicResource.value === resource.name\"></mat-spinner>\n          </div>\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n\n    <button mat-raised-button (click)=\"openCustomInteractorDialog()\">Custom resource</button>\n\n    <mat-slide-toggle [(ngModel)]=\"dark.isDark\" name=\"dark\">Dark mode</mat-slide-toggle>\n    <span>{{ (reactomeEvents$ | async)?.detail?.reactomeId }}</span>\n  </form>\n\n\n  <mat-selection-list style=\"width: 260px\" *ngIf=\"resourceTokens?.length != 0\" [multiple]=\"false\">\n    <mat-list-option color=\"primary\" *ngFor=\"let resourceToken of resourceTokens\" [value]=\"resourceToken\"\n                     [selected]=\"isSelected(resourceToken)\" (click)=\"onCustomResourceChange(resourceToken)\">\n      <div class=\"option-content\">\n        <div>{{ resourceToken.token?.summary?.name }}</div>\n        <button mat-icon-button color=\"primary\" (click)=\"deleteResource(resourceToken)\">\n          <mat-icon>delete</mat-icon>\n        </button>\n      </div>\n    </mat-list-option>\n  </mat-selection-list>\n\n</div>\n","import {CanActivateFn, Params, Router} from '@angular/router';\nimport {inject} from \"@angular/core\";\n\nconst URL_PATTERN = /\\/?(?<id>R-[A-Z]{3}-\\d+)&?(?<params>.*)/;\n\n\nexport const legacyGuard: CanActivateFn = (route, state) => {\n  const router: Router = inject(Router);\n  const {fragment, queryParams} = route;\n  let params = {...queryParams} as Params;\n  let id = 'R-HSA-453279'; // Default routing\n\n  if (fragment) {\n    const match = fragment.match(URL_PATTERN);\n    if (match && match.groups && match.groups['id']) {\n      if (match.groups['id']) {\n        id = match.groups['id'];\n      }\n      if (match.groups['params']) {\n        match.groups['params']\n          .split(\"&\")\n          .map(param => param.split(\"=\"))\n          .forEach(([key, value]) => {\n            params[key] = value || true;\n          })\n      }\n    }\n    return router.navigate([id], {fragment: undefined, queryParams: params})\n  }\n\n  return router.navigate([id]); // Default routing\n};\n","export enum ResourceType {\n  STATIC = 'IntAct',\n  DISGENET = 'DisGeNet',\n  PSICQUIC = 'PSICQUIC',\n  CUSTOM = 'custom'\n}\n","import {Component, Inject, OnInit} from '@angular/core';\nimport {\n  AbstractControl,\n  FormBuilder,\n  FormControl,\n  FormGroup,\n  ValidationErrors,\n  ValidatorFn,\n  Validators\n} from \"@angular/forms\";\nimport {merge} from \"rxjs\";\nimport {takeUntilDestroyed} from \"@angular/core/rxjs-interop\";\nimport {MatTabChangeEvent} from \"@angular/material/tabs\";\nimport {MatRadioChange} from \"@angular/material/radio\";\nimport {InteractorService} from \"../services/interactor.service\";\nimport cytoscape from \"cytoscape\";\nimport {MAT_DIALOG_DATA, MatDialogRef} from \"@angular/material/dialog\";\nimport {InputCategory, Resource} from \"../model/interactor-entity.model\";\n\n\n@Component({\n  selector: 'cr-custom-interactor-dialog',\n  templateUrl: './custom-interactor-dialog.component.html',\n  styleUrls: ['./custom-interactor-dialog.component.scss']\n})\nexport class CustomInteractorDialogComponent implements OnInit {\n\n  cy!: cytoscape.Core;\n  name = new FormControl('', [Validators.required, Validators.pattern(/^[a-zA-Z_]+[a-zA-Z0-9_]*$/)]);\n  resourceForm!: FormGroup;\n  errorMessage = '';\n  tabId = 'data'; // Default value\n  selectedValue = 'form'; // Default value\n  isDataLoading: boolean = false;\n  resource = new Resource();\n  items = [\n    {'name': 'form', 'content': 'File'},\n    {'name': 'content', 'content': 'Copy & Paste'},\n    {'name': 'url', 'content': 'URL'}]\n\n  constructor(private interactorService: InteractorService, private dialogRef: MatDialogRef<CustomInteractorDialogComponent>, private fb: FormBuilder, @Inject(MAT_DIALOG_DATA) public data: {\n    cy: cytoscape.Core\n  }) {\n    this.resourceForm = this.fb.group({\n      selectedValue: [''],\n      form: [''], // file uploader\n      content: [''],\n      url: [''],\n      psicquicUrl: ['']\n    }, {validators: this.formGroupValidator});\n\n    merge(this.name.statusChanges, this.name.valueChanges)\n      .pipe(takeUntilDestroyed())\n      .subscribe(() => this.updateErrorMessage());\n  }\n\n\n  ngOnInit() {\n    this.cy = this.data.cy;\n  }\n\n  formGroupValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\n    const fileValue = control.value.form;\n    const contentValue = control.value.content;\n    const urlValue = control.value.url;\n    const psicquicUrlValue = control.value.psicquicUrl;\n    if (fileValue || contentValue || urlValue || psicquicUrlValue) {\n      return null\n    } else {\n      return {invalid: true};\n    }\n  };\n\n  updateErrorMessage() {\n    if (this.name.hasError('required')) {\n      this.errorMessage = 'You must enter a name';\n    } else if (this.name.hasError('pattern')) {\n      this.errorMessage = 'Name can only contain letters'\n    } else {\n      this.errorMessage = '';\n    }\n  }\n\n  onTabChange($event: MatTabChangeEvent) {\n    this.tabId = $event.tab.ariaLabelledby;\n  }\n\n  onItemChange($event: MatRadioChange) {\n    this.selectedValue = $event.value;\n  }\n\n  onFileChange($event: Event) {\n    const inputElement = $event.target as HTMLInputElement;\n    if (inputElement.files && inputElement.files.length) {\n      const file = inputElement.files[0]; // Single file upload\n      this.resourceForm.patchValue({form: file});\n    }\n  }\n\n  submit() {\n    this.isDataLoading = true;\n    const userInput = this.getInputs();\n    if (userInput) {\n      this.interactorService.getInteractorsFromToken(this.name.value!, userInput.url!, userInput.content!, this.cy).subscribe((result) => {\n        this.interactorService.addInteractorOccurrenceNode(result.interactors, this.cy, result.interactors.resource)\n        this.resource.token =result.token\n        this.isDataLoading = false;\n        this.dialogRef.close();\n      })\n    }\n  }\n\n  private getInputs(): InputCategory {\n    const input = new InputCategory();\n    const formValue = this.resourceForm.value;\n\n    if (this.tabId === 'data') {\n      input.url = this.interactorService.UPLOAD_URL + this.selectedValue;\n      input.content = formValue[this.selectedValue];\n      if (this.selectedValue === this.items[0].name) { // Prepare formdata when file is uploaded\n        input.content = this.prepareFormData(formValue.form)\n      }\n    }\n\n    if (this.tabId === 'psicquic') {\n      input.url = this.interactorService.UPLOAD_PSICQUIC_URL;\n      input.content = formValue.psicquicUrl;\n    }\n    return input\n  }\n\n  private prepareFormData(formControl: string | Blob): FormData {\n    const formData = new FormData();\n    formData.append(\"file\", formControl);\n    return formData;\n  }\n\n}\n","<h2 mat-dialog-title>Add a new resource</h2>\n<mat-dialog-content>\n  <form [formGroup]=\"resourceForm\">\n    <div>\n      <mat-form-field>\n        <mat-label>Name</mat-label>\n        <input matInput [formControl]=\"name\" (blur)=\"updateErrorMessage()\" required>\n        <mat-error *ngIf=\"resourceForm.get('name')?.invalid\">{{ errorMessage }}</mat-error>\n      </mat-form-field>\n    </div>\n    <mat-tab-group (selectedTabChange)=\"onTabChange($event)\">\n      <mat-tab label=\"Add your data\" aria-labelledby=\"data\">\n        <section>\n          <mat-radio-group (change)=\"onItemChange($event)\">\n            <mat-radio-button class=\"margin\" *ngFor=\"let item of items; let i = index\" [value]=\"item.name\"\n                              [checked]='i===0'>{{ item.content }}\n            </mat-radio-button>\n          </mat-radio-group>\n        </section>\n\n        <mat-form-field *ngIf=\"selectedValue === 'form'\" class=\"full-width\">\n          <ngx-mat-file-input formControlName=\"form\" (change)=\"onFileChange($event)\"  [multiple]=false>\n            <mat-icon ngxMatFileInputIcon>folder</mat-icon>\n          </ngx-mat-file-input>\n          <mat-hint><strong>Upload a file stored locally on your computer.</strong></mat-hint>\n        </mat-form-field>\n\n        <!--        <span>Upload a file stored locally on your computer. Upload a file stored locally on your computer.</span>-->\n        <!--        <div *ngIf=\"label === 'File'\" class=\"full-width\">-->\n        <!--          <button type=\"button\" mat-raised-button (click)=\"fileInput.click()\">Choose File</button>-->\n        <!--          <input hidden (change)=\"onFileSelected($event)\" #fileInput type=\"file\">-->\n        <!--          <span class=\"file-name\">{{ selectedFile?.name }}</span>-->\n        <!--        </div>-->\n\n        <mat-form-field *ngIf=\"selectedValue === 'content'\" class=\"full-width\">\n          <mat-label>Copy & paste your data here</mat-label>\n          <textarea matInput formControlName=\"content\"></textarea>\n          <mat-hint><strong>Copy and paste your data in columns.</strong></mat-hint>\n        </mat-form-field>\n\n        <mat-form-field *ngIf=\"selectedValue === 'url'\" class=\"full-width\">\n          <mat-label>URL</mat-label>\n          <input matInput formControlName='url'>\n          <mat-hint><strong>Upload a publicly accessible data though its URL.</strong></mat-hint>\n        </mat-form-field>\n\n      </mat-tab>\n      <mat-tab label=\"Add your PSICQUIC service\" aria-labelledby=\"psicquic\">\n        <mat-form-field class=\"full-width\">\n          <mat-label>URL</mat-label>\n          <input matInput formControlName=\"psicquicUrl\">\n          <mat-hint><strong>Add your custom PSICQUIC service through its URL.</strong></mat-hint>\n        </mat-form-field>\n      </mat-tab>\n    </mat-tab-group>\n    <mat-dialog-actions align=\"end\">\n      <button mat-flat-button color=\"primary\" mat-dialog-close>Close</button>\n      <button mat-flat-button color=\"primary\"\n              [disabled]=\"resourceForm.invalid && !resourceForm.get('name')?.invalid\"\n              type=\"submit\" (click)=\"submit()\">\n        <div class=\"button-row\">\n          Submit\n          <mat-spinner class=\"spinner-color\" diameter=\"20\" *ngIf=\"isDataLoading\"></mat-spinner>\n        </div>\n      </button>\n    </mat-dialog-actions>\n  </form>\n</mat-dialog-content>\n","\nimport {NodeSingular} from \"cytoscape\";\nimport {Interactor} from \"../model/interactor-entity.model\";\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\nexport interface Segment {\n  from: Position;\n  to: Position;\n}\n\n\nclass InteractorsLayout {\n\n  public static MAX_INTERACTORS = 18\n  public static BOX_WIDTH = 45;\n  public static BOX_HEIGHT = 20;\n  public static SEPARATION = Math.round(this.BOX_HEIGHT * 1.5);\n  public static MIN_HEIGHT = 2 * (2 * this.BOX_HEIGHT + this.SEPARATION);\n  public static MIN_WIDTH = 2 * (2 * this.BOX_WIDTH + this.SEPARATION);\n\n  constructor() {\n  }\n\n  public static getNumberOfInteractorsToDraw(interactors: Interactor[]) {\n    if (interactors == null) return 0;\n    return Math.min(interactors.length, InteractorsLayout.MAX_INTERACTORS);\n  }\n\n  public getSegmentOrigin(edgeIndex: number, center: Position, width: number, height: number): Position {\n    edgeIndex = edgeIndex % 4;\n    return {\n      x: center.x + (width / 2) * (edgeIndex === 1 || edgeIndex === 2 ? 1 : -1),\n      y: center.y + (height / 2) * (edgeIndex > 1 ? 1 : -1)\n    }\n  }\n\n  public getCentre(minX: number, maxX: number, minY: number, maxY: number): Position {\n    return {\n      x: minX + (maxX - minX) / 2.0,\n      y: minY + (maxY - minY) / 2.0\n    }\n  }\n\n  public interpolateInLayout(segment: Segment, pos: number, totalPositions: number): Position {\n    const r = pos / totalPositions;\n    return {\n      x: segment.from.x + r * (segment.to.x - segment.from.x),\n      y: segment.from.y + r * (segment.to.y - segment.from.y)\n    }\n  }\n\n  public getPosition(targetNode: NodeSingular, interactorIndex: number, numberToDraw: number) {\n\n    const centerPosition: { x: number, y: number } = targetNode.data('entity').position()\n    const lp = LayoutParameter.calculate(numberToDraw);\n\n    let edgeNodes = lp.nodeOnTop;\n    let nodeCount = 0;\n    let prevNodeCount = 0;\n    let edgeIndex;\n    const nodePerEdges = [lp.nodeOnTop, lp.nodeOnRight, lp.nodeOnBottom, lp.nodeOnLeft];\n\n    for (edgeIndex = 0; edgeIndex < nodePerEdges.length; edgeIndex++) {\n      edgeNodes = nodePerEdges[edgeIndex];\n      prevNodeCount = nodeCount;\n      nodeCount += edgeNodes - 1;\n      if (interactorIndex < nodeCount) {\n        break;\n      }\n    }\n\n    const edgePos = interactorIndex - prevNodeCount;\n    const pos = this.interpolateInLayout(\n      // new Segment(\n      {\n        from: this.getSegmentOrigin(edgeIndex, centerPosition, lp.width, lp.height),\n        to: this.getSegmentOrigin(edgeIndex + 1, centerPosition, lp.width, lp.height)\n      },\n      //  ),\n      edgePos,\n      edgeNodes - 1\n    );\n\n    const minX = pos.x - InteractorsLayout.BOX_WIDTH;\n    const maxX = pos.x + InteractorsLayout.BOX_WIDTH;\n    const minY = pos.y - InteractorsLayout.BOX_HEIGHT;\n    const maxY = pos.y + InteractorsLayout.BOX_HEIGHT;\n\n    return this.getCentre(minX, maxX, minY, maxY)\n  }\n}\n\nclass LayoutParameter {\n  constructor(\n    public nodeOnLeft: number,\n    public nodeOnRight: number,\n    public nodeOnTop: number,\n    public nodeOnBottom: number,\n    public width: number,\n    public height: number\n  ) {\n  }\n\n  static calculate(n: number): LayoutParameter {\n    const rationalNodePerEdge = n / 4 + 1;\n    const baseNodePerEdge = Math.floor(rationalNodePerEdge);\n    const remaining = Math.round((rationalNodePerEdge - baseNodePerEdge) * 4);\n\n    const nodeOnLeft = baseNodePerEdge + (remaining > 0 ? 1 : 0);\n    const nodeOnRight = baseNodePerEdge + (remaining > 1 ? 1 : 0);\n    const nodeOnTop = baseNodePerEdge + (remaining > 2 ? 1 : 0);\n    const nodeOnBottom = baseNodePerEdge;\n\n    const height = Math.max((2 * InteractorsLayout.BOX_HEIGHT + InteractorsLayout.SEPARATION) * (nodeOnLeft - 1), InteractorsLayout.MIN_HEIGHT);\n    const width = Math.max((2 * InteractorsLayout.BOX_WIDTH + InteractorsLayout.SEPARATION) * (nodeOnTop - 1), InteractorsLayout.MIN_WIDTH);\n\n    return new LayoutParameter(nodeOnLeft, nodeOnRight, nodeOnTop, nodeOnBottom, width, height);\n  }\n}\n\nexport default InteractorsLayout;\n","import cytoscape from \"cytoscape\";\n\nexport interface InteractorEntity {\n  acc: string;\n  count: number;\n  interactors: Interactor[] | null;\n}\n\nexport interface Interactor {\n  acc: string;\n  accURL: string;\n  alias: string;\n  evidences: number;\n  evidencesURL: string;\n  id: number;\n  score: number;\n  type: string;\n  existingNodes?: cytoscape.NodeCollection\n}\n\n\nexport interface Interactors {\n  entities: InteractorEntity[];\n  resource: string; //STATIC, DisGeNet PSICQUIC resource (e.g. IntAct, MINT, etc) or Custom resource\n}\n\nexport interface PsicquicResource{\n  name: string;\n  soapURL: string;\n  restURL: string;\n  active: boolean\n}\n\n\nexport interface InteractorToken{\n  summary: Summary;\n  warningMessage: string;\n}\n\ninterface Summary {\n  token:string;\n  interactors: number;\n  interactions: number;\n  fileName: string;\n  name: string\n}\n\nexport class InputCategory {\n  url: string | undefined\n  content: string | FormData | undefined\n}\n\nexport class Resource {\n  token: InteractorToken | undefined;\n}\n\n","import {Injectable} from \"@angular/core\";\nimport {HttpClient, HttpHeaders, HttpParams} from \"@angular/common/http\";\nimport cytoscape, {NodeCollection, NodeSingular} from \"cytoscape\";\nimport {map, Observable, switchMap} from \"rxjs\";\nimport {Interactor, Interactors, InteractorToken, PsicquicResource} from \"../model/interactor-entity.model\";\n\n\nimport InteractorsLayout from \"../layout/interactors-layout\";\nimport {DiagramService} from \"../../services/diagram.service\";\nimport {ResourceType} from \"../common/overlay-resource\";\nimport {environment} from \"../../../environments/environment\";\n\n@Injectable({\n  providedIn: 'root',\n})\n\nexport class InteractorService {\n\n  private PREFIX_INTERACTOR = `${environment.host}/ContentService/interactors/`;\n  private PREFIX_DISEASE = `${environment.host}/overlays/disgenet/`;\n\n  private STATIC_URL = this.PREFIX_INTERACTOR + 'static/molecules/details';\n  private PSICQUIC_RESOURCE_URL = this.PREFIX_INTERACTOR + 'psicquic/resources/'\n  private PSICQUIC_URL = this.PREFIX_INTERACTOR + 'psicquic/molecules/';\n  public UPLOAD_URL = this.PREFIX_INTERACTOR + 'upload/tuple/';\n  public UPLOAD_PSICQUIC_URL = this.PREFIX_INTERACTOR + 'upload/psicquic/url';\n  private TOKEN_URL = this.PREFIX_INTERACTOR + 'token/';\n\n  private DISGENET_URL = this.PREFIX_DISEASE + 'findByGenes';\n\n  private readonly DEFAULT_INTERACTOR_WIDTH = 100;\n  private readonly DEFAULT_DISGENET_WIDTH = 250\n  private readonly INTERACTOR_PADDING = 20;\n  private readonly CHAR_WIDTH = 10;\n  private readonly CHAR_HEIGHT = 12;\n  private readonly GENE_DECORATION_HEIGHT = 20;\n\n\n  identifiers: string = '';\n  cyToSelectedResource = new Map<cytoscape.Core, string>();\n\n\n  constructor(private http: HttpClient, private diagramService: DiagramService) {\n  }\n\n  private getAllIdentifiers(cy: cytoscape.Core): void {\n    this.identifiers = this.getIdentifiersFromGraph(cy);\n  }\n\n  private updateIdentifiersIfNeeded(cy: cytoscape.Core): void {\n    if (!this.identifiers) {\n      this.getAllIdentifiers(cy);\n    }\n  }\n\n  public getIdentifiersFromGraph(cy: cytoscape.Core) {\n    const graphNodes = cy?.nodes(`[graph]`);\n    const result: string[] = [];\n\n    graphNodes?.forEach(entity => {\n      const schemaClass = entity.data(\"graph\").schemaClass;\n      if (schemaClass === \"EntityWithAccessionedSequence\" || schemaClass === \"SimpleEntity\") {\n        result.push(entity.data(\"acc\"));\n      }\n    });\n\n    // Concatenate elements from the set values into a single string\n    return [...new Set(result)].join(',')\n\n  }\n\n  public getInteractorData(cy: cytoscape.Core, resource: string): Observable<Interactors> {\n    this.updateIdentifiersIfNeeded(cy);\n    let url;\n    if (resource === ResourceType.STATIC) {\n      url = this.STATIC_URL;\n    } else if (resource === ResourceType.DISGENET) {\n      url = this.DISGENET_URL;\n    } else {\n      url = this.PSICQUIC_URL + resource.toLowerCase() + '/details'\n    }\n\n    return this.http.post<Interactors>(url, this.identifiers, {\n      headers: new HttpHeaders({'Content-Type': 'text/plain'})\n    });\n  }\n\n\n  public addInteractorOccurrenceNode(interactors: Interactors, cy: cytoscape.Core, resource: string) {\n    if (this.cyToSelectedResource.has(cy) && this.cyToSelectedResource.get(cy) !== resource) {\n      const previousResource = this.cyToSelectedResource.get(cy);\n      cy.elements(`[resource='${previousResource}']`).remove();\n      this.createInteractorOccurrenceNode(interactors, cy, resource);\n      this.cyToSelectedResource.set(cy, resource);\n    } else if (!this.cyToSelectedResource.has(cy)) {\n      this.createInteractorOccurrenceNode(interactors, cy, resource);\n      this.cyToSelectedResource.set(cy, resource);\n    }\n  }\n\n  public createInteractorOccurrenceNode(interactors: Interactors, cy: cytoscape.Core, resource: string) {\n    const classes = resource === ResourceType.DISGENET ? ['InteractorOccurrences', 'disease'] : ['InteractorOccurrences'];\n\n    if (interactors.entities === undefined) return;\n\n    interactors.entities\n      .filter(interactorEntity => interactorEntity.count > 0)\n      .forEach(interactorEntity => {\n\n        const entities = cy?.nodes(`[acc = '${interactorEntity.acc}']`);\n        entities?.forEach(entityNode => {\n\n          const pos = {...entityNode.position()};\n          pos.x += entityNode.width() / 2;\n          pos.y -= entityNode.height() / 2;\n\n          const id = entityNode.id() + '-occ' + '-' + resource.toLowerCase();\n\n          if (!entityNode.classes().includes('Modification')) {\n            const occurrenceNode = cy?.add({\n              data: {\n                ...entityNode.data(),\n                id: id,\n                displayName: interactorEntity.count,\n                entity: entityNode,\n                interactors: interactorEntity.interactors,\n                resource: resource\n              },\n              classes: classes,\n              pannable: true,\n              grabbable: false,\n              position: pos\n            });\n\n            entityNode.data('occurrence', occurrenceNode);\n          }\n\n        });\n      });\n  }\n\n  public removeInteractorNodes(occurrenceNode: cytoscape.NodeSingular) {\n    const entityNode = occurrenceNode.data('entity');\n    const interactors = entityNode.closedNeighborhood('node.Interactor');\n\n    entityNode.connectedEdges('.Interactor').remove();\n    interactors.forEach((interactor: cytoscape.NodeSingular) => {\n      if (interactor.connectedEdges().empty()) {\n        interactor.remove()\n      }\n    })\n  }\n\n  public addInteractorNodes(occurrenceNode: cytoscape.NodeSingular, cy: cytoscape.Core) {\n    const interactorsData = occurrenceNode.data('interactors');\n    const resource = occurrenceNode.data('resource')\n    InteractorsLayout.BOX_WIDTH = resource === ResourceType.DISGENET ? this.DEFAULT_DISGENET_WIDTH / 2 : this.DEFAULT_INTERACTOR_WIDTH / 2;\n    const numberToAdd = InteractorsLayout.getNumberOfInteractorsToDraw(interactorsData)\n    const [dynamicInteractors, existingInteractors] = this.getAllInteractors(interactorsData, cy, numberToAdd);\n    const allNodes: Interactor[] = [...dynamicInteractors, ...existingInteractors];\n    cy.batch(() => {\n\n      const nodes = this.createInteractorNodes(dynamicInteractors, occurrenceNode, cy, dynamicInteractors.length, resource);\n      this.createInteractorEdges(allNodes, occurrenceNode, cy, resource);\n\n      this.displayInteractors(nodes, cy);\n    })\n  }\n\n  public getAllInteractors(interactorsData: Interactor[], cy: cytoscape.Core, numberToAdd: number) {\n    const dynamicInteractors = [];\n    const existingInteractors = [];\n    // get interactors to draw with a provided a number, collect existing interactors for creating edge\n    for (const interactor of interactorsData) {\n      const diagramNodes = cy?.nodes(`.PhysicalEntity[acc = '${interactor.acc}']`);\n\n      if (!diagramNodes || diagramNodes.length === 0) {\n        dynamicInteractors.push(interactor);\n      } else {\n        interactor.existingNodes = diagramNodes;\n        existingInteractors.push(interactor);\n      }\n    }\n\n    return [dynamicInteractors.slice(0, numberToAdd), existingInteractors];\n  }\n\n  public createInteractorNodes(interactorsData: Interactor[], targetNode: NodeSingular, cy: cytoscape.Core, numberToAdd: number, resource: string) {\n    const interactorNodes: cytoscape.NodeDefinition[] = [];\n    const interactorLayout = new InteractorsLayout();\n\n    interactorsData.forEach((interactor: Interactor, index: number) => {\n      const position = interactorLayout.getPosition(targetNode, index, numberToAdd)\n      const displayName = interactor.alias ? interactor.alias : interactor.acc;\n      const defaultType = ['Protein', 'PhysicalEntity'] // Default interactor type for custom resource when there is no type data provided\n      const classes = resource === ResourceType.DISGENET ? ['PhysicalEntity', 'Interactor', 'disease'] : [...this.diagramService.nodeTypeMap.get(interactor.type) || defaultType, 'Interactor'];\n      let width = resource === ResourceType.DISGENET ? this.DEFAULT_DISGENET_WIDTH : this.DEFAULT_INTERACTOR_WIDTH;\n      let height = this.CHAR_HEIGHT + 2 * this.INTERACTOR_PADDING;\n      if (interactor.type === 'Gene') height += this.GENE_DECORATION_HEIGHT;\n\n      const id = 'interactor-' + interactor.acc;\n      interactorNodes.push({\n        data: {\n          ...targetNode.data(),\n          id: id,\n          displayName: displayName.replace(/([/,:;-])/g, \"$1\\u200b\"),\n          html: this.diagramService.getStructureVideoHtml({id, type: interactor.type}, width, height, interactor.acc),\n          width: width,\n          height: height,\n          accURL: interactor.accURL,\n          score: interactor.score,\n          evidences: interactor.evidences,\n          evidenceURLs: interactor.evidencesURL,\n          resource: resource\n        },\n        classes: classes,\n        position: position,\n        selectable: false\n      })\n    })\n    return cy?.add(interactorNodes)\n  }\n\n\n  public createInteractorEdges(interactorsData: Interactor[], occurrenceNode: NodeSingular, cy: cytoscape.Core | undefined, resource: string) {\n    if (!cy) return\n\n    const resourceClass = resource === ResourceType.DISGENET ? ['Interactor', 'disease'] : ['Interactor'];\n\n    const interactorEdges: cytoscape.EdgeDefinition[] = [];\n    interactorsData.forEach((interactor: Interactor) => {\n      const entity = occurrenceNode.data('entity');\n      const targetNodes = interactor.existingNodes ? interactor.existingNodes : [cy.getElementById('interactor-' + interactor.acc)];\n      targetNodes.forEach(targetNode => {\n        interactorEdges.push({\n          data: {\n            ...targetNode.data(),\n            id: interactor.acc + '-' + entity.id(),\n            source: entity.id(),\n            target: targetNode.id(),\n            edgeToTarget: occurrenceNode.id(),\n            evidenceURLs: interactor.evidencesURL,\n            resource: resource\n          },\n          classes: resourceClass,\n          selectable: false\n        })\n      })\n\n    })\n    cy?.add(interactorEdges)\n  }\n\n  public displayInteractors(interactorsToDisplay: NodeCollection, cy: cytoscape.Core) {\n\n    let layoutOptions: cytoscape.LayoutOptions = {\n      name: 'preset',\n      fit: false\n    }\n    interactorsToDisplay.layout(layoutOptions).run();\n  }\n\n\n  public removeInteractorEdges(targetNode: cytoscape.NodeSingular, cy: cytoscape.Core) {\n    const edgesToRemove = cy.edges(`[edgeToTarget = '${targetNode.id()}']`);\n    edgesToRemove.remove();\n  }\n\n  public getPsicquicResources(): Observable<PsicquicResource[]> {\n    return this.http.get<PsicquicResource[]>(this.PSICQUIC_RESOURCE_URL, {\n      headers: new HttpHeaders({'Content-Type': 'application/json;charset=UTF-8'})\n    });\n  }\n\n  public getInteractorToken(name: string, url: string, body: string | FormData) {\n    return this.http.post<InteractorToken>(url, body, {\n      params: new HttpParams().set('name', name),\n    })\n  }\n\n\n  public getInteractorsWithToken(name: string, url: string, body: string | FormData, cy: cytoscape.Core): Observable<{\n    token: InteractorToken,\n    interactors: Interactors\n  }> {\n    this.updateIdentifiersIfNeeded(cy);\n    return this.getInteractorToken(name, url, body).pipe(\n      switchMap(token => {\n        return this.http.post<Interactors>(this.TOKEN_URL + token.summary.token, this.identifiers, {\n          headers: new HttpHeaders({'Content-Type': 'text/plain'})\n        }).pipe(\n          map((interactors) => ({token: token, interactors: interactors}))\n        );\n      })\n    );\n  }\n\n  public getInteractorsFromToken(name: string, url: string, body: string | FormData, cy: cytoscape.Core): Observable<{\n    token: InteractorToken,\n    interactors: Interactors\n  }> {\n    this.updateIdentifiersIfNeeded(cy);\n    return this.getInteractorToken(name, url, body).pipe(\n      switchMap(token => this.sendPostRequest(token, cy))\n    );\n  }\n\n  public sendPostRequest(token: InteractorToken, cy: cytoscape.Core): Observable<{\n    token: InteractorToken,\n    interactors: Interactors\n  }> {\n    this.updateIdentifiersIfNeeded(cy);\n    return this.http.post<Interactors>(this.TOKEN_URL + token.summary.token, this.identifiers, {\n      headers: new HttpHeaders({'Content-Type': 'text/plain'})\n    }).pipe(\n      map((interactors) => ({token: token, interactors: interactors}))\n    );\n  }\n\n  public isCustomResource(resource: string, psiResource: PsicquicResource[]) {\n    const isFromPSICQUIC = psiResource.filter(pr => pr.name != ResourceType.STATIC).some(r => r.name === resource)\n    return resource != ResourceType.STATIC && resource != ResourceType.DISGENET && !isFromPSICQUIC;\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {catchError, distinctUntilChanged, map, Observable, of, switchMap, tap} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {environment} from \"../../environments/environment\";\nimport {Analysis} from \"../model/analysis.model\";\nimport {DiagramStateService} from \"./diagram-state.service\";\n\nexport type Examples = 'uniprot' | 'microarray';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AnalysisService {\n\n  result?: Analysis.Result;\n\n  result$ = this.state.state$.pipe(\n    map(state => state.analysis.value),\n    distinctUntilChanged(),\n    switchMap(token =>\n      token !== null ?\n        (\n          token === this.result?.summary.token ?\n            of(this.result) : // Same token as cache => use cache\n            this.loadAnalysis(token) // Different token than cache => load result\n        ) :\n        of(undefined) // No tokens => No results\n    )\n  )\n\n  constructor(private http: HttpClient, private state: DiagramStateService) {\n  }\n\n  analyse(data: string, params?: Partial<Analysis.Parameters>): Observable<Analysis.Result> {\n    return this.http.post<Analysis.Result>(`${environment.host}/AnalysisService/identifiers/projection`, data, {params}).pipe(\n      tap(result => this.result = result),\n      tap(result => this.state.set('analysis', result.summary.token)),\n    )\n  }\n\n  loadAnalysis(token?: string, params?: Partial<Analysis.Parameters>): Observable<Analysis.Result> {\n    console.log('load analysis')\n    return this.http.get<Analysis.Result>(`${environment.host}/AnalysisService/token/${token || this.state.get('analysis')}`, {params}).pipe(\n      tap(result => this.result = result)\n    )\n  }\n\n  foundEntities(pathway: string, token?: string, resource: Analysis.Resource = 'TOTAL'): Observable<Analysis.FoundEntities> {\n    return this.http.get<Analysis.FoundEntities>(`${environment.host}/AnalysisService/token/${token || this.state.get('analysis')}/found/all/${pathway}`, {\n      params: {\n        resource\n      }\n    }).pipe(\n      catchError(() => of({\n        pathway,\n        foundEntities: 0,\n        foundInteractors:0,\n        expNames: [],\n        entities: [],\n        interactors:[],\n        resources: [resource]\n      }))\n    )\n  }\n\n  pathwaysResults(pathwayIds: number[], token?: string, resource: Analysis.Resource = 'TOTAL'): Observable<Analysis.Pathway[]> {\n    if (pathwayIds.length === 0) return of([]);\n    return this.http.post<Analysis.Pathway[]>(`${environment.host}/AnalysisService/token/${token || this.state.get('analysis')}/filter/pathways`, pathwayIds.join(','), {\n      params:{resource}\n    }).pipe(\n      catchError(() => of([]))\n    )\n  }\n\n  example(name: Examples): Observable<Analysis.Result> {\n    return this.http.get(`assets/data/analysis-examples/${name}.tsv`, {responseType: 'text'}).pipe(\n      switchMap(example => this.analyse(example))\n    )\n  }\n\n\n}\n","import {Injectable} from '@angular/core';\nimport {BehaviorSubject} from \"rxjs\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DarkService {\n\n  private _body: HTMLBodyElement | null;\n  private _isDark: boolean = false;\n\n  private readonly $_dark = new BehaviorSubject(this._isDark);\n  public readonly $dark = this.$_dark.asObservable();\n\n  constructor() {\n    this._body = document.querySelector('body');\n\n    // Update theme if other tabs are changing it\n    // window.addEventListener('storage', (e) => {\n    //   if (e.key === 'is-dark') this.isDark = JSON.parse(e.newValue || 'false');\n    // });\n\n    const localValue = localStorage.getItem('is-dark');\n    if (localValue) this.isDark = JSON.parse(localValue);\n    else if (window.matchMedia('(prefers-color-scheme)').media !== 'not all') {\n      this.isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n  }\n\n  get isDark(): boolean {\n    return this._isDark;\n  }\n\n  set isDark(value: boolean) {\n    this._isDark = value;\n    localStorage.setItem('is-dark', JSON.stringify(value));\n    if (value) this._body?.classList.add('dark');\n    else this._body?.classList.remove('dark');\n    this.$_dark.next(this._isDark);\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {BehaviorSubject, distinctUntilChanged, map, Observable, tap} from \"rxjs\";\nimport {isArray, isBoolean} from \"lodash\";\n\n\nexport interface UrlParam<T> {\n  value: T\n  otherTokens?: string[]\n}\n\nexport type State = {\n  [token: string]: UrlParam<any>\n  select: UrlParam<(string | number)[]>\n  flag: UrlParam<(string | number)[]>\n  flagInteractors: UrlParam<boolean>\n  overlay: UrlParam<string>\n  analysis: UrlParam<string | null>\n  analysisProfile: UrlParam<string | null>\n};\n\ntype ObservableState = { [K in keyof State as `${K & string}$`]: Observable<State[K]['value']> };\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DiagramStateService {\n\n  private propagate = false;\n\n\n  private state: State = {\n    select: {otherTokens: ['SEL'], value: []},\n    flag: {otherTokens: ['FLG'], value: []},\n    flagInteractors: {otherTokens: ['FLGINT'], value: false},\n    overlay: {value: ''},\n    analysis: {value: null, otherTokens: ['ANALYSIS']},\n    analysisProfile: {value: null},\n  };\n\n  private _state$ = new BehaviorSubject<State>(this.state);\n  public state$ = this._state$.asObservable();\n  public onChange: ObservableState = Object.keys(this.state)\n    .reduce((properties, prop: keyof State) => {\n      properties[`${prop}$`] = this.state$.pipe(\n        map(state => state[prop].value),\n        distinctUntilChanged((v1, v2) => v1?.toString() === v2?.toString()),\n        tap(v => console.log(`${prop} has been updated to ${v}`)),\n        // share()\n      )\n      return properties;\n    }, {} as ObservableState);\n\n  constructor(route: ActivatedRoute, private router: Router) {\n    route.queryParamMap.subscribe(params => {\n      for (const mainToken in this.state) {\n        const param = this.state[mainToken];\n        const tokens: string[] = [mainToken, ...param.otherTokens || []];\n        const token = tokens.find(token => params.has(token));\n        if (token) {\n          const formerValue = param.value;\n          if (isArray(param.value)) {\n            const rawValue = params.get(token)!;\n            param.value = rawValue.split(',').map(v => v.charAt(0).match(/d/) ? parseInt(v) : v);\n          } else if (isBoolean(param.value)) {\n            param.value = params.get(token) === 'true';\n          } else {\n            param.value = params.get(token)!;\n          }\n        }\n      }\n      if (this.propagate) this._state$.next(this.state);\n    })\n  }\n\n  get<T extends keyof State>(token: T): State[T]['value'] {\n    return this.state[token].value\n  }\n\n  set<T extends keyof State>(token: T, value: State[T][\"value\"], propagate = true): void {\n    this.state[token].value = value;\n    this.propagate = propagate;\n    this.onPropertyModified();\n  }\n\n  // TODO make unselect remove select from state\n  onPropertyModified() {\n    return this.router.navigate([], {\n      queryParams: {\n        ...Object.entries(this.state)\n          .filter(([token, param]) => param.value && param.value.length !== 0)\n          .reduce((acc, [token, param]) => ({\n            ...acc,\n            [token]: Array.isArray(param.value) ? param.value.join(',') : param.value\n          }), {})\n      }\n    })\n  }\n\n\n}\n","import {Injectable} from '@angular/core';\nimport {catchError, forkJoin, map, Observable, of, switchMap, tap} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {Diagram, Edge, Node, NodeConnector, Position, Prop, Rectangle} from \"../model/diagram.model\";\nimport {Graph} from \"../model/graph.model\";\n// @ts-ignore\nimport Reactome, {Style} from \"reactome-cytoscape-style\";\nimport legend from \"../../assets/json/legend.json\"\nimport {array} from \"vectorious\";\n\nimport cytoscape from \"cytoscape\";\nimport cytoscapeFcose, {FcoseLayoutOptions} from \"cytoscape-fcose\";\nimport NodeDefinition = Reactome.Types.NodeDefinition;\nimport ReactionDefinition = Reactome.Types.ReactionDefinition;\nimport EdgeTypeDefinition = Reactome.Types.EdgeTypeDefinition;\nimport {environment} from \"../../environments/environment\";\n\ncytoscape.use(cytoscapeFcose)\n\n\ntype RelativePosition = { distances: number[], weights: number[] };\n\nconst posToStr = (edge: Edge, pos: Position) => `${edge.id}-${pos.x},${pos.y}`\n\nconst pointToStr = (point: Position) => `${point.x};${point.y}`;\n\nconst scale = <T extends Position | number>(pos: T, scale = 2): T => {\n  if (typeof pos === 'number') return pos * scale as T\n  return {\n    x: pos.x * scale,\n    y: pos.y * scale\n  } as T\n}\n\nconst equal = (pos1: Position, pos2: Position) => pos1.x === pos2.x && pos1.y === pos2.y;\n\nconst avg = (positions: Position[]): Position => {\n  const sum = {x: 0, y: 0};\n  positions.forEach(pos => {\n    sum.x += pos.x;\n    sum.y += pos.y;\n  });\n  sum.x /= positions.length;\n  sum.y /= positions.length;\n  return sum;\n}\nconst squaredDist = (pos1: Position, pos2: Position) => {\n  return Math.pow(pos2.x - pos1.x, 2) + Math.pow(pos2.y - pos1.y, 2)\n}\n\nconst dist = (pos1: Position, pos2: Position) => Math.sqrt(squaredDist(pos1, pos2))\n\nconst closestToAverage = (positions: Position[]): Position => {\n  const average = avg(positions);\n  let closest = positions[0];\n  let min = squaredDist(closest, average);\n  for (let i = 1; i < positions.length; i++) {\n    const pos = positions[i];\n    const dist = squaredDist(pos, average);\n    if (dist < min) {\n      min = dist;\n      closest = pos\n    }\n  }\n  return closest;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DiagramService {\n\n  extraLine: Map<string, Position> = new Map<string, Position>();\n  reverseExtraLine: Map<string, Position> = new Map<string, Position>();\n\n  constructor(private http: HttpClient) {\n  }\n\n  nodeTypeMap = new Map<string, NodeDefinition>([\n      ['Gene', ['Gene', 'PhysicalEntity']],\n      ['RNA', ['RNA', 'PhysicalEntity']],\n      ['Protein', ['Protein', 'PhysicalEntity']],\n      ['Entity', ['GenomeEncodedEntity', 'PhysicalEntity']],\n      ['Complex', ['Complex', 'PhysicalEntity']],\n      ['EntitySet', ['EntitySet', 'PhysicalEntity']],\n      ['Chemical', ['Molecule', 'PhysicalEntity']],\n      ['Cell', ['Cell', 'PhysicalEntity']],\n\n      ['ProteinDrug', ['Protein', 'PhysicalEntity', 'drug']],\n      ['ComplexDrug', ['Complex', 'PhysicalEntity', 'drug']],\n      ['ChemicalDrug', ['Molecule', 'PhysicalEntity', 'drug']],\n      ['EntitySetDrug', ['EntitySet', 'PhysicalEntity', 'drug']],\n\n      ['ProcessNode', ['SUB', 'Pathway']],\n      ['EncapsulatedNode', ['Interacting', 'Pathway']]\n    ]\n  )\n\n  reactionTypeMap = new Map<string | undefined, ReactionDefinition>([\n      [undefined, ['transition', 'reaction']],\n      ['transition', ['transition', 'reaction']],\n      ['Transition', ['transition', 'reaction']],\n      ['Process', ['transition', 'reaction']],\n\n      ['binding', ['association', 'reaction']],\n      ['Association', ['association', 'reaction']],\n\n      ['dissociation', ['dissociation', 'reaction']],\n      ['Dissociation', ['dissociation', 'reaction']],\n\n      ['omitted', ['omitted', 'reaction']],\n      ['Omitted Process', ['omitted', 'reaction']],\n\n      ['uncertain', ['uncertain', 'reaction']],\n      ['Uncertain Process', ['uncertain', 'reaction']],\n    ]\n  )\n\n  edgeTypeMap = new Map<string, EdgeTypeDefinition>([\n      ['INPUT', ['consumption', 'incoming', 'reaction']],\n      ['ACTIVATOR', ['positive-regulation', 'incoming', 'reaction']],\n      ['REQUIRED', ['positive-regulation', 'incoming', 'reaction']],\n      ['INHIBITOR', ['negative-regulation', 'incoming', 'reaction']],\n      ['CATALYST', ['catalysis', 'incoming', 'reaction']],\n      ['OUTPUT', ['production', 'outgoing', 'reaction']],\n    ]\n  )\n\n  edgeTypeToStr = new Map<string, string>([\n      ['INPUT', '-'],\n      ['ACTIVATOR', '+'],\n      ['REQUIRED', '+>'],\n      ['INHIBITOR', '|'],\n      ['CATALYST', 'o'],\n      ['OUTPUT', '>'],\n    ]\n  )\n\n\n  linkClassMap = new Map<string, EdgeTypeDefinition>([\n    ['EntitySetAndMemberLink', ['set-to-member', 'incoming']],\n    ['EntitySetAndEntitySetLink', ['set-to-member', 'incoming']],\n    ['Interaction', ['production', 'outgoing']],\n    ['FlowLine', ['production', 'outgoing']]\n  ])\n\n\n  random(min: number, max: number) {\n    return Math.floor((Math.random()) * (max - min + 1)) + min;\n  }\n\n  pick<T>(values: T[]): T {\n    return values[this.random(0, values.length - 1)];\n  }\n\n  private readonly COMPARTMENT_SHIFT = 35;\n\n  public getLegend(): Observable<cytoscape.ElementsDefinition> {\n    return of(legend)\n  }\n\n  public getNormalPathway(id: string): Observable<string> {\n    return this.http.get(`https://dev.reactome.org/ContentService/data/query/${id}/normalPathway`, {responseType: \"text\"}).pipe(\n      map(data => data.split('\\t')[0])\n    )\n  }\n\n  public getDiagram(id: number | string): Observable<cytoscape.ElementsDefinition> {\n    return forkJoin({\n      diagram: this.http.get<Diagram>(`${environment.host}/download/current/diagram/${id}.json`),\n      graph: this.http.get<Graph.Data>(`${environment.host}/download/current/diagram/${id}.graph.json`)\n    }).pipe(\n      tap(({diagram, graph}) => console.log('Normal diagram:', diagram, 'Normal graph', graph)),\n      switchMap(({diagram, graph}) => {\n        if (diagram.forNormalDraw !== undefined && !diagram.forNormalDraw) {\n          return this.getNormalPathway(diagram.stableId).pipe(\n            switchMap(normalPathwayId => forkJoin({\n              normalDiagram: this.http.get<Diagram>(`${environment.host}/download/current/diagram/${normalPathwayId}.json`),\n              normalGraph: this.http.get<Graph.Data>(`${environment.host}/download/current/diagram/${normalPathwayId}.graph.json`)\n            })),\n            tap(({\n                   normalGraph,\n                   normalDiagram\n                 }) => console.log('Normal diagram:', normalGraph, 'Normal graph', normalDiagram)),\n            map(({normalGraph, normalDiagram}) => {\n              graph.nodes.push(...normalGraph.nodes);\n              graph.edges.push(...normalGraph.edges);\n              if (normalDiagram.shadows) {\n                normalDiagram.shadows.forEach(shadow => shadow.isFadeOut = true);\n                diagram.shadows = diagram.shadows || [];\n                diagram.shadows.push(...normalDiagram.shadows);\n\n                graph.subpathways = graph.subpathways || [];\n                graph.subpathways.push(...normalGraph.subpathways);\n              }\n              return {diagram, graph};\n            }),\n            catchError(err => of({diagram, graph}))\n          )\n        } else {\n          return of({diagram, graph});\n        }\n      }),\n      tap((mergedResponse) => console.log('All responses:', mergedResponse)),\n      map(({diagram, graph}) => {\n\n        console.log(\"edge.reactionType\", new Set(diagram.edges.flatMap(edge => edge.reactionType)))\n        console.log(\"node.connectors.types\", new Set(diagram.nodes.flatMap(node => node.connectors.flatMap(con => con.type))))\n        console.log(\"node.renderableClass\", new Set(diagram.nodes.flatMap(node => node.renderableClass)))\n        console.log(\"links.renderableClass\", new Set(diagram.links.flatMap(link => link.renderableClass)))\n        console.log(\"shadow.renderableClass\", new Set(diagram.shadows.flatMap(shadow => shadow.renderableClass)))\n\n        const idToEdges = new Map<number, Edge>(diagram.edges.map(edge => [edge.id, edge]));\n        const idToNodes = new Map<number, Node>(diagram.nodes.map(node => [node.id, node]));\n        const reactomeIdToEdge = new Map<number, Edge>(\n          [\n            // ...diagram.nodes.map(node => [node.reactomeId, node]),\n            ...diagram.edges.map(edge => [edge.reactomeId, edge])\n          ] as [number, Edge][]\n        );\n\n        const edgeIds = new Map<string, number>();\n        const forwardArray = diagram.edges.flatMap(edge => edge.segments.map(segment => [posToStr(edge, scale(segment.from)), scale(segment.to)])) as [string, Position][];\n        this.extraLine = new Map<string, Position>(forwardArray);\n        console.assert(forwardArray.length === this.extraLine.size, \"Some edge diagram have been lost because 2 segments are starting from the same point\")\n\n        const backwardArray = diagram.edges.flatMap(edge => edge.segments.map(segment => [posToStr(edge, scale(segment.to)), scale(segment.from)])) as [string, Position][];\n        this.reverseExtraLine = new Map<string, Position>(backwardArray);\n        console.assert(backwardArray.length == this.reverseExtraLine.size, \"Some edge diagram have been lost because 2 segments are ending at the same point\")\n\n\n        const subpathwayIds = new Set<number>(diagram.shadows.map((shadow) => shadow.reactomeId))\n\n        const eventIdToSubPathwayId = new Map<number, number>(graph.subpathways?.flatMap(subpathway => subpathway.events\n          .map(event => [event, subpathway.dbId])\n          .filter(entry => subpathwayIds.has(entry[1]))) as [number, number][] || [])\n\n        const subpathwayIdToEventIds = new Map<number, number[]>(graph.subpathways?.map(subpathway => [subpathway.dbId, subpathway.events]));\n\n        // create a node id - graph node mapping\n        const dbIdToGraphNode = new Map<number, Graph.Node>(graph.nodes.map(node => ([node.dbId, node]) || []))\n        const mappingList: [number, Graph.Node][] = graph.nodes.flatMap(node => {\n          if (node.children && node.children.length === 1) { // Consider homomer complex like their constituents for interactors\n            return node.diagramIds?.map(id => [id, dbIdToGraphNode.get(node.children[0])])\n              .filter(entry => entry[1] !== undefined) as [number, Graph.Node][]\n          } else {\n            return node.diagramIds?.map(id => [id, node]) as [number, Graph.Node][]\n          }\n        }).filter(entry => entry !== undefined);\n\n        const idToGraphNodes = new Map([...mappingList]);\n        const idToGraphEdges = new Map(graph.edges.map(edge => [edge.dbId, edge]));\n\n        const getLeaves = (node: Graph.Node, leaves: Set<Graph.Node>) => {\n          if (node.leaves && node.leaves.length > 0) {\n            node.leaves.forEach(leave => leaves.add(leave));\n          } else {\n            if (node.children && node.children.length > 0)\n              node.children.forEach(child => getLeaves(dbIdToGraphNode.get(child)!, leaves))\n            else\n              leaves.add(node);\n          }\n        }\n\n        idToGraphNodes.forEach(node => {\n          let leaves = new Set<Graph.Node>();\n          getLeaves(node, leaves);\n          node.leaves = [...leaves];\n        })\n\n        const dbIdToGraphEdge = new Map<number, Graph.Edge>(graph.edges.map(edge => ([edge.dbId, edge]) || []))\n\n        const hasFadeOut = diagram.nodes.some(node => node.isFadeOut);\n        const normalNodes = diagram.nodes.filter(node => node.isFadeOut);\n        const specialNodes = diagram.nodes.filter(node => !node.isFadeOut);\n        const posToNormalNode = new Map(normalNodes.map(node => [pointToStr(node.position), node]));\n        const posToSpecialNode = new Map(specialNodes.map(node => [pointToStr(node.position), node]));\n\n        const normalEdges = diagram.edges.filter(edge => edge.isFadeOut);\n        const specialEdges = diagram.edges.filter(edge => !edge.isFadeOut);\n        const posToNormalEdge = new Map(normalEdges.map(edge => [pointToStr(edge.position), edge]));\n        const posToSpecialEdge = new Map(specialEdges.map(edge => [pointToStr(edge.position), edge]));\n\n        //compartment nodes\n        const compartmentNodes: cytoscape.NodeDefinition[] = diagram?.compartments.flatMap(item => {\n          const propToRects = (prop: Prop): { [p: string]: number } => ({\n            left: scale(prop.x),\n            top: scale(prop.y),\n            right: scale(prop.x + prop.width),\n            bottom: scale(prop.x + prop.height),\n          })\n\n          let innerCR = 10;\n          let outerCR\n          if (item.insets) {\n            const rects = [propToRects(item.prop), propToRects(item.insets)]\n            outerCR = Object.keys(rects[0]).reduce((smallest, key) => Math.min(smallest, Math.abs(rects[0][key] - rects[1][key])), Number.MAX_SAFE_INTEGER);\n            outerCR = innerCR + Math.min(outerCR, 100)\n          }\n\n          const layers: cytoscape.NodeDefinition[] = [\n            {\n              data: {\n                id: item.id + '-outer',\n                displayName: item.displayName,\n                textX: scale(item.textPosition.x - (item.prop.x + item.prop.width)) + this.COMPARTMENT_SHIFT,\n                textY: scale(item.textPosition.y - (item.prop.y + item.prop.height)) + this.COMPARTMENT_SHIFT,\n                width: scale(item.prop.width),\n                height: scale(item.prop.height),\n                radius: outerCR\n              },\n              classes: ['Compartment', 'outer'],\n              position: scale(item.position),\n              selectable: false,\n            }\n          ];\n\n          if (item.insets) {\n            layers.push({\n              data: {\n                id: item.id + '-inner',\n                width: scale(item.insets.width),\n                height: scale(item.insets.height),\n                radius: innerCR\n              },\n              classes: ['Compartment', 'inner'],\n              position: scale({x: item.insets.x + item.insets.width / 2, y: item.insets.y + item.insets.height / 2}),\n              selectable: false,\n            })\n          }\n          return layers;\n        });\n\n        const replacementMap = new Map<string, string>();\n\n        //reaction nodes\n        const reactionNodes: cytoscape.NodeDefinition[] = diagram?.edges.map(item => {\n          let replacement, replacedBy;\n          if (item.isFadeOut) {\n            replacedBy = posToSpecialEdge.get(pointToStr(item.position))?.id.toString() || specialEdges.find(edge => squaredDist(scale(edge.position), scale(item.position)) < 5 ** 2)?.id.toString();\n            if (replacedBy) {\n              replacementMap.set(item.id.toString(), replacedBy)\n              replacementMap.set(replacedBy, item.id.toString())\n            }\n          }\n          if (!item.isFadeOut) {\n            replacement = posToNormalEdge.get(pointToStr(item.position))?.id.toString() || normalEdges.find(edge => squaredDist(scale(edge.position), scale(item.position)) < 5 ** 2)?.id.toString();\n          }\n          return ({\n            data: {\n              id: item.id + '',\n              // displayName: item.displayName,\n              inputs: item.inputs,\n              output: item.outputs,\n              isFadeOut: item.isFadeOut,\n              isBackground: item.isFadeOut,\n              reactomeId: item.reactomeId,\n              reactionId: item.id,\n              graph: idToGraphEdges.get(item.reactomeId),\n              replacement, replacedBy\n            },\n            classes: this.reactionTypeMap.get(item.reactionType),\n            position: scale(item.position)\n          });\n        });\n\n\n        //entity nodes\n        const entityNodes: cytoscape.NodeDefinition[] = diagram?.nodes.flatMap(item => {\n          const classes = [...this.nodeTypeMap.get(item.renderableClass)!] || [item.renderableClass.toLowerCase()];\n          let replacedBy: string | undefined;\n          let replacement: string | undefined;\n          if (item.isDisease) classes.push('disease');\n          if (item.isCrossed) classes.push('crossed');\n          if (item.trivial) classes.push('trivial');\n          if (item.needDashedBorder) classes.push('loss-of-function');\n          if (item.isFadeOut) {\n            replacedBy = posToSpecialNode.get(pointToStr(item.position))?.id.toString()\n            if (!replacedBy) {\n              replacedBy = specialNodes.find(node => overlapLimited(item, node, 0.8))?.id.toString();\n            }\n            if (replacedBy) {\n              replacementMap.set(item.id.toString(), replacedBy)\n              replacementMap.set(replacedBy, item.id.toString())\n            }\n          }\n          if (!item.isFadeOut) replacement = posToNormalNode.get(pointToStr(item.position))?.id.toString() //|| normalNodes.find(node => overlap(item, node))?.id.toString();\n          if (classes.some(clazz => clazz === 'RNA')) item.prop.height -= 10;\n          if (classes.some(clazz => clazz === 'Cell')) item.prop.height /= 2;\n\n          const isBackground = item.isFadeOut || classes.some(clazz => clazz === 'Pathway') || item.connectors.some(connector => connector.isFadeOut);\n          item.isBackground = isBackground;\n          let html = undefined;\n          let width = scale(item.prop.width);\n          let height = scale(item.prop.height);\n          let preferredId = idToGraphNodes.get(item.id)?.identifier;\n          if (classes.some(clazz => clazz === 'Protein')) {\n            html = this.getStructureVideoHtml({...item, type: 'Protein'}, width, height, preferredId);\n          } else if (classes.some(clazz => clazz === 'Molecule')) {\n            html = `<img src=\"https://www.ebi.ac.uk/chebi/displayImage.do?defaultImage=true&chebiId=${preferredId}&dimensions=1080&transbg=true\" style=\"max-width: ${width / 2 - 4}px; max-height:${height}px\" alt=\"\">`;\n          }\n          if (isBackground && !item.isFadeOut) {\n            replacementMap.set(item.id.toString(), item.id.toString())\n          }\n          const isFadeOut = !item.isCrossed && item.isFadeOut;\n          const nodes: cytoscape.NodeDefinition[] = [\n            {\n              data: {\n                id: item.id + '',\n                reactomeId: item.reactomeId,\n                displayName: item.displayName.replace(/([/,:;-])/g, \"$1\\u200b\"),\n                height: height,\n                width: width,\n                graph: idToGraphNodes.get(item.id),\n                acc: preferredId,\n                html,\n                isFadeOut,\n                isBackground,\n                replacement,\n                replacedBy\n              },\n              classes: classes,\n              position: scale(item.position)\n            }\n          ];\n          if (item.nodeAttachments) {\n            nodes.push(...item.nodeAttachments.map(ptm => ({\n              data: {\n                id: item.id + '-' + ptm.reactomeId,\n                reactomeId: ptm.reactomeId,\n                nodeId: item.id,\n                nodeReactomeId: item.reactomeId,\n                displayName: ptm.label,\n                height: scale(ptm.shape.b.y - ptm.shape.a.y),\n                width: scale(ptm.shape.b.x - ptm.shape.a.x),\n                isFadeOut,\n                isBackground,\n                replacement,\n                replacedBy\n              },\n              classes: \"Modification\",\n              position: scale(ptm.shape.centre)\n            })))\n          }\n          return nodes\n        });\n\n        //sub pathways\n        const shadowNodes: cytoscape.NodeDefinition[] = diagram?.shadows.map(item => {\n          return {\n            data: {\n              id: item.id + '',\n              displayName: item.displayName,\n              height: scale(item.prop.height),\n              width: scale(item.prop.width),\n              reactomeId: item.reactomeId,\n              isFadeOut: item.isFadeOut,\n              replacedBy: item.isFadeOut,\n              triggerPosition: scale(item.maxX)\n            },\n            classes: ['Shadow'],\n            position: closestToAverage(subpathwayIdToEventIds.get(item.reactomeId)!.map(reactionId => reactomeIdToEdge.get(reactionId)!).map(edge => scale(edge!.position)))\n          }\n        });\n\n        avoidOverlap(shadowNodes);\n\n        const T = 4;\n        const ARROW_MULT = 1.5;\n        const EDGE_MARGIN = 6;\n        const REACTION_RADIUS = 3 * T;\n        const MIN_DIST = EDGE_MARGIN;\n\n\n        /**\n         * iterate nodes connectors to get all edges information based on the connector type.\n         *\n         */\n        const edges: cytoscape.EdgeDefinition[] =\n          diagram.nodes.flatMap(node => {\n              return node.connectors.map(connector => {\n                const reaction = idToEdges.get(connector.edgeId)!;\n\n                const reactionP = scale(reaction.position);\n                const nodeP = scale(node.position);\n\n                const [source, target] = connector.type !== 'OUTPUT' ?\n                  [node, reaction] :\n                  [reaction, node];\n\n                const sourceP = scale(source.position);\n                const targetP = scale(target.position);\n\n                let points = connector.segments\n                  .flatMap((segment, i) => i === 0 ? [segment.from, segment.to] : [segment.to])\n                  .map(pos => scale(pos));\n                if (connector.type === 'OUTPUT') points.reverse();\n                if (points.length === 0) points.push(reactionP);\n\n                this.addEdgeInfo(reaction, points, 'backward', sourceP);\n                this.addEdgeInfo(reaction, points, 'forward', targetP);\n\n                let [from, to] = [points.shift()!, points.pop()!]\n                from = from ?? nodeP; // Quick fix to avoid problem with reaction without visible outputs like R-HSA-2424252 in R-HSA-1474244\n                to = to ?? reactionP; // Quick fix to avoid problem with reaction without visible outputs like R-HSA-2424252 in R-HSA-1474244\n                if (connector.type === 'CATALYST') {\n                  to = scale(connector.endShape.centre);\n                }\n\n                // points = addRoundness(from, to, points);\n                const relatives = this.absoluteToRelative(from, to, points);\n\n                const classes = [...this.edgeTypeMap.get(connector.type)!];\n                if (reaction.isDisease) classes.push('disease');\n                if (node.trivial) classes.push('trivial');\n                if (eventIdToSubPathwayId.has(reaction.reactomeId)) classes.push('shadow');\n\n                let d = dist(from, to);\n                if (equal(from, reactionP) || equal(to, reactionP)) d -= REACTION_RADIUS;\n                if (classes.includes('positive-regulation') || classes.includes('catalysis') || classes.includes('production')) d -= ARROW_MULT * T;\n                // console.assert(d > MIN_DIST, `The edge between reaction: R-HSA-${reaction.reactomeId} and entity: R-HSA-${node.reactomeId} in pathway ${id} has a visible length of ${d} which is shorter than ${MIN_DIST}`)\n                console.assert(d > MIN_DIST, `${id}\\t${diagram.displayName}\\t${hasFadeOut}\\tR-HSA-${reaction.reactomeId}\\tR-HSA-${node.reactomeId}\\thttps://release.reactome.org/PathwayBrowser/#/${id}&SEL=R-HSA-${reaction.reactomeId}&FLG=R-HSA-${node.reactomeId}\\thttps://reactome-pwp.github.io/PathwayBrowser/${id}?select=${reaction.reactomeId}&flag=${node.reactomeId}`)\n\n                let replacement, replacedBy;\n                if (connector.isFadeOut) {\n                  // First case: same node is used both special and normal context\n                  // replacedBy = node.connectors.find(otherConnector => otherConnector !== connector && !otherConnector.isFadeOut && samePoint(idToEdges.get(otherConnector.edgeId)!.position, reaction.position))?.edgeId;\n                  // Second case: different nodes are used between special and normal context\n                  // replacedBy = replacedBy || (posToSpecialNode.get(pointToStr(node.position)) && posToSpecialEdge.get(pointToStr(reaction.position)))?.id;\n\n                  replacedBy = replacementMap.get(node.id.toString()) && replacementMap.get(reaction.id.toString())\n                }\n                if (!connector.isFadeOut) {\n                  // First case: same node is used both special and normal context\n                  replacement = node.connectors.find(otherConnector => otherConnector !== connector && otherConnector.isFadeOut && samePoint(idToEdges.get(otherConnector.edgeId)!.position, reaction.position))?.edgeId;\n                  // console.log(\"Reaction edge\", replacement)\n\n                  // Second case: different nodes are used between special and normal context\n                  replacement = replacement || (posToNormalNode.get(pointToStr(node.position)) && posToNormalEdge.get(pointToStr(reaction.position)))?.id;\n                  // console.log(\"Reaction edge\", replacement)\n\n                }\n                const edge: cytoscape.EdgeDefinition = {\n                  data: {\n                    id: this.getEdgeId(source, connector, target, edgeIds),\n                    graph: dbIdToGraphEdge.get(reaction.reactomeId),\n                    source: source.id + '',\n                    target: target.id + '',\n                    stoichiometry: connector.stoichiometry.value,\n                    weights: relatives.weights.join(\" \"),\n                    distances: relatives.distances.join(\" \"),\n                    sourceEndpoint: this.endpoint(sourceP, from),\n                    targetEndpoint: this.endpoint(targetP, to),\n                    pathway: eventIdToSubPathwayId.get(reaction.reactomeId),\n                    reactomeId: reaction.reactomeId,\n                    reactionId: reaction.id,\n                    isFadeOut: reaction.isFadeOut,\n                    isBackground: reaction.isFadeOut,\n                    replacedBy, replacement\n                  },\n                  classes: classes\n                };\n                return edge\n              });\n            }\n          );\n\n        const linkEdges: cytoscape.EdgeDefinition[] = diagram.links\n          ?.filter(link => !link.renderableClass.includes('EntitySet') || link.inputs[0].id !== link.outputs[0].id)\n          ?.map(link => {\n              const source = idToNodes.get(link.inputs[0].id)!;\n              const target = idToNodes.get(link.outputs[0].id)!;\n\n              const sourceP = scale(source.position);\n              const targetP = scale(target.position);\n\n              let points = link.segments\n                .flatMap((segment, i) => i === 0 ? [segment.from, segment.to] : [segment.to])\n                .map(pos => scale(pos));\n\n              let [from, to] = [points.shift()!, points.pop()!]\n              from = from ?? sourceP; // Quick fix to avoid problem with reaction without visible outputs like R-HSA-2424252 in R-HSA-1474244\n              to = to ?? targetP; // Quick fix to avoid problem with reaction without visible outputs like R-HSA-2424252 in R-HSA-1474244\n\n              // points = addRoundness(from, to, points);\n              const relatives = this.absoluteToRelative(from, to, points);\n\n              const classes = [...this.linkClassMap.get(link.renderableClass)!];\n              if (link.isDisease) classes.push('disease');\n              const isBackground = link.isFadeOut ||\n                idToNodes.get(link.inputs[0].id)?.isBackground &&\n                idToNodes.get(link.outputs[0].id)?.isBackground;\n\n              return {\n                data: {\n                  id: link.id + '',\n                  source: link.inputs[0].id + '',\n                  target: link.outputs[0].id + '',\n                  weights: relatives.weights.join(\" \"),\n                  distances: relatives.distances.join(\" \"),\n                  sourceEndpoint: this.endpoint(sourceP, from),\n                  targetEndpoint: this.endpoint(targetP, to),\n                  isFadeOut: link.isFadeOut,\n                  isBackground: isBackground\n                },\n                classes: classes,\n                selectable: false\n              }\n            }\n          )\n\n        return {\n          nodes: [...compartmentNodes, ...reactionNodes, ...entityNodes, ...shadowNodes],\n          edges: [...edges, ...linkEdges]\n        };\n      }),\n      tap((output) => console.log('Output:', output)),\n    )\n\n  }\n\n  getStructureVideoHtml(item: {\n    id: string | number,\n    type: string\n  }, width: number, height: number, uniprotId: string | undefined) {\n    if (item.type === 'Protein')\n      return `<video loop id=\"video-${item.id}\" width=\"${width + 10}\" height=\"${height + 10}\"  preload=\"none\">\n                <source src=\"${environment.s3}/structures/${uniprotId}.mov\" type=\"video/quicktime\">\n                <source src=\"${environment.s3}/structures/${uniprotId}.webm\" type=\"video/webm\">\n              </video>`;\n    return undefined;\n  }\n\n  private getEdgeId(source: Edge | Node, connector: NodeConnector, target: Edge | Node, edgeIds: Map<string, number>) {\n    let edgeId = `${source.id} --${this.edgeTypeToStr.get(connector.type)} ${target.id}`;\n\n    if (edgeIds.has(edgeId)) {\n      let count = edgeIds.get(edgeId)!;\n      edgeIds.set(edgeId, count++);\n      edgeId += ` (${count})`;\n      console.warn('Conflicting edge id: ', edgeId)\n    } else {\n      edgeIds.set(edgeId, 0)\n    }\n    return edgeId;\n  }\n\n  private addEdgeInfo(edge: Edge, points: Position[], direction: 'forward' | 'backward', stop: Position) {\n    const stopPos = posToStr(edge, stop);\n    if (direction === 'forward') {\n      const map = this.extraLine;\n      let pos = posToStr(edge, points.at(-1)!)\n      while (map.has(pos) && pos !== stopPos) {\n        points.push(map.get(pos)!)\n        pos = posToStr(edge, points.at(-1)!)\n      }\n    } else {\n      const map = this.reverseExtraLine;\n      let pos = posToStr(edge, points.at(0)!)\n      while (map.has(pos) && pos !== stopPos) {\n        points.unshift(map.get(pos)!)\n        pos = posToStr(edge, points.at(0)!)\n      }\n    }\n  }\n\n  private endpoint(source: Position, point: Position): string {\n    return `${point.x - source.x} ${point.y - source.y}`\n  }\n\n\n  /**\n   * Use Matrix power to convert points from an absolute coordinate system to an edge relative system\n   *\n   * Visually explained by https://youtu.be/kYB8IZa5AuE?si=vJKi-MUv2dCRQ5oA<br>\n   * Short version ==> https://math.stackexchange.com/q/1855051/683621\n   * @param source Position position of the edge source:  {x:number, y:number}\n   * @param target Position position of the edge target:  {x:number, y:number}\n   * @param toConvert Array of Position to convert to the edge-relative system\n   * @return The points converted to relative coordinates {distances: number[], weights: number[]}\n   */\n  private absoluteToRelative(source: Position, target: Position, toConvert: Position[]): RelativePosition {\n    const relatives: RelativePosition = {distances: [], weights: []};\n    if (toConvert.length === 0) return relatives;\n\n    const mainVector = array([target.x - source.x, target.y - source.y]); // Edge vector\n    const orthoVector = array([-mainVector.y, mainVector.x]) // Perpendicular vector\n      .normalize(); //Normalized to have the distance expressed in pixels https://math.stackexchange.com/a/413235/683621\n    let transform = array([\n      [mainVector.x, mainVector.y],\n      [orthoVector.x, orthoVector.y],\n    ]).inv(); // Should always be invertible if the ortho vector is indeed perpendicular\n\n    for (let coord of toConvert) {\n      const absolute = array([[coord.x - source.x, coord.y - source.y]]);\n      const relative = absolute.multiply(transform);\n      relatives.weights.push(relative.get(0, 0))\n      relatives.distances.push(relative.get(0, 1))\n    }\n    return relatives;\n  }\n\n  public randomNetwork(): Observable<cytoscape.ElementsDefinition> {\n    const amount = 100;\n    const peTypes = ['Protein', 'EntitySet', 'GenomeEncodedEntity', 'RNA', 'Gene', 'Complex', 'Molecule'];\n    // const peTypes = ['Gene'];\n    const reactionTypes = ['association', 'dissociation', 'transition', 'uncertain', 'omitted'];\n\n    const physicalEntities: cytoscape.NodeDefinition[] = Array.from({length: amount}, (x, i) => {\n      const clazz = this.pick(peTypes);\n      return {\n        group: 'nodes',\n        data: {\n          id: i.toString(),\n          width: this.random(150, 300),\n          height: this.random(50, 150),\n          displayName: clazz,\n          parent: 'Compartment'\n        },\n        classes: [clazz, \"PhysicalEntity\", this.pick([\"drug\", \"\", \"\"])]\n      };\n    });\n\n    const reactions: cytoscape.NodeDefinition[] = physicalEntities.map((node, i) =>\n      ({\n        group: 'nodes',\n        data: {\n          id: `${i}-react`,\n          parent: 'Compartment'\n        },\n        classes: [this.pick(reactionTypes), 'reaction']\n      })\n    );\n\n    const nodes: cytoscape.NodeDefinition[] = physicalEntities.flatMap((node, i) =>\n      [node, reactions[i]]\n    );\n\n\n    const inOut: cytoscape.EdgeDefinition[] = physicalEntities.flatMap((node, i) => [\n      {\n        group: 'edges',\n        data: {\n          source: `${i}`,\n          target: `${i}-react`,\n          stoichiometry: this.pick([undefined, -1, 0, 1, 2])\n        },\n        classes: ['consumption']\n      },\n      {\n        group: 'edges',\n        data: {\n          source: `${i}-react`,\n          target: `${(i + 1) % amount}`,\n          stoichiometry: this.pick([undefined, -1, 0, 1, 2])\n        },\n\n        classes: ['production']\n      },\n    ])\n\n    const additionalIn: cytoscape.EdgeDefinition[] = Array.from({length: amount / 4}).map(() => ({\n      group: 'edges',\n      data: {\n        source: this.pick(physicalEntities).data.id!,\n        target: this.pick(reactions).data.id!,\n      },\n      classes: this.pick(['catalysis', 'positive-regulation', 'negative-regulation', 'set-to-member'])\n    }));\n\n\n    const edges: cytoscape.EdgeDefinition[] = [...inOut, ...additionalIn];\n\n    return of({ // list of graph elements to start with\n      nodes: [\n        {\n          data: {id: 'Compartment'},\n          classes: ['Compartment'],\n          pannable: true,\n          grabbable: false,\n          selectable: false\n        },\n        ...nodes\n      ]\n      , edges\n    })\n  }\n}\n\nfunction samePoint(p1: Position, p2: Position) {\n  return p1.x === p2.x && p1.y === p2.y\n}\n\nfunction overlapLimited(nodeA: Node, nodeB: Node, limit: number = 0.8): boolean {\n  if (nodeA.position.x === nodeB.position.x && nodeA.position.y === nodeB.position.y) return true;\n  const rectA = getRect(nodeA), rectB = getRect(nodeB);\n  const o: Rectangle = {\n    left: Math.max(rectA.left, rectB.left),\n    right: Math.min(rectA.right, rectB.right),\n    top: Math.max(rectA.top, rectB.top),\n    bottom: Math.min(rectA.bottom, rectB.bottom)\n  }\n  return (o.left < o.right && o.top < o.bottom) && ((area(o) / area(rectA)) > limit);\n}\n\nfunction overlap(nodeA: Node, nodeB: Node): boolean {\n  if (nodeA.position.x === nodeB.position.x && nodeA.position.y === nodeB.position.y) return true;\n  const rectA = getRect(nodeA), rectB = getRect(nodeB);\n  return Math.max(rectA.left, rectB.left) < Math.min(rectA.right, rectB.right)\n    && Math.max(rectA.top, rectB.top) < Math.min(rectA.bottom, rectB.bottom);\n}\n\nfunction area(rect: Rectangle) {\n  return (rect.right - rect.left) * (rect.bottom - rect.top)\n}\n\nfunction getRect(node: Node): Rectangle {\n  if (node.rect) return node.rect\n  const halfWidth = node.prop.width / 2;\n  const halfHeight = node.prop.height / 2;\n  node.rect = {\n    left: node.position.x - halfWidth,\n    right: node.position.x + halfWidth,\n    top: node.position.y - halfHeight,\n    bottom: node.position.y + halfHeight,\n  }\n  return node.rect;\n}\n\n/**\n * Create a temporary cytoscape session to apply a layout to the nodes in order to avoid them to overlap each others\n */\nfunction avoidOverlap(definitions: cytoscape.NodeDefinition[]) {\n  const container = document.createElement(\"div\");\n\n  const style = new Style(container, {});\n  const cy = cytoscape({\n    container: container,\n    style: style.getStyleSheet(),\n    elements: definitions,\n    layout: {name: 'preset'}\n  });\n\n  const nodes = cy.nodes();\n  nodes.forEach(node => {\n    const bb = node.boundingBox({includeLabels: true, includeNodes: false});\n    node.style({width: bb.w, height: bb.h})\n  })\n\n  const layout = nodes.layout({\n    name: 'fcose',\n    nodeRepulsion: 15,\n    animate: false,\n    fit: true,\n    packComponents: false,\n    randomize: false,\n    tile: false,\n  } as FcoseLayoutOptions);\n  layout.run()\n\n  definitions.forEach(def => def.position = cy.getElementById(def.data.id!).position());\n\n  cy.destroy()\n  container.remove()\n}\n","export function isDefined<T>(value: T | undefined | null): value is T {\n  return value !== undefined && value !== null\n}\n","export const environment = {\n  production: false,\n  host: \"https://dev.reactome.org\",\n  s3: \"https://s3.amazonaws.com/download.reactome.org\"\n};\n","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\n\nexport const gene: DrawerProvider = (properties, {\n  width,\n  height,\n  drug,\n  interactor,\n  disease,\n  lossOfFunction\n}) => {\n  const t = extract(properties.global.thickness);\n  const dHeight = extract(properties.gene.decorationHeight);\n  const dWidth = extract(properties.gene.decorationExtraWidth);\n  const headSize = extract(properties.gene.arrowHeadSize);\n  const radius = extract(properties.gene.arrowRadius);\n  const fill = extract(properties.gene.fill);\n  const stroke = interactor ? extract(properties.interactor.fill) : disease ? extract(properties.global.negativeContrast) : null;\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const hh = Math.sqrt(Math.pow(headSize, 2) * 3 / 4)\n\n  const halfWidth = width / 2;\n\n  const r = extract(properties.gene.borderRadius);\n  const oR = r + t;\n  const iR = r - t;\n  const t_2 = t / 2;\n  const t2 = t * 2;\n  return {\n    background: {\n      \"background-image\": `\n          <path fill=\"${fill}\" class=\"gradient\" stroke-linecap=\"round\" transform=\"translate(${t_2} ${t_2})\"\n      ${stroke ? `stroke=\"${stroke}\" stroke-width=\"${t}\"` : ''}\n      ${lossOfFunction ? `stroke-dasharray=\"${t} ${t2}\"` : ''}  d=\"\n            M ${0} ${dHeight}\n            H ${width}\n            v ${height - dHeight - radius}\n            a ${radius} ${radius} 0 0 1 -${radius} ${radius}\n            H ${radius}\n            a ${radius} ${radius} 0 0 1 -${radius} -${radius}\n            Z\n          \"/>`,\n      \"bounds-expansion\": t_2,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-position-x\": -t / 2,\n      \"background-position-y\": -t / 2,\n      \"background-width\": width + t,\n      \"background-height\": height + t,\n      requireGradient: true\n    },\n    decorators: [\n      {\n        \"background-image\": `\n          <path fill=\"none\" stroke=\"${fill}\" stroke-width=\"${t}\"  d=\"\n            M ${halfWidth} ${dHeight + 2 * t}\n            v -${dHeight - radius - (headSize + t) / 2 + 2 * t}\n            a ${radius} ${radius} 0 0 1 ${radius} -${radius}\n            h ${halfWidth - t - radius + dWidth}\n          \"/>\n            <path fill=\"${fill}\" stroke=\"${fill}\" stroke-width=\"${t}\" stroke-linejoin=\"round\"  d=\"\n            M ${width - hh - t_2 + dWidth} ${headSize / 2 + t_2}\n            v -${headSize / 2}\n            l ${hh} ${headSize / 2}\n            l -${hh} ${headSize / 2}\n            v -${headSize / 2}\n            z\n          \"/>`,\n        \"background-position-y\": -t / 2,\n        \"bounds-expansion\": dHeight,\n        \"background-height\": dHeight + 1.5 * t,\n        \"background-width\": width + dWidth,\n        \"background-clip\": \"none\",\n        \"background-image-containment\": \"over\",\n      }\n    ],\n    hover: {\n      \"background-image\": `<rect x=\"0\" y=\"0\" width=\"${width}\" height=\"${2 * t}\" fill=\"${hover}\"/>`,\n      \"background-position-y\": dHeight - t,\n      \"bounds-expansion\": t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": 2 * t,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oR} ${oR} 0 0 0 ${oR} ${oR}\n            h ${width - 2 * oR}\n            a ${oR} ${oR} 0 0 0 ${oR} -${oR}\n            a ${oR} ${iR} 0 0 1 -${oR} ${iR}\n            h -${width - 2 * oR}\n            a ${oR} ${iR} 0 0 1 -${oR} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": height - r,\n      \"bounds-expansion\": t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    flag: {\n      \"background-image\": `\n       <path fill=\"${flag}\" d=\"\n       M 0 0\n       H ${width + 4 * t}\n       V ${height - dHeight - r + t}\n       a ${oR + t} ${oR} 0 0 1 -${oR + t} ${oR}\n       H ${oR + t}\n       a ${oR + t} ${oR} 0 0 1 -${oR + t} -${oR}\n       Z\n       \"/>\n`,\n      \"background-position-x\": -2 * t,\n      \"background-position-y\": dHeight - t,\n      \"bounds-expansion\": 2 * t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * t,\n      \"background-height\": height + 2 * t - dHeight,\n    },\n    // analysis: {\n    //   \"background-image\": `${gradient}\n    //       <path fill=\"url(#gradient)\" transform=\"translate(${t_2} ${t_2})\"\n    //       d=\"\n    //         M ${0} ${dHeight}\n    //         H ${width}\n    //         v ${height - dHeight - radius}\n    //         a ${radius} ${radius} 0 0 1 -${radius} ${radius}\n    //         H ${radius}\n    //         a ${radius} ${radius} 0 0 1 -${radius} -${radius}\n    //         Z\n    //       \"/>`,\n    //   \"bounds-expansion\": t_2,\n    //   \"background-clip\": \"none\",\n    //   \"background-image-containment\": \"over\",\n    //   \"background-position-x\": -t / 2,\n    //   \"background-position-y\": -t / 2,\n    //   \"background-width\": width + t,\n    //   \"background-height\": height + t,\n    // }\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const molecule: DrawerProvider = (properties, {width, height, drug, interactor}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const thick = extract(properties.global.thickness);\n  const stroke = !interactor ? (\n    !drug ?\n      extract(properties.molecule.stroke) :\n      extract(properties.molecule.drug)\n  ) : extract(properties.interactor.fill);\n  const fill = extract(properties.molecule.fill);\n\n  const ht = thick / 2;\n  const halfHeight = height / 2;\n  const oR = halfHeight + thick;\n  const iR = halfHeight - thick;\n  const oRx = Math.min(oR, width / 2)\n  return {\n    hover: {\n      \"background-image\": `\n          <path fill=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 ${oR}\n            a ${oRx} ${oR} 0 0 1 ${oRx} -${oR}\n            h ${width - 2 * oRx + thick}\n            a ${oRx} ${oR} 0 0 1 ${oRx} ${oR}\n            a ${oRx} ${iR} 0 0 0 -${oRx} -${iR}\n            h -${width - 2 * oRx + thick}\n            a ${oRx} ${iR} 0 0 0 -${oRx} ${iR}\n            Z\"/>\n`,\n      \"background-position-y\": -thick,\n      \"background-position-x\": -thick / 2,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n      \"background-width\": width + thick,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oRx} ${oR} 0 0 0 ${oRx} ${oR}\n            h ${width - 2 * oRx + thick}\n            a ${oRx} ${oR} 0 0 0 ${oRx} -${oR}\n            a ${oRx} ${iR} 0 0 1 -${oRx} ${iR}\n            h -${width - 2 * oRx + thick}\n            a ${oRx} ${iR} 0 0 1 -${oRx} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": halfHeight,\n      \"background-position-x\": -thick / 2,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n      \"background-width\": width + thick,\n    },\n    flag: {\n      \"background-image\": `\n<rect width=\"${width + 4 * thick}\" height=\"${height + 2 * thick}\" rx=\"${oR + 2 * thick}\" ry=\"${oR}\" fill=\"${flag}\"/>\n<rect x=\"${2 * thick}\" y=\"${thick}\" width=\"${width}\" height=\"${height}\" rx=\"${oR}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${thick}\"/>\n`,\n      \"background-position-x\": -2 * thick,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": 2 * thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * thick,\n      \"background-height\": height + 2 * thick,\n    },\n    analysis: {\n      \"background-image\": `<rect fill=\"url(#gradient)\" width=\"${width}\" height=\"${height}\" rx=\"${halfHeight}\" stroke-width=\"${thick}\" stroke=\"${stroke}\"/>`,\n      requireGradient: true\n    }\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const protein: DrawerProvider = (properties, {width, height, drug}) => {\n  const fill = extract(properties.protein.fill);\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const thick = extract(properties.global.thickness);\n  const radius = extract(properties.protein.radius);\n\n  const oR = radius + thick;\n  const iR = radius - thick;\n\n  return {\n    hover: {\n      \"background-image\": `\n          <path fill=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 ${oR}\n            a ${oR} ${oR} 0 0 1 ${oR} -${oR}\n            h ${width - 2 * oR}\n            a ${oR} ${oR} 0 0 1 ${oR} ${oR}\n            a ${oR} ${iR} 0 0 0 -${oR} -${iR}\n            h -${width - 2 * oR}\n            a ${oR} ${iR} 0 0 0 -${oR} ${iR}\n            Z\"/>\n`,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oR} ${oR} 0 0 0 ${oR} ${oR}\n            h ${width - 2 * oR}\n            a ${oR} ${oR} 0 0 0 ${oR} -${oR}\n            a ${oR} ${iR} 0 0 1 -${oR} ${iR}\n            h -${width - 2 * oR}\n            a ${oR} ${iR} 0 0 1 -${oR} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": height - radius,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    flag: {\n      \"background-image\": `\n<rect width=\"${width + 4 * thick}\" height=\"${height + 2 * thick}\" rx=\"${oR }\"  fill=\"${flag}\"/>\n<rect x=\"${2*thick}\" y=\"${thick}\" width=\"${width}\" height=\"${height}\" rx=\"${radius}\" fill=\"${fill}\"/>\n`,\n      \"background-position-x\": -2 * thick,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": 2 * thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * thick,\n      \"background-height\": height + 2 * thick,\n    },\n    analysis: {\n      \"background-image\": `<rect width=\"${width}\" height=\"${height}\" class=\"gradient\" rx=\"${radius}\"/>`,\n      requireGradient: true\n    }\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\n\nexport const rna: DrawerProvider = (properties, {width, height}) => {\n  const thick = extract(properties.global.thickness);\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const fill = extract(properties.rna.fill);\n\n  const r = extract(properties.rna.radius);\n  const oR = r + thick;\n  const iR = r - thick;\n  return {\n    hover: {\n      \"background-image\": `<rect x=\"0\" y=\"0\" width=\"${width}\" height=\"${2 * thick}\" fill=\"${hover}\"/>`,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": 2 * thick,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oR} ${oR} 0 0 0 ${oR} ${oR}\n            h ${width - 2 * oR}\n            a ${oR} ${oR} 0 0 0 ${oR} -${oR}\n            a ${oR} ${iR} 0 0 1 -${oR} ${iR}\n            h -${width - 2 * oR}\n            a ${oR} ${iR} 0 0 1 -${oR} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": height - r,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    flag: {\n      \"background-image\": `\n       <path fill=\"${flag}\" d=\"\n       M 0 0\n       H ${width + 4 * thick}\n       V ${height - r + thick}\n       a ${oR + thick} ${oR} 0 0 1 -${oR + thick} ${oR}\n       H ${oR + thick}\n       a ${oR + thick} ${oR} 0 0 1 -${oR + thick} -${oR}\n       Z\n       \"/>\n       <path fill=\"${fill}\" d=\"\n       M ${2 * thick} ${thick}\n       H ${width + 2 * thick}\n       V ${height - r + thick}\n       a ${r} ${r} 0 0 1 -${r} ${r}\n       H ${r + 2 * thick}\n       a ${r} ${r} 0 0 1 -${r} -${r}\n       Z\"/>\n`,\n      \"background-position-x\": -2 * thick,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": 2 * thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * thick,\n      \"background-height\": height + 2 * thick,\n    },\n    analysis: {\n      \"background-image\": `\n       <path class=\"gradient\" d=\"\n       M 0 0\n       H ${width}\n       V ${height - r }\n       a ${r} ${r} 0 0 1 -${r} ${r}\n       H ${r}\n       a ${r} ${r} 0 0 1 -${r} -${r}\n       Z\"/>`,\n      requireGradient: true\n    }\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const genomeEncodedEntity: DrawerProvider = (properties, {\n  width,\n  height,\n  drug,\n  disease,\n  interactor,\n  lossOfFunction\n}) => {\n  const fill = !drug ?\n    extract(properties.complex.fill) :\n    extract(properties.genomeEncodedEntity.drug);\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const t = extract(properties.global.thickness);\n  const t_2 = t / 2;\n  const bottomR = extract(properties.genomeEncodedEntity.bottomRadius);\n  const stroke = !interactor ? !disease ? null : extract(properties.global.negativeContrast) : extract(properties.interactor.fill);\n\n  const topR = Math.min(extract(properties.genomeEncodedEntity.topRadius), height - bottomR, width / 2 - t);\n  const v = height - bottomR - topR;\n\n  const topOR = topR + t;\n  const topIR = topR - t;\n\n  const bottomOR = bottomR + t;\n  const bottomIR = bottomR - t;\n\n\n  return {\n    background: {\n      \"background-image\": `\n      <path fill=\"${fill}\" class=\"gradient\" stroke-linecap=\"round\" transform=\"translate(${t_2} ${t_2})\"\n      ${stroke ? `stroke=\"${stroke}\" stroke-width=\"${t}\"` : ''}\n      ${lossOfFunction ? `stroke-dasharray=\"${t} ${t * 2}\"` : ''}\n      d=\"\n      M ${topR} 0\n      H ${width - topR}\n      a ${topR} ${topR} 0 0 1 ${topR} ${topR}\n      v ${v}\n      a ${bottomR} ${bottomR} 0 0 1 -${bottomR} ${bottomR}\n      H ${bottomR}\n      a ${bottomR} ${bottomR} 0 0 1 -${bottomR} -${bottomR}\n      v -${v}\n      a ${topR} ${topR} 0 0 1 ${topR} -${topR}\n      Z\n      \"/>\n      `,\n      \"bounds-expansion\": t / 2,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-position-x\": -t_2,\n      \"background-position-y\": -t_2,\n      \"background-width\": width + t,\n      \"background-height\": height + t,\n    requireGradient: true\n    },\n    hover: {\n      \"background-image\": `\n          <path fill=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 ${topOR}\n            a ${topOR} ${topOR} 0 0 1 ${topOR} -${topOR}\n            h ${width - 2 * topOR}\n            a ${topOR} ${topOR} 0 0 1 ${topOR} ${topOR}\n            a ${topOR} ${topIR} 0 0 0 -${topOR} -${topIR}\n            h -${width - 2 * topOR}\n            a ${topOR} ${topIR} 0 0 0 -${topOR} ${topIR}\n            Z\"/>\n`,\n      \"background-position-y\": -t,\n      \"bounds-expansion\": t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": topOR,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${bottomOR} ${bottomOR} 0 0 0 ${bottomOR} ${bottomOR}\n            h ${width - 2 * bottomOR}\n            a ${bottomOR} ${bottomOR} 0 0 0 ${bottomOR} -${bottomOR}\n            a ${bottomOR} ${bottomIR} 0 0 1 -${bottomOR} ${bottomIR}\n            h -${width - 2 * bottomOR}\n            a ${bottomOR} ${bottomIR} 0 0 1 -${bottomOR} -${bottomIR}\n            Z\"/>\n`,\n      \"background-position-y\": height - bottomR,\n      \"bounds-expansion\": t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": bottomOR,\n    },\n    flag: {\n      \"background-image\": `\n      <path fill=\"${flag}\" d=\"\n      M ${topOR} 0\n      H ${width + 3 * t - topOR}\n      a ${topOR + t} ${topOR} 0 0 1 ${topOR + t} ${topOR}\n      v ${v}\n      a ${bottomOR + t} ${bottomOR} 0 0 1 -${bottomOR + t} ${bottomOR}\n      H ${bottomOR + t}\n      a ${bottomOR + t} ${bottomOR} 0 0 1 -${bottomOR + t} -${bottomOR}\n      v -${v}\n      a ${topOR + t} ${topOR} 0 0 1 ${topOR + t} -${topOR}\n      Z\n      \"/>\n`,\n      \"background-position-x\": -2 * t,\n      \"background-position-y\": -t,\n      \"bounds-expansion\": 2 * t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * t,\n      \"background-height\": height + 2 * t,\n    }\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\n\nexport const complex: DrawerProvider = (properties, {\n  width,\n  height,\n  drug,\n  disease,\n  interactor,\n  lossOfFunction\n}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n\n  const t = extract(properties.global.thickness);\n  const cut = extract(properties.complex.cut);\n  const fill = !drug ?\n    interactor ? extract(properties.interactor.fill) : extract(properties.complex.fill) :\n    extract(properties.complex.drug);\n\n  const stroke = !disease ? extract(properties.complex.stroke) : extract(properties.global.negativeContrast);\n\n  const cut2 = cut * 2;\n  const t2 = t * 2;\n  const v = height - cut2 - 2 * t2; // Vertical\n\n  const delta = 0;\n  const stateHeight = height / 2 + t;\n\n  const defs = `<defs>\n  <path id=\"octogon\" d=\"\n      M ${cut + t2 + delta} ${t2}\n      H ${width - cut - t2 - delta}\n      l ${cut} ${cut}\n      v ${v}\n      l -${cut} ${cut}\n      H ${cut + t2 + delta}\n      l -${cut} -${cut}\n      v -${v}\n      l  ${cut} -${cut}\n      Z\n      \"/>\n  </defs>`;\n  return {\n    background: {\n      \"background-image\": `\n      ${defs}\n      <use href=\"#octogon\" fill=\"${fill}\" stroke=\"${fill}\" stroke-width=\"${2 * t2}\" stroke-linejoin=\"round\"/>\n`\n    },\n    hover: {\n      \"background-image\": `\n      <path stroke=\"${hover}\" fill=\"none\" stroke-width=\"${2 * t2}\" stroke-linejoin=\"round\" d=\"\n      M ${t2} ${stateHeight}\n      v -${v / 2}\n      l ${cut} -${cut + t}\n      H ${width - cut - t2}\n      l ${cut} ${cut + t}\n      v ${v / 2}\n      \" />\n      `,\n      \"background-position-y\": -t,\n      \"background-height\": stateHeight,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": t\n    },\n    select: {\n      \"background-image\": `\n      <path stroke=\"${select}\" fill=\"none\" stroke-width=\"${2 * t2}\" stroke-linejoin=\"round\" d=\"\n      M ${t2} ${0}\n      v ${v / 2}\n      l ${cut} ${cut + t}\n      H ${width - cut - t2}\n      l ${cut} -${cut + t}\n      v -${v / 2}\n      \" />\n      `,\n      \"background-position-y\": height / 2,\n      \"background-height\": stateHeight,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": t\n    },\n    flag: {\n      \"background-image\": `\n<path id=\"octogon\" d=\"\n      M ${width / 2} ${3 * t}\n      H ${width - cut - delta}\n      l ${cut + t} ${cut}\n      v ${v}\n      l -${cut + t} ${cut}\n      H ${cut + delta + 2 * t2}\n      l -${cut + t} -${cut}\n      v -${v}\n      l  ${cut + t} -${cut}\n      Z\n      \" stroke=\"${flag}\" stroke-width=\"${3 * t2}\" stroke-linejoin=\"round\"/>\n`,\n      \"background-position-x\": -2 * t,\n      \"background-position-y\": -t,\n      \"bounds-expansion\": 2 * t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * t,\n      \"background-height\": height + 2 * t,\n    },\n    decorators: [\n      {\n        \"background-image\": `\n         ${defs}\n         <use href=\"#octogon\" fill=\"none\" stroke=\"${stroke}\" stroke-width=\"${t2}\" stroke-linejoin=\"round\" ${lossOfFunction ? `stroke-dasharray=\"${t2}\"` : ''} />\n         <use href=\"#octogon\" fill=\"${fill}\" class=\"gradient\"/>\n         `,\n        requireGradient: true\n      }\n    ],\n  }\n}\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\n\nexport const entitySet: DrawerProvider = (properties, {\n  width,\n  height,\n  drug,\n  disease,\n  lossOfFunction,\n  interactor\n}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n\n  const t = extract(properties.global.thickness);\n  let r = extract(properties.entitySet.radius);\n\n  if (2 * r > height / 2 - t) {\n\n    r = height / 4 - (t / 2);\n  }\n\n  width += 2 * r;\n\n  const fill =\n    !interactor ?\n      !drug ?\n        extract(properties.entitySet.fill) :\n        extract(properties.entitySet.drug)\n      : extract(properties.interactor.fill);\n  const stroke = !disease ?\n    extract(properties.entitySet.stroke) :\n    extract(properties.global.negativeContrast);\n\n  const r2 = r * 2;\n  const t2 = t * 2;\n  const v = height / 2 - r2 - t; // Vertical\n  const stateHeight = height / 2 + t;\n  const bracesOffset = r2 + t2;\n\n  let realDashLength = width;\n\n  if (lossOfFunction) {\n    const hidingLength = width - 2 * bracesOffset;\n    const idealDashLength = t2;\n    const dashNumber = Math.round((hidingLength / idealDashLength + 1) / 2);\n    realDashLength = hidingLength / (2 * dashNumber - 1);\n  }\n\n\n  const defs = `<defs>\n   <path id=\"curly\" d=\"\n       M ${r2 + t} ${t}\n       H ${width - r2 - t}\n       a ${r} ${r} 0 0 1 ${r} ${r}\n\n       v ${v}\n       a ${r} ${r} 0 0 0 ${r} ${r}\n       a ${r} ${r} 0 0 0 -${r} ${r}\n       v ${v}\n\n       a ${r} ${r} 0 0 1 -${r} ${r}\n       H ${r2 + t}\n       a ${r} ${r} 0 0 1 -${r} -${r}\n\n       v -${v}\n       a ${r} ${r} 0 0 0 -${r} -${r}\n       a ${r} ${r} 0 0 0 ${r} -${r}\n       v -${v}\n\n       a ${r} ${r} 0 0 1 ${r} -${r}\n       Z\n       \"/>\n   <clipPath id=\"inside\">\n     <use href=\"#curly\"/>\n   </clipPath>\n </defs>`;\n\n  const t1_5 = t * 1.5;\n  return {\n    background: {\n      \"background-image\": `\n       ${defs}\n       <use href=\"#curly\" fill=\"${fill}\" stroke=\"${fill}\" stroke-width=\"${t2}\" stroke-linejoin=\"round\"/>\n       `,\n      \"background-position-x\": -r,\n      \"background-width\": width + 2 * r,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": 2 * t,\n    },\n    hover: {\n      \"background-image\": `\n       <path stroke=\"${hover}\" stroke-width=\"${t2}\" fill=\"none\" stroke-linejoin=\"round\" d=\"\n         M ${r + t} ${stateHeight + r}\n         a ${r} ${r} 0 0 0 -${r} -${r}\n         a ${r} ${r} 0 0 0 ${r} -${r}\n         v -${v}\n         a ${r} ${r + t} 0 0 1 ${r} -${r + t}\n         H ${width - r2 - t}\n         a ${r} ${r + t} 0 0 1 ${r} ${r + t}\n         v ${v}\n         a ${r} ${r} 0 0 0 ${r} ${r}\n         a ${r} ${r} 0 0 0 -${r} ${r}\n       \"/>`,\n      \"background-position-x\": -r,\n      \"background-width\": width + 2 * r,\n\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": 2 * t,\n\n      \"background-position-y\": -t,\n      \"background-height\": stateHeight\n    },\n    select: {\n      \"background-image\": `\n       <path stroke=\"${select}\" stroke-width=\"${t2}\" fill=\"none\" stroke-linejoin=\"round\" d=\"\n         M ${r + t} ${-r}\n         a ${r} ${r} 0 0 1 -${r} ${r}\n         a ${r} ${r} 0 0 1 ${r} ${r}\n         v ${v}\n         a ${r} ${r + t} 0 0 0 ${r} ${r + t}\n         H ${width - r2 - t}\n         a ${r} ${r + t} 0 0 0 ${r} -${r + t}\n         v -${v}\n         a ${r} ${r} 0 0 1 ${r} -${r}\n         a ${r} ${r} 0 0 1 -${r} -${r}\n       \"/>`,\n      \"background-position-x\": -r,\n      \"background-width\": width + 2 * r,\n\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": 2 * t,\n\n      \"background-position-y\": height / 2,\n      \"background-height\": stateHeight\n    },\n    flag: {\n      \"background-image\": `\n<rect width=\"${width}\" height=\"${height + 2 * t}\" rx=\"${r + 3 * t}\" ry=\"${r + t2}\" fill=\"${flag}\"/>\n`,\n      \"background-position-x\": -2 * t,\n      \"background-position-y\": -t,\n      \"bounds-expansion\": 2 * t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width,\n      \"background-height\": height + 2 * t,\n    },\n    decorators: [\n      {\n        \"background-image\": `\n       ${defs}\n       <mask id=\"myMask\">\n         <rect fill=\"white\" x=\"0\" y=\"0\" width=\"${width}\" height=\"${height}\"/>\n         <rect fill=\"black\" x=\"${bracesOffset}\" y=\"${0}\" width=\"${width - 2 * bracesOffset}\" height=\"${height}\"/>\n       </mask>\n       <use href=\"#curly\" fill=\"none\" stroke=\"${stroke}\" stroke-width=\"${t2}\" clip-path=\"url(#inside)\" mask=\"url(#myMask)\"/>\n`,\n        \"background-position-x\": -r,\n        \"bounds-expansion\": r,\n        \"background-clip\": \"none\",\n        \"background-width\": width + 2 * r,\n      },\n    ],\n    analysis: {\n      'background-image': `<rect x=\"${r * 1.5}\" y=\"${t}\" width=\"${width - 2 * r * 1.5}\" rx=\"${r}\" height=\"${height - t2}\" class=\"gradient\"/>`,\n      \"background-position-x\": -r,\n      \"background-width\": width + 2 * r,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": 2 * t,\n      requireGradient: true\n    }\n    // analysis: {\n    //   'background-image': `${defs}${gradient}\n    //   <use href=\"#curly\" fill=\"url(#gradient)\" clip-path=\"url(#inside)\"/>\n    //   <mask id=\"myMask\">\n    //      <rect fill=\"white\" x=\"0\" y=\"0\" width=\"${width}\" height=\"${height}\"/>\n    //      <rect fill=\"black\" x=\"${bracesOffset}\" y=\"${0}\" width=\"${width - 2 * bracesOffset}\" height=\"${height}\"/>\n    //    </mask>\n    //    <use href=\"#curly\" fill=\"none\" stroke=\"${stroke}\" stroke-width=\"${t2}\" clip-path=\"url(#inside)\" mask=\"url(#myMask)\"/>`,\n    //   \"background-position-x\": -r,\n    //   \"bounds-expansion\": r,\n    //   \"background-clip\": \"none\",\n    //   \"background-width\": width + 2 * r,\n    // }\n  }\n}\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const cell: DrawerProvider = (properties, {width, height}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const thick = extract(properties.global.thickness);\n  const cellThick = extract(properties.cell.thickness);\n  const stroke = extract(properties.cell.stroke)\n  const fill = extract(properties.cell.fill);\n\n  const ht = thick / 2;\n  const halfHeight = height / 2;\n  const oR = halfHeight + thick;\n  const iR = halfHeight - thick;\n  const oRx = Math.min(oR, width / 2)\n  return {\n    background: {\n      \"background-image\": `\n      <rect x=\"${ht}\" y=\"${ht}\" width=\"${width - thick}\" height=\"${height - thick}\" rx=\"${halfHeight}\" stroke=\"${fill}\" fill=\"${stroke}\" stroke-width=\"${thick}\"/>\n      <rect x=\"${ht + cellThick}\" y=\"${2 * thick}\" width=\"${width - 2 * cellThick - thick}\" height=\"${height - 4 * thick}\" ry=\"${halfHeight}\" rx=\"${halfHeight - cellThick}\" fill=\"${fill}\" class=\"gradient\" stroke-width=\"0\"/>\n      `,\n      requireGradient: true\n    },\n    hover: {\n      \"background-image\": `\n          <path fill=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 ${oR}\n            a ${oRx} ${oR} 0 0 1 ${oRx} -${oR}\n            h ${width - 2 * oRx}\n            a ${oRx} ${oR} 0 0 1 ${oRx} ${oR}\n            a ${oRx} ${iR} 0 0 0 -${oRx} -${iR}\n            h -${width - 2 * oRx}\n            a ${oRx} ${iR} 0 0 0 -${oRx} ${iR}\n            Z\"/>\n`,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oRx} ${oR} 0 0 0 ${oRx} ${oR}\n            h ${width - 2 * oRx}\n            a ${oRx} ${oR} 0 0 0 ${oRx} -${oR}\n            a ${oRx} ${iR} 0 0 1 -${oRx} ${iR}\n            h -${width - 2 * oRx}\n            a ${oRx} ${iR} 0 0 1 -${oRx} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": halfHeight,\n      \"bounds-expansion\": thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    flag: {\n      \"background-image\": `\n<rect width=\"${width + 4 * thick}\" height=\"${height + 2 * thick}\" rx=\"${oR + 2 * thick}\" ry=\"${oR}\" fill=\"${flag}\"/>\n`,\n      \"background-position-x\": -2 * thick,\n      \"background-position-y\": -thick,\n      \"bounds-expansion\": 2 * thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 4 * thick,\n      \"background-height\": height + 2 * thick,\n    },\n    // analysis: {\n    //   'background-image': `${gradient}<rect x=\"${ht + cellThick}\" y=\"${2 * thick}\" width=\"${width - 2 * cellThick - thick}\" height=\"${height - 4 * thick}\" ry=\"${halfHeight}\" rx=\"${halfHeight - cellThick}\" fill=\"url(#gradient)\" stroke-width=\"0\"/>`\n    // }\n  }\n}\n\n\n","import {DrawerProvider} from \"../types\";\nimport {extract} from \"../../properties-utils\";\n\n\nexport const interactingPathway: DrawerProvider = (properties, {width, height, drug}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const thick = extract(properties.global.thickness);\n\n  let realWidth = width;\n  const t = 3 * thick;\n  return {\n    hover: {\n      \"background-image\": `<rect fill=\"${hover}\" width=\"${width}\" height=\"${t}\"/>`,\n      \"background-width\": width,\n      \"background-height\": t,\n    },\n    select: {\n      \"background-image\": `<rect fill=\"${select}\" width=\"${width}\" height=\"${t}\"/>`,\n      \"background-position-y\": height - t,\n      \"background-width\": width,\n      \"background-height\": t,\n    },\n    flag: {\n      \"background-image\": `\n<rect fill=\"${flag}\" width=\"${t}\" height=\"${height}\"/>\n<rect fill=\"${flag}\" width=\"${t}\" height=\"${height}\" x=\"${realWidth + t}\"/>\n`,\n      \"background-width\": realWidth + 4 * t,\n      \"background-position-x\": -t,\n      \"background-height\": height,\n      \"bounds-expansion\": 2 * t,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n    },\n    analysis: {\n      \"background-image\": `<rect class=\"gradient\" x=\"${t}\" y=\"${t}\" width=\"${width - 2 * t}\" height=\"${height - 2 * t}\"/>`,\n      requireGradient: true\n    }\n  }\n}\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const diseaseInteractor: DrawerProvider = (properties, {width, height, drug, disease, interactor}) => {\n\n  const hover = extract(properties.global.hoverNode);\n  const select = extract(properties.global.selectNode);\n  const fill = extract(properties.global.negative);\n  const t = extract(properties.global.thickness);\n  const decorationWidth = extract(properties.interactor.decorationWidth);\n  const t4 = t * 4\n  const t2 = t * 2;\n  const h = height / 2 + t2;\n  const midH = height / 2;\n\n  return {\n    decorators: [\n      {\n        \"background-image\": `\n      <path fill=\"${fill}\" stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-width=\"${t4}\" stroke=\"${fill}\"  d=\"\n      M ${t2} ${midH}\n      L ${decorationWidth + t2} ${t2}\n      H ${width - (decorationWidth + t2)}\n      L ${width - t2} ${midH}\n      L ${width - (decorationWidth + t2)} ${height - t2}\n      H ${decorationWidth + t2}\n      Z\n      \" />\n      `,\n      }\n    ],\n\n    hover: {\n      \"background-image\": `\n      <path stroke=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-width=\"${t4}\" d=\"\n      M ${t2} ${midH + t2}\n      L ${decorationWidth + t2} ${t2}\n      H ${width - (decorationWidth + t2)}\n      L ${width - t2} ${midH + t2}\n      Z\n      \" />\n      `,\n      \"background-position-y\": -t2,\n      \"background-height\": h,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": t2,\n      \"background-image-containment\": \"over\",\n    },\n\n    select: {\n      \"background-image\": `\n      <path stroke=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-width=\"${t4}\" d=\"\n      M ${t2} 0\n      L ${decorationWidth + t2} ${midH}\n      H ${width - (decorationWidth + t2)}\n      L ${width - t2} 0\n      Z\n      \" />\n      `,\n      \"background-position-y\": midH,\n      \"background-height\": h,\n      \"background-clip\": \"none\",\n      \"bounds-expansion\": t2,\n      \"background-image-containment\": \"over\",\n    }\n\n  }\n}\n\n\n","import {extract} from \"../../properties-utils\";\nimport {DrawerProvider} from \"../types\";\n\nexport const subPathway: DrawerProvider = (properties, {width, height, disease}) => {\n  const select = extract(properties.global.selectNode);\n  const hover = extract(properties.global.hoverNode);\n  const flag = extract(properties.global.flag);\n  const thick = extract(properties.global.thickness) * 3;\n  const stroke = !disease ?\n    extract(properties.pathway.stroke) :\n    extract(properties.global.negativeContrast);\n\n  const halfHeight = height / 2;\n  const oR = halfHeight;\n  const iR = halfHeight - thick;\n  const oRx = Math.min(oR, width / 2)\n  return {\n    hover: {\n      \"background-image\": `\n          <path fill=\"${hover}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 ${oR}\n            a ${oRx} ${oR} 0 0 1 ${oRx} -${oR}\n            h ${width - 2 * oRx}\n            a ${oRx} ${oR} 0 0 1 ${oRx} ${oR}\n            a ${oRx} ${iR} 0 0 0 -${oRx} -${iR}\n            h -${width - 2 * oRx}\n            a ${oRx} ${iR} 0 0 0 -${oRx} ${iR}\n            Z\"/>\n`,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    select: {\n      \"background-image\": `\n          <path fill=\"${select}\" stroke-linejoin=\"round\" stroke-linecap=\"round\"  d=\"\n            M 0 0\n            a ${oRx} ${oR} 0 0 0 ${oRx} ${oR}\n            h ${width - 2 * oRx}\n            a ${oRx} ${oR} 0 0 0 ${oRx} -${oR}\n            a ${oRx} ${iR} 0 0 1 -${oRx} ${iR}\n            h -${width - 2 * oRx}\n            a ${oRx} ${iR} 0 0 1 -${oRx} -${iR}\n            Z\"/>\n`,\n      \"background-position-y\": halfHeight,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-height\": oR,\n    },\n    flag: {\n      \"background-image\": `\n<rect width=\"${width + 2 * thick}\" height=\"${height}\" rx=\"${oR + thick}\" ry=\"${oR}\" fill=\"${flag}\"/>\n`,\n      \"background-position-x\": -thick,\n      \"bounds-expansion\": 2 * thick,\n      \"background-clip\": \"none\",\n      \"background-image-containment\": \"over\",\n      \"background-width\": width + 2 * thick,\n    },\n    analysis: {\n      \"background-image\": `<rect class=\"gradient\" x=\"${thick}\" y=\"${thick}\" width=\"${width - 2 * thick}\" height=\"${height - 2 * thick}\" rx=\"${(height - 2 * thick) / 2}\"/>`,\n      requireGradient: true\n    }\n  }\n}\n\n\n","import cytoscape from \"cytoscape\";\nimport {gene} from \"./shape/gene-shape\";\nimport {isArray, isNumber, memoize} from \"lodash\";\nimport {molecule} from \"./shape/molecule-shape\";\nimport {protein} from \"./shape/protein-shape\";\nimport {rna} from \"./shape/rna-shape\";\nimport {genomeEncodedEntity} from \"./shape/gee-shape\";\nimport {complex} from \"./shape/complex-shape\";\nimport {entitySet} from \"./shape/entity-sets-shape\";\nimport {cell} from \"./shape/cell-shape\";\nimport {interactingPathway} from \"./shape/interacting-pathway-shape\";\nimport {diseaseInteractor} from \"./shape/disease-interactor-shape\";\n\nimport {subPathway} from \"./shape/sub-pathway-shape\";\nimport {extract} from \"../properties-utils\";\nimport {Node} from \"../types\";\nimport {Aggregated, DrawerParameters, DrawerProvider, Image, Memo} from \"./types\";\nimport {Properties} from \"../properties\";\nimport {Style} from \"../style\";\nimport chroma from \"chroma-js\";\n\n\nexport const imageBuilder = (properties: Properties, style: Style) => memoize(\n  (node: cytoscape.NodeSingular): Aggregated<Image> => {\n    // console.time(`build-image-${node.id()}`)\n    let layers: Image[] = [];\n    const clazz = node.classes().find(clazz => classToDrawers.has(clazz as Node)) as Node\n    if (!clazz) return aggregate(layers, defaultBg);\n\n    const provider = classToDrawers.get(clazz)!;\n    const exps = node.data('exp');\n    const drawerParams: DrawerParameters = {\n      id: node.id(),\n      width: node.data(\"width\"),\n      height: node.data(\"height\"),\n      drug: node.hasClass('drug'),\n      disease: node.hasClass('disease'),\n      interactor: node.hasClass('Interactor'),\n      crossed: node.hasClass('crossed'),\n      lossOfFunction: node.hasClass('loss-of-function')\n    };\n\n\n    const drawer = provider(properties, drawerParams);\n\n    if (node.hasClass('flag') && drawer.flag) layers.push(drawer.flag);\n\n    if (drawer.background) layers.push(drawer.background);\n\n    if (exps && drawer.analysis) layers.push(drawer.analysis);\n\n    if (node.selected() && drawer.select) layers.push(drawer.select);\n\n    if (node.hasClass('hover') && drawer.hover) layers.push(drawer.hover);\n\n    if (drawer.decorators) layers.push(...drawer.decorators);\n\n    if (drawerParams.drug) {\n      layers.push(RX(properties, drawerParams, clazz));\n    }\n\n    if (node.classes().includes('Pathway')) {\n      layers.push(Pathway(properties, drawerParams));\n    }\n\n    if (drawerParams.crossed) layers.push(CROSS(properties, drawerParams));\n\n    const gradient = expToGradient(node.id(), exps, properties, style.currentPalette)\n\n    // Convert raw HTML to string encoded images\n    layers = layers\n      .map(l => {\n        if (l.requireGradient && gradient) l[\"background-image\"] = addGradient(l[\"background-image\"] as string, gradient);\n        return l;\n      })\n      .map(l => ({\n          ...l,\n          \"background-image\": svgStr(l[\"background-image\"] as string,\n            isNumber(l[\"background-width\"]) ? l[\"background-width\"] : drawerParams.width,\n            isNumber(l[\"background-height\"]) ? l[\"background-height\"] : drawerParams.height\n          )\n        })\n      );\n\n    const aggregated = aggregate(layers, defaultBg);\n    aggregated['bounds-expansion'] = [Math.max(...aggregated['bounds-expansion'] as number[], 0)]\n\n    // console.timeEnd(`build-image-${node.id()}`)\n    return aggregated;\n  }, node => `${node.id()}-${node.classes().toString()}-s:${node.selected()}`\n)\n\nconst defaultBg: Image = {\n  \"background-image\": \"\",\n  \"background-position-x\": \"0\",\n  \"background-position-y\": \"0\",\n  \"background-offset-x\": \"0\",\n  \"background-offset-y\": \"0\",\n  \"background-width\": \"100%\",\n  \"background-height\": \"100%\",\n  \"background-fit\": \"none\",\n  \"background-clip\": \"none\",\n  \"background-image-opacity\": 1,\n  \"background-image-containment\": \"over\",\n  \"background-image-smoothing\": \"yes\",\n  \"background-height-relative-to\": \"inner\",\n  \"background-width-relative-to\": \"inner\",\n  \"background-repeat\": \"no-repeat\",\n  \"background-image-crossorigin\": \"anonymous\",\n  \"bounds-expansion\": 0\n}\n\nfunction addGradient(svgText: string, gradient: string): string {\n  return `<style>.gradient{fill: url(#gradient)}</style>${gradient}${svgText}`;\n}\n\nfunction _expToGradient(id: string, exps: (number | [number, number] | undefined)[], properties: Properties, palette: chroma.Scale): string | undefined {\n  if (!exps) return;\n  // console.time('exp-to-gradient')\n  const stops: { start: number, stop: number, color: string, exp: number | undefined, width: number }[] = [];\n  const size = exps.reduce((l: number, e) => e !== undefined && isArray(e) ? l + e[1] : l + 1, 0);\n  const delta = 1 / size;\n  const notFoundColor = extract(properties.analysis.notFound);\n  exps.forEach((exp, i) => {\n    const p = stops.length - 1;\n    if (stops.length !== 0 && stops[p].exp === exp) {\n      stops[p].stop += delta;\n      stops[p].width += delta;\n    } else {\n      if (isArray(exp)) {\n        stops.push({\n          start: stops[p]?.stop || 0,\n          stop: (stops[p]?.stop || 0) + delta * exp[1],\n          width: delta * exp[1],\n          color: exp[0] !== undefined ? palette(exp[0]).hex() : notFoundColor,\n          exp: exp[0]\n        })\n        // console.log(stops, exps)\n\n      } else {\n        stops.push({\n          start: stops[p]?.stop || 0,\n          stop: (stops[p]?.stop || 0) + delta,\n          color: exp !== undefined ? palette(exp).hex() : notFoundColor,\n          width: delta,\n          exp: exp\n        })\n      }\n    }\n  })\n\n  const pattern = '<defs><pattern id=\"gradient\" patternUnits=\"objectBoundingBox\" width=\"1\" height=\"1\" viewBox=\"0 0 1 1\" preserveAspectRatio=\"none\">' +\n    stops\n      .map((stop, i) => `<rect fill=\"${stop.color}\" x=\"${stop.start}\" height=\"1\" width=\"${stop.width + 0.01}\"/>`)\n      .join('') +\n    '</pattern></defs>';\n\n  // const gradient = '<defs><linearGradient id=\"gradient\">' +\n  //     stops\n  //         .map(stop => `<stop stop-color=\"${stop.color}\" offset=\"${stop.start}\"/><stop stop-color=\"${stop.color}\" offset=\"${stop.stop}\"/>`)\n  //         .join('') +\n  //     '</linearGradient></defs>'\n  // console.timeEnd('exp-to-gradient')\n\n  // console.log(exps)\n  return pattern\n}\n\nconst expToGradient = memoize(_expToGradient, (id) => id)\n\nexport const resetGradients = () => expToGradient.cache.clear!()\n\nfunction svg(svgStr: string, width = 100, height = 100) {\n  // const cleanedStr = svgStr.replaceAll(/  {2,}|\\n/g, \" \"); // TODO examine performance impact\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE svg><svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='${width}' height='${height}'>${svgStr}</svg>`;\n}\n\nfunction svgStr(svgText: string, viewPortWidth: number, viewPortHeight: number) {\n  return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg(svgText, viewPortWidth, viewPortHeight));\n}\n\n\nconst dim = (properties: Properties, {id}: DrawerParameters) => id;\nconst classToDrawers = new Map<Node, Memo<DrawerProvider>>([\n  [\"Protein\", memoize(protein, dim)],\n  [\"GenomeEncodedEntity\", memoize(genomeEncodedEntity, dim)],\n  [\"RNA\", memoize(rna, dim)],\n  [\"Gene\", memoize(gene, dim)],\n  [\"Molecule\", memoize(molecule, dim)],\n  [\"Complex\", memoize(complex, dim)],\n  [\"EntitySet\", memoize(entitySet, dim)],\n  [\"Cell\", memoize(cell, dim)],\n  [\"Interacting\", memoize(interactingPathway, dim)],\n  [\"SUB\", memoize(subPathway, dim)],\n  [\"Interactor\", memoize(diseaseInteractor, dim)]\n]);\n\nexport function clearDrawersCache() {\n  for (let value of classToDrawers.values()) {\n    value.cache.clear!()\n  }\n  OMMITED_ICON.cache.clear!();\n}\n\nfunction aggregate<T extends Object, K extends keyof T>(toAggregate: T[], defaultValue: T): Aggregated<T> {\n  const aggregate: Aggregated<T> = {} as Aggregated<T>;\n  //@ts-ignore\n  const keys = new Set<K>(Object.keys(defaultValue));\n  keys.forEach(key => aggregate[key] = toAggregate.map(t => t[key] || defaultValue[key]));\n  return aggregate;\n}\n\nconst RX = (properties: Properties, {height}: DrawerParameters, clazz: Node): Image => {\n  const t = extract(properties.global.thickness);\n  const color = clazz !== 'Molecule' ?\n    extract(properties.global.onPrimary) :\n    extract(properties.molecule.drug);\n  const x = (clazz !== 'EntitySet' ? 0 : extract(properties.entitySet.radius)) + 3 * t;\n\n  return {\n    \"background-image\": `\n      <path style=\"transform: scale(2)\" fill=\"${color}\" stroke-width=\"0.4\" stroke=\"${color}\" d=\"M3.2 4C3.3 4 3.4 4 3.6 4L6.75 8.81L5.7 10.15C5.7 10.15 5.53985 10.3884 5.31824 10.6092C5.00434 10.922 4.6582 11.3 4.28711 11.3C4.19141 11.3 4.2 11.3 4.1 11.3V11.5H6.4V11.3C6.2 11.3 6 11.3 5.9 11.2C5.8 11.1 5.8 11 5.8 10.9C5.8 10.6301 5.9 10.5547 6.16055 10.226L7 9.2L7.65291 10.226C7.82889 10.5025 8 10.7344 8 10.9C8 11.0656 7.90095 11.3 7.65291 11.3C7.55291 11.3 7.6 11.3 7.4 11.3V11.5H10.2V11.3C9.9 11.3 9.7 11.2 9.5 11C9.24121 10.7412 9 10.5 8.6 10L7.6 8.5L8.48711 7.35309C8.55228 7.28792 8.61656 7.21558 8.68081 7.13924C9.09787 6.6437 9.64859 6 10.2 6.01309V5.81309H7.8V6.01309C8 6.01309 8.2 6.01309 8.3 6.01309C8.45586 6.01309 8.6 6.20329 8.6 6.31309C8.6 6.62136 8.43963 6.81922 8.2462 7.03337L7.3 8.1L4.5 3.9C5.1 3.8 5.4 3.61 5.7 3.31C6 3.01 6.2 2.6 6.2 2.2C6.2 1.8 6.08711 1.47 5.78711 1.17C5.52798 0.910875 5.3 0.8 5 0.7C4.6 0.6 4.1 0.5 3.4 0.5H1V0.7H1.2C1.82201 0.7 2 1.14292 2 1.7V6C2 6.59634 2 6.9 1.2 6.9H1V7.1H3.8V6.9H3.6C2.9041 6.9 2.9 6.61047 2.9 6V4H3H3.2ZM3 3.7C3 3.7 3 3.7 2.9 3.7L2.88711 1C3.18711 0.9 3.4 0.9 3.6 0.9C4.47782 0.9 5 1.42405 5 2.3C5 3.40743 4.15401 3.7 3.2 3.7H3Z\"/>\n    `,\n    \"background-position-x\": x,\n    \"background-position-y\": (height / 2 - 11) + 'px',\n    \"background-width\": 22,\n    \"background-height\": 24,\n  };\n\n}\n\nconst Pathway = (properties: Properties, {height, disease}: DrawerParameters): Image => {\n  const t = extract(properties.global.thickness);\n  const color = !disease ?\n    extract(properties.global.onPrimary) :\n    extract(properties.global.negativeContrast);\n\n  let x = 5 * t;\n\n  return {\n    \"background-image\": `\n      <path style=\"transform: scale(1.5)\" fill=\"${color}\" stroke-width=\"0.4\" stroke=\"${color}\" d=\"M19.6864 21.0381C19.0364 21.0381 18.4531 20.8508 17.9364 20.4761C17.4197 20.1008 17.0614 19.6214 16.8614 19.0381H11.6864C10.5864 19.0381 9.64473 18.6464 8.8614 17.8631C8.07807 17.0798 7.6864 16.1381 7.6864 15.0381C7.6864 13.9381 8.07807 12.9964 8.8614 12.2131C9.64473 11.4298 10.5864 11.0381 11.6864 11.0381H13.6864C14.2364 11.0381 14.7074 10.8421 15.0994 10.4501C15.4907 10.0588 15.6864 9.58809 15.6864 9.03809C15.6864 8.48809 15.4907 8.01709 15.0994 7.62509C14.7074 7.23375 14.2364 7.03809 13.6864 7.03809H8.5114C8.29473 7.62142 7.9324 8.10075 7.4244 8.47609C6.91573 8.85075 6.3364 9.03809 5.6864 9.03809C4.85307 9.03809 4.14473 8.74642 3.5614 8.16309C2.97807 7.57975 2.6864 6.87142 2.6864 6.03809C2.6864 5.20475 2.97807 4.49642 3.5614 3.91309C4.14473 3.32975 4.85307 3.03809 5.6864 3.03809C6.3364 3.03809 6.91573 3.22542 7.4244 3.60009C7.9324 3.97542 8.29473 4.45475 8.5114 5.03809H13.6864C14.7864 5.03809 15.7281 5.42975 16.5114 6.21309C17.2947 6.99642 17.6864 7.93809 17.6864 9.03809C17.6864 10.1381 17.2947 11.0798 16.5114 11.8631C15.7281 12.6464 14.7864 13.0381 13.6864 13.0381H11.6864C11.1364 13.0381 10.6657 13.2338 10.2744 13.6251C9.8824 14.0171 9.6864 14.4881 9.6864 15.0381C9.6864 15.5881 9.8824 16.0591 10.2744 16.4511C10.6657 16.8424 11.1364 17.0381 11.6864 17.0381H16.8614C17.0781 16.4548 17.4407 15.9754 17.9494 15.6001C18.4574 15.2254 19.0364 15.0381 19.6864 15.0381C20.5197 15.0381 21.2281 15.3298 21.8114 15.9131C22.3947 16.4964 22.6864 17.2048 22.6864 18.0381C22.6864 18.8714 22.3947 19.5798 21.8114 20.1631C21.2281 20.7464 20.5197 21.0381 19.6864 21.0381ZM5.6864 7.03809C5.96973 7.03809 6.2074 6.94242 6.3994 6.75109C6.59073 6.55909 6.6864 6.32142 6.6864 6.03809C6.6864 5.75475 6.59073 5.51709 6.3994 5.32509C6.2074 5.13375 5.96973 5.03809 5.6864 5.03809C5.40307 5.03809 5.1654 5.13375 4.9734 5.32509C4.78207 5.51709 4.6864 5.75475 4.6864 6.03809C4.6864 6.32142 4.78207 6.55909 4.9734 6.75109C5.1654 6.94242 5.40307 7.03809 5.6864 7.03809Z\" />\n    `,\n    \"background-position-x\": x,\n    \"background-position-y\": (height / 2 - 18) + 'px',\n    \"background-width\": 36,\n    \"background-height\": 36,\n  };\n\n}\n\nexport const CROSS = memoize((properties: Properties, {width, height}: DrawerParameters): Image => {\n  const s = extract(properties.global.negative);\n  const t = extract(properties.global.thickness);\n  return {\n    \"background-image\": `<line x1=\"${t}\" y1=\"${t}\" x2=\"${width - t}\" y2=\"${height - t}\" stroke-width=\"${2 * t}\" stroke-linecap=\"round\" stroke=\"${s}\"/><line x1=\"${t}\" y1=\"${height - t}\" x2=\"${width - t}\" y2=\"${t}\" stroke-width=\"${2 * t}\" stroke-linecap=\"round\" stroke=\"${s}\"/>`,\n    \"background-image-opacity\": 1\n  };\n}, (p, {width, height}) => `${width}x${height}`)\n\nexport const OMMITED_ICON = memoize((properties: Properties) => {\n  const s = extract(properties.global.onSurface);\n  return svgStr(`<line x1=\"2.5\" y1=\"3\" x2=\"4.5\" y2=\"7\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke=\"${s}\"/><line x1=\"5.5\" y1=\"3\" x2=\"7.5\" y2=\"7\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke=\"${s}\"/>`, 10, 10)\n}, (p) => '')\n\n","import {defaultable, extract, PropertiesType, Property} from \"./properties-utils\";\n\nexport interface Properties extends PropertiesType {\n  global: {\n    thickness: Property<number>\n    surface: Property<string>\n    onSurface: Property<string>\n    primary: Property<string>\n    onPrimary: Property<string>\n    positive: Property<string>\n    negative: Property<string>\n    negativeContrast: Property<string>\n    selectNode: Property<string>\n    selectEdge: Property<string>\n    hoverNode: Property<string>\n    hoverEdge: Property<string>\n    flag: Property<string>\n  },\n  compartment: {\n    fill: Property<string>\n    opacity: Property<number>\n  }\n  shadow: {\n    luminosity: Property<number>\n    opacity: Property<[number, number][]>\n    labelOpacity: Property<[number, number][]>\n    padding: Property<number>\n    fontSize: Property<number>\n    fontPadding: Property<number>\n  }\n  protein: {\n    fill: Property<string>\n    drug: Property<string>\n    radius: Property<number>\n  }\n  genomeEncodedEntity: {\n    fill: Property<string>\n    drug: Property<string>\n    bottomRadius: Property<number>\n    topRadius: Property<number>\n  }\n  rna: {\n    fill: Property<string>\n    drug: Property<string>\n    radius: Property<number>\n  }\n  gene: {\n    fill: Property<string>\n    decorationHeight: Property<number>\n    decorationExtraWidth: Property<number>\n    arrowHeadSize: Property<number>\n    borderRadius: Property<number>\n    arrowRadius: Property<number>\n  }\n  molecule: {\n    fill: Property<string>\n    stroke: Property<string>\n    drug: Property<string>\n  }\n  entitySet: {\n    fill: Property<string>\n    stroke: Property<string>\n    drug: Property<string>\n    radius: Property<number>\n  }\n  complex: {\n    fill: Property<string>\n    stroke: Property<string>\n    drug: Property<string>\n    cut: Property<number>\n  }\n  cell: {\n    thickness: Property<number>\n    fill: Property<string>\n    stroke: Property<string>\n  }\n  //interacting pathway and sub pathway\n  pathway: {\n    fill: Property<string>\n    stroke: Property<string>\n  }\n  modification: {\n    fill: Property<string>\n  }\n  interactor: {\n    fill: Property<string>\n    stroke: Property<string>\n    decorationWidth: Property<number>\n  }\n  trivial: {\n    opacity: Property<[number, number][]>\n  }\n  structure: {\n    opacity: Property<[number, number][]>\n  }\n  font: {\n    size: Property<number>\n  }\n  analysis :{\n    min: Property<number>\n    max: Property<number>\n    unidirectionalPalette: Property<[number, string][] | string>\n    bidirectionalPalette: Property<[number, string][] | string>\n    notFound: Property<string>\n  }\n  features : {\n    edit: Property<boolean>\n    compare: Property<boolean>\n    interactors: Property<boolean>\n    analysis: Property<boolean>\n  }\n}\n\nexport function setDefaults(properties: UserProperties = {}, css: CSSStyleDeclaration): Properties {\n  const global: Properties['global'] = defaultable(properties.global || {})\n    .setDefault('thickness', 4)\n    .setDefault('surface', () => css.getPropertyValue('--surface') || '#F6FEFF')\n    .setDefault('onSurface', () => css.getPropertyValue('--on-surface') || '#001F24')\n    .setDefault('primary', () => css.getPropertyValue('--primary') || '#006782')\n    .setDefault('onPrimary', () => css.getPropertyValue('--on-primary') || '#FFFFFF')\n    .setDefault('positive', () => css.getPropertyValue('--positive') || '#0C9509')\n    .setDefault('negative', () => css.getPropertyValue('--negative') || '#BA1A1A')\n    .setDefault('negativeContrast', () => css.getPropertyValue('--negative-contrast') || '#ea7d7d')\n    .setDefault('selectNode', () => css.getPropertyValue('--select-node') || '#6EB3E4')\n    .setDefault('selectEdge', () => css.getPropertyValue('--select-edge') || '#0561A6')\n    .setDefault('hoverNode', () => css.getPropertyValue('--hover-node') || '#78E076')\n    .setDefault('hoverEdge', () => css.getPropertyValue('--hover-edge') || '#04B601')\n    .setDefault('flag', () => css.getPropertyValue('--flag') || '#DE75B4')\n\n  const compartment: Properties['compartment'] = defaultable(properties.compartment || {})\n    .setDefault('opacity', () => Number.parseFloat(css.getPropertyValue('--opacity')) || 0.06)\n    .setDefault('fill', () => css.getPropertyValue('--compartment') || '#E5834A')\n\n  const shadow: Properties['shadow'] = defaultable(properties.shadow || {})\n    .setDefault('luminosity', () => Number.parseFloat(css.getPropertyValue('--shadow-luminosity')) || 40)\n    .setDefault('padding', () => Number.parseFloat(css.getPropertyValue('--shadow-padding')) || 20)\n    .setDefault('fontSize', () => Number.parseFloat(css.getPropertyValue('--shadow-font-size')) || 80)\n    .setDefault('fontPadding', () => Number.parseFloat(css.getPropertyValue('--shadow-font-padding')) || 15)\n    .setDefault('opacity', () => {\n      const p = css.getPropertyValue('--shadow-opacity');\n      return p ? JSON.parse(p) : [[20, 20], [40, 0]];\n    })\n    .setDefault('labelOpacity', () => {\n      const p = css.getPropertyValue('--shadow-label-opacity');\n      return p ? JSON.parse(p) : [[20, 100], [40, 0]];\n    })\n\n  const protein: Properties['protein'] = defaultable(properties.protein || {})\n    .setDefault('fill', () => css.getPropertyValue('--primary-contrast-1') || '#001F29')\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-1') || '#3E001D')\n    .setDefault('radius', 8)\n\n\n  const genomeEncodedEntity: Properties['genomeEncodedEntity'] = defaultable(properties.genomeEncodedEntity || {})\n    .setDefault('fill', () => css.getPropertyValue('--primary-contrast-4') || '#006782')\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-4') || '#BB557A')\n    .setDefault('bottomRadius', 6)\n    .setDefault('topRadius', 40)\n\n  const rna: Properties['rna'] = defaultable(properties.rna || {})\n    .setDefault('fill', () => css.getPropertyValue('--primary-contrast-2') || '#003545')\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-2') || '#610B33')\n    .setDefault('radius', 8)\n\n  const gene: Properties['gene'] = defaultable(properties.gene || {})\n    .setDefault('decorationHeight', 20)\n    .setDefault('decorationExtraWidth', 17)\n    .setDefault(\"arrowHeadSize\", 10)\n    .setDefault(\"borderRadius\", 8)\n    .setDefault(\"arrowRadius\", 8)\n    .setDefault(\"fill\", () => css.getPropertyValue('--primary-contrast-3') || '#004D62')\n\n  const molecule: Properties['molecule'] = defaultable(properties.molecule || {})\n    .setDefault(\"fill\", () => extract(global.surface))\n    .setDefault(\"stroke\", () => extract(global.onSurface))\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-3') || '#9C3D61')\n\n  const complex: Properties['complex'] = defaultable(properties.complex || {})\n    .setDefault(\"cut\", 8)\n    .setDefault(\"fill\", () => css.getPropertyValue('--tertiary-contrast-1') || '#00315C')\n    .setDefault(\"stroke\", () => css.getPropertyValue('--on-tertiary') || '#FFFFFF')\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-3') || '#7E2549')\n\n  const entitySet: Properties['entitySet'] = defaultable(properties.entitySet || {})\n    .setDefault(\"radius\", 8)\n    .setDefault(\"fill\", () => css.getPropertyValue('--tertiary-contrast-3') || '#1660A5')\n    .setDefault(\"stroke\", () => css.getPropertyValue('--on-tertiary') || '#FFFFFF')\n    .setDefault('drug', () => css.getPropertyValue('--drug-contrast-4') || '#BB557A')\n\n  const cell: Properties['cell'] = defaultable(properties.cell || {})\n    .setDefault('thickness', () => Number.parseFloat(css.getPropertyValue('--cell-thickness')) || 16)\n    .setDefault(\"fill\", () => css.getPropertyValue('--tertiary-contrast-2') || '#004882')\n    .setDefault(\"stroke\", () => css.getPropertyValue('--on-tertiary') || '#FFFFFF')\n\n  const pathway: Properties['pathway'] = defaultable(properties.pathway || {})\n    .setDefault(\"fill\", () => css.getPropertyValue('--primary-contrast-4') || '#006782')\n    .setDefault(\"stroke\", () => extract(global.onPrimary))\n\n  const modification: Properties['modification'] = defaultable(properties.modification || {})\n    .setDefault(\"fill\", () => css.getPropertyValue('--primary-contrast-2') || '#003545')\n\n  const interactor: Properties['interactor'] = defaultable(properties.interactor || {})\n    .setDefault(\"fill\", () => css.getPropertyValue('--interactor-fill') || '#68297C')\n    .setDefault(\"stroke\", () => css.getPropertyValue('--interactor-stroke') || '#9f5cb5')\n    .setDefault('decorationWidth', () => Number.parseFloat(css.getPropertyValue('--decorationWidth')) || 20)\n\n  const trivial: Properties['trivial'] = defaultable(properties.trivial || {})\n    .setDefault('opacity', () => {\n      const p = css.getPropertyValue('--trivial-opacity');\n      return p ? JSON.parse(p) : [[40, 0], [60, 100]];\n    })\n\n  const structure: Properties['structure'] = defaultable(properties.structure || {})\n    .setDefault('opacity', () => {\n      const p = css.getPropertyValue('--structure-opacity');\n      return p ? JSON.parse(p) : [[130, 0], [150, 100]];\n    })\n\n  const font: Properties['font'] = defaultable(properties.font || {})\n    .setDefault('size', 12)\n\n  const analysis: Properties['analysis'] = defaultable(properties.analysis || {})\n    .setDefault(\"min\",Number.parseFloat(css.getPropertyValue('--analysis-min')) || 0)\n    .setDefault(\"max\",Number.parseFloat(css.getPropertyValue('--analysis-max')) || 1)\n    .setDefault(\"notFound\", css.getPropertyValue('--analysis-not-found') || extract(global.onSurface))\n    .setDefault(\"unidirectionalPalette\", () => {\n      const p = css.getPropertyValue('--analysis-uni-palette');\n      console.error(p, typeof p)\n      return p ? JSON.parse(p) : [\n        [0.000, '#FFFFE0'],\n        [1.000, '#00429D'],\n      ];\n    })\n    .setDefault(\"bidirectionalPalette\", () => {\n      const p = css.getPropertyValue('--analysis-bi-palette');\n      console.error(p, typeof p)\n\n      return p ? JSON.parse(p) : [\n        [0.000, '#93003A'],\n        [0.500, '#FFFFE0'],\n        [1.000, '#00429D'],\n      ];\n    })\n\n  const features: Properties['features'] = defaultable(properties.features || {})\n    .setDefault(\"edit\", false)\n    .setDefault(\"compare\", true)\n    .setDefault(\"analysis\", true)\n    .setDefault(\"interactors\", true);\n\n  return {\n    global,\n    compartment,\n    shadow,\n    protein,\n    genomeEncodedEntity,\n    rna,\n    gene,\n    molecule,\n    complex,\n    entitySet,\n    cell,\n    pathway,\n    modification,\n    interactor,\n    trivial,\n    structure,\n    font,\n    analysis,\n    features\n  }\n}\n\nexport type UserProperties = Partial<{\n  [k in keyof Properties]: Partial<Properties[k]>\n}>\n\n","import cytoscape from \"cytoscape\";\nimport {extract} from \"./properties-utils\";\nimport {Properties} from \"./properties\";\nimport {ReactomeEvent, ReactomeEventTypes} from \"./model/reactome-event.model\";\nimport Layers, {IHTMLLayer, layers, LayersPlugin} from 'cytoscape-layers';\nimport * as _ from \"lodash\";\n\n\ncytoscape.use(Layers)\ntype RenderableHTMLElement = HTMLElement & { render: _.DebouncedFunc<() => void> };\n\nexport class Interactivity {\n  constructor(private cy: cytoscape.Core, private properties: Properties) {\n    // @ts-ignore\n    cy.elements().ungrabify().panify();\n    this.initHover(cy);\n    this.initSelect(cy);\n    this.initClick(cy);\n    this.initStructureVideo(cy);\n    this.initStructureMolecule(cy);\n    this.initZoom(cy);\n  }\n\n  expandReaction(reactionNode: cytoscape.NodeCollection) {\n    return reactionNode.connectedEdges().add(reactionNode);\n  }\n\n  applyToReaction = (action: (col: cytoscape.Collection) => void, stateKey: keyof State) => (reactionNode: cytoscape.NodeCollection) => {\n    if (state[stateKey]) return;\n    state[stateKey] = true;\n    action(this.expandReaction(reactionNode));\n    state[stateKey] = false;\n  };\n\n  initHover(cy: cytoscape.Core, mapper = <X>(x: X) => x) {\n    const hoverReaction = this.applyToReaction(col => col.addClass('hover'), 'hovering')\n    const deHoverReaction = this.applyToReaction(col => col.removeClass('hover'), 'deHovering')\n\n\n    const container = cy.container()!;\n    cy\n      .on('mouseover', 'node.PhysicalEntity', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.hover, {\n        element: e.target,\n        type: \"PhysicalEntity\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseover', 'node.Pathway', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.hover, {\n        element: e.target,\n        type: \"Pathway\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseover', 'node.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.hover, {\n        element: e.target,\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseover', 'edge.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.hover, {\n        element: e.target.connectedNodes('.reaction'),\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n\n      .on('mouseout', 'node.PhysicalEntity', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.leave, {\n        element: e.target,\n        type: \"PhysicalEntity\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseout', 'node.Pathway', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.leave, {\n        element: e.target,\n        type: \"Pathway\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseout', 'node.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.leave, {\n        element: e.target,\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('mouseout', 'edge.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.leave, {\n        element: e.target.connectedNodes('.reaction'),\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n\n      .on('mouseover', 'node', e => mapper(e.target).addClass('hover'))\n      .on('mouseout', 'node', e => mapper(e.target).removeClass('hover'))\n\n      .on('mouseover', 'node.reaction', e => hoverReaction(mapper(e.target)))\n      .on('mouseout', 'node.reaction', e => deHoverReaction(mapper(e.target)))\n\n      .on('mouseover', 'edge', e => {\n        const mapped = mapper(e.target);\n        if (mapped !== e.target) console.log(mapped, mapped.connectedNodes('.reaction'))\n\n        hoverReaction(mapped.connectedNodes('.reaction'))\n      })\n      .on('mouseout', 'edge', e => deHoverReaction(mapper(e.target).connectedNodes('.reaction')))\n\n      .on('mouseover', 'node.Modification', e => mapper(cy.nodes(`#${e.target.data('nodeId')}`)).addClass('hover'))\n      .on('mouseout', 'node.Modification', e => mapper(cy.nodes(`#${e.target.data('nodeId')}`)).removeClass('hover'))\n\n      .on('mouseover', 'edge.Interactor', e => mapper(cy.edges(`#${e.target.data('id')}`)).addClass('hover'))\n      .on('mouseout', 'edge.Interactor', e => mapper(cy.edges(`#${e.target.data('id')}`)).removeClass('hover'))\n  }\n\n  initSelect(cy: cytoscape.Core, mapper = <X>(x: X) => x) {\n    const selectReaction = this.applyToReaction(col => col.select(), 'selecting')\n    const container = cy.container()!;\n\n    cy\n      .on('select', 'node.PhysicalEntity', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.select, {\n        element: e.target,\n        type: \"PhysicalEntity\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('select', 'node.Pathway', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.select, {\n        element: e.target,\n        type: \"Pathway\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('select', 'node.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.select, {\n        element: e.target,\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('select', 'edge.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.select, {\n        element: e.target.connectedNodes('.reaction'),\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n\n      .on('unselect', 'node.PhysicalEntity', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.unselect, {\n        element: e.target,\n        type: \"PhysicalEntity\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('unselect', 'node.Pathway', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.unselect, {\n        element: e.target,\n        type: \"Pathway\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('unselect', 'node.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.unselect, {\n        element: e.target,\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n      .on('unselect', 'edge.reaction', e => container.dispatchEvent(new ReactomeEvent(ReactomeEventTypes.unselect, {\n        element: e.target.connectedNodes('.reaction'),\n        type: \"reaction\",\n        reactomeId: e.target.data('reactomeId'),\n        cy\n      })))\n\n      .on('select', 'edge', e => selectReaction(mapper(e.target).connectedNodes('.reaction')))\n      .on('unselect', 'edge', () => selectReaction(\n        mapper(cy.edges(':selected').connectedNodes('.reaction')\n          .add(cy.nodes('.reaction:selected')))\n      )) // Avoid single element selection when double-clicking\n\n      .on('select', 'node.reaction', event => selectReaction(mapper(event.target)))\n      .on('select', 'node.Modification', e => mapper(cy.nodes(`#${e.target.data('nodeId')}`)).select())\n\n  }\n\n  initClick(cy: cytoscape.Core) {\n    const container = cy.container()!;\n\n    cy\n      .on('click', 'node.InteractorOccurrences', e => {\n        const openClass = 'opened';\n        let eventType = !e.target.hasClass(openClass) ? ReactomeEventTypes.open : ReactomeEventTypes.close;\n        e.target.toggleClass(openClass);\n        container.dispatchEvent(new ReactomeEvent(eventType, {\n          element: e.target,\n          type: \"Interactor\",\n          reactomeId: e.target.data('reactomeId'),\n          cy\n        }))\n      })\n\n      .on('click', '.Interactor', e => {\n        const prop = e.target.isNode() ? 'accURL' : 'evidenceURLs';\n        const url = e.target.data(prop);\n        if (url) window.open(url);\n      })\n      .on('click', '.DiseaseInteractor', e => {\n        const prop = e.target.isNode() ? 'accURL' : 'evidenceURLs';\n        const url = e.target.data(prop);\n        if (url) window.open(url);\n      })\n\n    // .on('click', e => {\n    //   const openClass = 'opened';\n    //   let eventType = !e.target.hasClass(openClass) ? ReactomeEventTypes.open : ReactomeEventTypes.close;\n    //   e.target.toggleClass(openClass);\n    //   container.dispatchEvent(new ReactomeEvent(eventType, {\n    //     element: e.target,\n    //     type: \"Any\",\n    //     reactomeId: e.target.data('reactomeId'),\n    //     cy\n    //   }))\n    // });\n  }\n\n  private videoLayer?: IHTMLLayer;\n\n\n  initStructureVideo(cy: cytoscape.Core) {\n    const layersPlugin: LayersPlugin = layers(cy);\n    this.videoLayer = layersPlugin.append('html');\n    if (this.videoLayer) this.videoLayer.node.style.opacity = '0';\n    layersPlugin.renderPerNode(\n      this.videoLayer!,\n      (elem: HTMLElement) => {\n        (elem as RenderableHTMLElement).render()\n      },\n      {\n        init: (elem: RenderableHTMLElement, node: cytoscape.NodeSingular) => {\n          const name = node.data('displayName');\n\n          elem.innerHTML = node.data('html') || '';\n          elem.style.display = \"flex\";\n          const video = elem.children[0] as HTMLVideoElement;\n\n          elem.render = _.throttle(() => {\n              if (isElementInViewport(elem)) {\n                // console.log('rendering', name)\n                if (this.videoLayer?.node.style.opacity !== '0' && video.readyState === video.HAVE_NOTHING && video.networkState === video.NETWORK_IDLE) {\n                  console.log('loading', name)\n                  video.load();\n                }\n                elem.style.visibility = node.visible() ? 'visible' : 'hidden';\n              }\n\n            }, 500\n          );\n        },\n        transform: `translate(-70%, -50%)`,\n        position: 'center',\n        uniqueElements: false,\n        checkBounds: false, // Need false otherwise destroy nodes when out of view\n        selector: '.Protein',\n        updateOn: \"render\", // Need render to call display whenever we move\n        queryEachTime: false,\n      }\n    );\n\n    this.videoLayer?.node.classList.add('video')\n    this.cy\n      ?.on('mouseover', 'node.Protein', async (event) => {\n        const videoId = event.target.id();\n        const videoElement = this.videoLayer?.node.querySelector(`#video-${videoId}`) as HTMLVideoElement;\n        if (videoElement && videoElement.readyState >= videoElement.HAVE_ENOUGH_DATA) {\n          await videoElement.play();\n        }\n      })\n      .on('mouseout', 'node.Protein', (event) => {\n        const videoId = event.target.id();\n        const videoElement = this.videoLayer?.node.querySelector(`#video-${videoId}`) as HTMLVideoElement;\n        if (videoElement && videoElement.readyState >= videoElement.HAVE_ENOUGH_DATA) {\n          videoElement.pause();\n        }\n      });\n  }\n\n  private moleculeLayer?: IHTMLLayer;\n\n  initStructureMolecule(cy: cytoscape.Core) {\n    // @ts-ignore\n    const layers: LayersPlugin = cy.layers();\n\n    this.moleculeLayer = layers.append('html');\n    this.moleculeLayer.node.classList.add('molecule')\n\n    layers.renderPerNode(\n      this.moleculeLayer,\n      (elem: HTMLElement, node: cytoscape.NodeSingular) => {\n        elem.style.visibility = node.visible() ? 'visible' : 'hidden';\n      },\n      {\n        init: (elem: HTMLElement, node: cytoscape.NodeSingular) => {\n          elem.innerHTML = node.data('html') || '';\n          elem.style.display = \"flex\"\n        },\n        transform: `translate(-100%, -50%)`,\n        position: 'center',\n        uniqueElements: true,\n        checkBounds: false,\n        selector: '.Molecule',\n        queryEachTime: false,\n      }\n    );\n  }\n\n  onZoom: {\n    [name: string]: (e?: cytoscape.EventObjectCore) => void\n    shadow: (e?: cytoscape.EventObjectCore) => void;\n    protein: (e?: cytoscape.EventObjectCore) => void;\n  } = {\n    shadow: () => undefined,\n    protein: () => undefined,\n  };\n\n  triggerZoom() {\n    Object.values(this.onZoom).forEach(onZoom => onZoom())\n  }\n\n  proteins!: cytoscape.NodeCollection;\n\n  updateProteins() {\n    this.proteins = this.cy.nodes('.Protein')\n      .or('.Molecule');\n  }\n\n  initZoom(cy: cytoscape.Core) {\n    const shadows = cy.edges('[?pathway]');\n    const shadowLabels = cy.nodes('.Shadow');\n    const trivial = cy.elements('.trivial');\n    this.updateProteins();\n\n    cy.minZoom(Math.min(cy.zoom(), extract(this.properties.shadow.labelOpacity)[0][0] / 100));\n    cy.maxZoom(15);\n\n    let baseFontSize = extract(this.properties.font.size);\n    const structureOpacityArray = extract(this.properties.structure.opacity)\n    const zoomStart = structureOpacityArray[0][0];\n    const zoomEnd = structureOpacityArray[structureOpacityArray.length - 1][0]\n\n\n    this.onZoom.shadow = () => {\n      const zoomLevel = cy.zoom();\n      const z = zoomLevel * 100;\n      const shadowLabelOpacity = this.interpolate(z, extract(this.properties.shadow.labelOpacity).map(v => this.p(...v))) / 100;\n      const trivialOpacity = this.interpolate(z, extract(this.properties.trivial.opacity).map(v => this.p(...v))) / 100;\n      const shadowOpacity = this.interpolate(z, extract(this.properties.shadow.opacity).map(v => this.p(...v))) / 100;\n      shadows.style({\n        'underlay-opacity': shadowOpacity\n      });\n      shadowLabels.style({\n        'text-opacity': shadowLabelOpacity\n      });\n      trivial.style({\n        'opacity': trivialOpacity,\n        'underlay-opacity': Math.min(shadowOpacity, trivialOpacity)\n      });\n    }\n\n    this.onZoom.protein = () => {\n      const zoomLevel = cy.zoom();\n      const z = zoomLevel * 100;\n      const videoOpacity = this.interpolate(z, extract(this.properties.structure.opacity).map(v => this.p(...v))) / 100;\n\n      const maxWidth = this.interpolate(z, [this.p(zoomStart, 100), this.p(zoomEnd, 50)]);\n      this.margin = this.interpolate(z, [this.p(zoomStart, 0), this.p(zoomEnd, 0.25)]);\n      const fontSize = this.interpolate(z, [this.p(zoomStart, baseFontSize), this.p(zoomEnd, baseFontSize / 2)]);\n      this.proteins.style(\n        {\n          'font-size': fontSize,\n          'text-margin-x': (n: cytoscape.NodeSingular) => this.margin * n.data(\"width\"),\n          'text-max-width': maxWidth + \"%\",\n        })\n\n      if (this.videoLayer) this.videoLayer.node.style.opacity = videoOpacity + '';\n      if (this.moleculeLayer) this.moleculeLayer.node.style.opacity = videoOpacity + '';\n    };\n\n    cy.on('zoom', this.onZoom.shadow);\n    cy.on('zoom', this.onZoom.protein);\n\n    this.triggerZoom()\n  }\n\n  margin = 0;\n\n  p(x: number, y: number): P {\n    return new P(x, y)\n  }\n\n  interpolate(x: number, points: P[]): number {\n    if (x < points.at(0)!.x) return points.at(0)!.y;\n    if (x > points.at(-1)!.x) return points.at(-1)!.y;\n    for (let i = 0; i + 1 < points.length; i++) {\n      let y = this.lerp(x, points[i], points[i + 1])\n      if (y) return y;\n    }\n    console.assert(false, \"Should not arrive here\")\n    return 0;\n  }\n\n  /**\n   * Linear interpolation as described in https://en.wikipedia.org/wiki/Linear_interpolation\n   * @param x : number number to determine corresponding value\n   * @param p0 : P lower bound point for the linear interpolation\n   * @param p1 : P upper bound point for the linear interpolation\n   */\n  lerp(x: number, p0: P, p1: P): number | undefined {\n    if (x < p0.x || x > p1.x) return undefined;\n    return (p0.y * (p1.x - x) + p1.y * (x - p0.x)) / (p1.x - p0.x);\n  }\n}\n\ninterface State {\n  [k: string]: boolean\n}\n\nconst state: State = {\n  selecting: false,\n  hovering: false,\n  deHovering: false\n}\n\nclass P extends Array<number> {\n  constructor(x: number, y: number) {\n    super(x, y);\n  }\n\n  get x() {\n    return this[0]\n  }\n\n  get y() {\n    return this[1]\n  }\n}\n\n\nfunction isElementInViewport(el: HTMLElement) {\n  let rect = el.getBoundingClientRect();\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n    rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\n\n","import cytoscape from \"cytoscape\";\nimport {clearDrawersCache, imageBuilder, OMMITED_ICON, resetGradients} from \"./drawer/image-builder\";\nimport {extract, propertyExtractor, propertyMapper} from \"./properties-utils\";\n\nimport {Properties, setDefaults, UserProperties} from \"./properties\";\nimport {Interactivity} from \"./interactivity\";\nimport chroma, {Scale, scale} from \"chroma-js\";\n\n\nexport class Style {\n  public css: CSSStyleDeclaration;\n  public properties: Properties;\n  public currentPalette!: Scale;\n  public cy?: cytoscape.Core;\n  private readonly imageBuilder;\n  private readonly p;\n  private readonly pm;\n  public interactivity!: Interactivity;\n\n  constructor(container: HTMLElement, properties: UserProperties = {}) {\n    this.css = getComputedStyle(container);\n    this.properties = setDefaults(properties, this.css);\n    this.imageBuilder = imageBuilder(this.properties, this);\n    this.p = propertyExtractor(this.properties);\n    this.pm = propertyMapper(this.properties);\n  }\n\n  bindToCytoscape(cy: cytoscape.Core) {\n    this.cy = cy;\n    cy.data('reactome', this);\n    this.interactivity = new Interactivity(cy, this.properties);\n    this.initSubPathwayColors()\n  }\n\n  initSubPathwayColors() {\n    const subPathways = this.cy?.nodes('.Shadow');\n    if (!subPathways) return;\n    const dH = 360 / subPathways.length;\n\n    subPathways.forEach((subPathway, i) => {\n      const edges = this.cy!.edges(`[pathway=${subPathway.data('reactomeId')}]`);\n      subPathway.data('edges', edges);\n\n      const color = chroma.hsl(dH * i, 1,extract(this.properties.shadow.luminosity) / 100);\n      console.log(`hsl(${dH * i} 100 ${extract(this.properties.shadow.luminosity)})`, color, color.hex())\n      const hex = color.hex();\n      subPathway.data('color', hex);\n      edges.forEach(edge => {\n        edge.data('color', hex)\n      });\n    })\n  }\n\n\n  getStyleSheet(): cytoscape.Stylesheet[] {\n    return [\n      {\n        selector: \"*\",\n        style: {\n          \"font-family\": \"Roboto\",\n          \"font-weight\": 600,\n          \"z-index\": 1\n        }\n      },\n      {\n        selector: 'node.Compartment',\n        style: {\n          \"shape\": \"round-rectangle\",\n          \"width\": 'data(width)',\n          \"height\": 'data(height)',\n\n          \"border-style\": 'double',\n\n          \"z-index\": 0,\n          \"z-compound-depth\": \"bottom\",\n          \"overlay-opacity\": 0,\n\n          \"color\": this.p('compartment', 'fill'),\n          \"border-color\": this.p('compartment', 'fill'),\n          \"background-color\": this.p('compartment', 'fill'),\n          \"background-opacity\": this.p('compartment', 'opacity'),\n          \"border-width\": this.pm('global', 'thickness', t => 3 * t)\n        }\n      },\n      {\n        selector: 'node.Compartment.inner, node.Compartment.outer',\n        style: {\n          \"border-style\": 'solid',\n          \"border-width\": this.p('global', 'thickness')\n        }\n      },\n      {\n        selector: 'node.Compartment.outer',\n        style: {\n          'label': 'data(displayName)',\n          \"text-opacity\": 1,\n          \"text-valign\": \"bottom\",\n          \"text-halign\": \"right\",\n          // @ts-ignore\n          \"text-margin-x\": \"data(textX)\",\n          // @ts-ignore\n          \"text-margin-y\": \"data(textY)\",\n        }\n      },\n      {\n        selector: 'node[?radius]',\n        style: {\n          // @ts-ignore\n          'corner-radius': 'data(radius)'\n        }\n      },\n      {\n        selector: 'node.Shadow',\n        style: {\n          'label': 'data(displayName)',\n          \"font-size\": this.p('shadow', 'fontSize'),\n          \"background-opacity\": 0,\n          \"shape\": \"rectangle\",\n          \"text-valign\": \"center\",\n          \"text-halign\": \"center\",\n          \"text-outline-color\": this.p('global', 'surface'),\n          \"text-outline-width\": this.p('shadow', 'fontPadding'),\n          \"text-wrap\": 'wrap',\n          \"text-max-width\": \"data(width)\",\n        }\n      },\n      {\n        selector: 'node.Shadow[?color]',\n        style: {\n          \"color\": 'data(color)',\n        }\n      },\n      {\n        selector: 'node.drug',\n        style: {\n          \"text-max-width\": (node: cytoscape.NodeSingular) => (node.width() - 44) + 'px',\n          \"text-margin-x\": 4,\n          \"font-style\": \"italic\"\n        }\n      }, {\n        selector: 'node.PhysicalEntity, node.Pathway, node.Modification, node.Interactor',\n        style: {\n          'font-size': this.p('font', 'size'),\n          'text-margin-x': 0,\n          'label': 'data(displayName)',\n          'width': 'data(width)',\n          'height': 'data(height)',\n          \"background-fit\": \"none\",\n          \"text-halign\": 'center',\n          \"text-valign\": 'center',\n          \"text-wrap\": 'wrap',\n          \"text-max-width\": (node: cytoscape.NodeSingular) => node.data('width') + 'px',\n          // @ts-ignore\n          \"background-image-smoothing\": \"no no no no no no no no\",\n\n          // @ts-ignore\n          \"background-image\": node => this.imageBuilder(node)[\"background-image\"],\n          // @ts-ignore\n          \"background-position-y\": node => this.imageBuilder(node)[\"background-position-y\"] || 0,\n          // @ts-ignore\n          \"background-position-x\": node => this.imageBuilder(node)[\"background-position-x\"] || 0,\n          // @ts-ignore\n          \"background-height\": node => this.imageBuilder(node)[\"background-height\"] || '100%',\n          // @ts-ignore\n          \"background-width\": node => this.imageBuilder(node)[\"background-width\"] || '100%',\n          // @ts-ignore\n          \"background-clip\": node => this.imageBuilder(node)[\"background-clip\"] || 'node',\n          // @ts-ignore\n          \"background-image-containment\": node => this.imageBuilder(node)[\"background-image-containment\"] || 'inside',\n          // @ts-ignore\n          \"background-image-opacity\": node => this.imageBuilder(node)[\"background-image-opacity\"] || 1,\n          // @ts-ignore\n          \"bounds-expansion\": node => this.imageBuilder(node)[\"bounds-expansion\"][0] || 0,\n          'color': this.p('global', 'onPrimary'),\n        }\n      },\n\n      {\n        selector: 'node.InteractorOccurrences',\n        style: {\n          'label': 'data(displayName)',\n          'color': this.p('global', 'surface'),\n          \"shape\": \"ellipse\",\n          \"text-valign\": \"center\",\n          \"text-halign\": \"center\",\n          \"text-wrap\": 'wrap',\n          \"background-color\": this.p('interactor', 'fill')\n        }\n      },\n      {\n        selector: 'node.InteractorOccurrences.disease',\n        style: {\n          \"background-color\": this.p('global', 'negative')\n        }\n      },\n      {\n        selector: 'node.InteractorOccurrences.hover',\n        style: {\n          \"border-width\": this.pm('global', 'thickness', t => t * 1),\n          \"border-color\": this.p('global', 'hoverNode'),\n        }\n      },\n      {\n        selector: 'node.InteractorOccurrences.select',\n        style: {\n          \"border-width\": this.pm('global', 'thickness', t => t * 1),\n          \"border-color\": this.p('global', 'selectNode'),\n        }\n      },\n      {\n        selector: 'node.Interactor',\n        style: {\n          \"label\": \"data(displayName)\",\n          \"font-family\": \"Roboto Mono, monospace\",\n          // \"border-color\": this.p('interactor', 'stroke'),\n          \"border-width\": this.p('global', 'thickness'),\n          \"text-wrap\": \"ellipsis\",\n          \"border-color\": this.p('interactor', 'fill'),\n          //@ts-ignore\n          \"border-position\": 'inside'\n        }\n      },\n\n      {\n        selector: 'node.PhysicalEntity.disease',\n        style: {\n          \"border-color\": this.p('global', 'negativeContrast'),\n          \"color\": this.p('global', 'negativeContrast'),\n          \"border-width\": this.p('global', 'thickness'),\n        }\n      },\n\n      {\n        selector: 'node.Interactor.disease',\n        style: {\n          \"shape\": \"round-hexagon\",\n          \"background-color\": this.p('global', 'negative'),\n          \"background-opacity\": 0,\n          \"border-width\": 0,\n          \"font-family\": \"Roboto Mono, monospace\",\n          \"color\": this.p('global', 'onPrimary'),\n          \"text-wrap\": \"ellipsis\",\n          \"text-max-width\": (node: cytoscape.NodeSingular) => (node.width() - 40) + 'px',\n        }\n      },\n      {\n        selector: 'node.Protein',\n        style: {\n          \"shape\": \"round-rectangle\",\n          \"background-color\": this.p('protein', 'fill')\n        }\n      }, {\n        selector: 'node.Protein.drug',\n        style: {\n          \"background-color\": this.p('protein', 'drug')\n        }\n      }, {\n        selector: 'node.GenomeEncodedEntity',\n        style: {\n          \"shape\": \"round-rectangle\",\n          \"background-opacity\": 0,\n          \"background-color\": this.p('genomeEncodedEntity', 'fill'),\n          \"text-margin-y\": this.pm('genomeEncodedEntity', 'topRadius', r => r / 10),\n          \"border-width\": 0 // Avoid disease border\n        }\n      }, {\n        selector: 'node.RNA',\n        style: {\n          \"shape\": \"bottom-round-rectangle\",\n          \"background-color\": this.p('rna', 'fill'),\n        }\n      }, {\n        selector: 'node.RNA.drug',\n        style: {\n          \"background-color\": this.p('rna', 'drug'),\n        }\n      }, {\n        selector: 'node.Gene',\n        style: {\n          \"shape\": \"bottom-round-rectangle\",\n          \"background-opacity\": 0,\n          \"background-color\": this.p('gene', 'fill'),\n          \"bounds-expansion\": this.p('gene', 'decorationExtraWidth'),\n          \"text-margin-y\": this.pm('gene', 'decorationHeight', h => h / 2),\n          \"border-width\": 0 // Avoid disease border\n        }\n      }, {\n        selector: 'node.Molecule',\n        style: {\n          \"shape\": 'round-rectangle',\n          \"color\": this.p(\"molecule\", 'stroke'),\n          \"background-color\": this.p(\"molecule\", 'fill'),\n          \"border-color\": this.p(\"molecule\", 'stroke'),\n          \"border-width\": this.p(\"global\", 'thickness'),\n          // @ts-ignore\n          \"corner-radius\": (node: cytoscape.NodeSingular) => Math.min(node.data('width'), node.data('height')) / 2,\n        }\n      }, {\n        selector: 'node.Molecule.drug',\n        style: {\n          \"color\": this.p(\"molecule\", 'drug'),\n          \"border-color\": this.p(\"molecule\", 'drug'),\n        }\n      }, {\n        selector: 'node.Molecule.Interactor',\n        style: {\n          \"border-color\": this.p(\"interactor\", 'fill'),\n        }\n      }, {\n        selector: 'node.EntitySet',\n        style: {\n          \"background-opacity\": 0,\n          \"shape\": \"round-rectangle\",\n          \"border-width\": 0, // Avoid disease border\n          \"text-max-width\": (node: cytoscape.NodeSingular) =>\n            this.pm('global', 'thickness', t =>\n              this.pm('entitySet', 'radius', r => `${node.width() - 2 * r - 6 * t}px`\n              )\n            )\n        }\n      }, {\n        selector: 'node.EntitySet.drug',\n        style: {\n          \"text-max-width\": (node: cytoscape.NodeSingular) =>\n            this.pm('global', 'thickness', t =>\n              this.pm('entitySet', 'radius', r => `${node.width() - 2 * r - 6 * t - 44}px`\n              )\n            )\n        }\n      }, {\n        selector: 'node.Complex',\n        style: {\n          \"shape\": \"cut-rectangle\",\n          \"text-max-width\": (node: cytoscape.NodeSingular) => this.pm('global', 'thickness', t => (node.width() - t * 6) + 'px'),\n          \"background-opacity\": 0,\n          \"border-width\": 0, // Avoid disease border\n\n          // \"background-color\": this.p(\"complex\", 'fill'),\n          // \"width\": (node: cytoscape.NodeSingular) => this.pm('global', 'thickness', t => node.data('width') -  2 * t) ,\n          // \"height\": (node: cytoscape.NodeSingular) => this.pm('global', 'thickness', t => node.data('height') -  2 * t) ,\n          // // @ts-ignore\n          // \"corner-radius\": this.pm('complex', 'cut', c => c),\n          // \"outline-width\":  this.p('global', 'thickness'),\n          // \"outline-color\":  this.p('complex', 'fill'),\n          // \"outline-offset\":  this.pm('global', 'thickness', t => - t),\n          // \"outline-opacity\":  1,\n          //\n          // // \"border-position\": 'inside',\n          // \"border-join\": 'round',\n          // \"border-color\": this.p('complex', 'stroke'),\n          // \"border-width\": this.p('global', 'thickness'),\n        }\n      }, {\n        selector: 'node.Complex.drug',\n        style: {\n          \"text-margin-x\": 4,\n          \"text-max-width\": (node: cytoscape.NodeSingular) => this.pm('global', 'thickness', t => (node.width() - t * 6 - 44) + 'px')\n        }\n      }, {\n        selector: 'node.Cell',\n        style: {\n          \"background-opacity\": 0,\n          \"shape\": \"round-rectangle\",\n          // @ts-ignore\n          \"corner-radius\": 999999,\n          \"border-width\": 0, // Avoid disease border\n\n          \"text-max-width\": (node: cytoscape.NodeSingular) =>\n            this.pm('global', 'thickness', t => this.pm('cell', 'thickness', ct => (node.width() - t * 2 - ct * 2) + 'px'))\n        }\n      },\n      {\n        selector: 'node.Pathway',\n        style: {\n          \"background-color\": this.p('pathway', 'fill'),\n          \"text-margin-x\": 18,\n          \"border-color\": this.p('pathway', 'stroke'),\n          // @ts-ignore\n          \"border-position\": \"inside\",\n          \"border-width\": this.pm('global', 'thickness', t => 3 * t),\n        }\n      },\n      {\n        selector: 'node.Interacting.Pathway',\n        style: {\n          \"shape\": \"rectangle\",\n          \"text-max-width\": (node: cytoscape.NodeSingular) =>\n            this.pm('global', 'thickness', t => `${node.width() - (6 * t + 36) * 2}px`\n            ),\n        }\n      },\n      {\n        selector: 'node.SUB.Pathway',\n        style: {\n          //@ts-ignore\n          \"corner-radius\": 99999,\n          \"shape\": 'round-rectangle',\n          \"text-max-width\": (node: cytoscape.NodeSingular) =>\n            this.pm('global', 'thickness', t => `${node.width() - (6 * t + 36) * 2}px`\n            ),\n        }\n      }, {\n        selector: 'node.Pathway.disease',\n        style: {\n          \"border-color\": this.p('global', 'negativeContrast'),\n          \"color\": this.p('global', 'negativeContrast'),\n        }\n      }, {\n        selector: 'node.Modification',\n        style: {\n          \"background-color\": this.p('modification', 'fill'),\n          \"shape\": 'round-rectangle'\n        }\n      },\n\n\n      {\n        selector: 'node.reaction',\n        style: {\n          \"width\": this.pm('global', 'thickness', t => t * 6),\n          \"height\": this.pm('global', 'thickness', t => t * 6),\n          \"shape\": \"round-rectangle\",\n          \"text-halign\": \"center\",\n          \"text-valign\": \"center\",\n          \"border-width\": this.p('global', 'thickness'),\n          \"border-color\": this.p('global', 'onSurface'),\n          \"color\": this.p('global', 'onSurface'),\n          \"background-color\": this.p('global', 'surface'),\n        }\n      }, {\n        selector: 'node.reaction[?displayName]',\n        style: {\n          \"label\": \"data(displayName)\",\n          \"font-weight\": 400,\n          \"text-valign\": \"top\",\n          \"text-margin-y\": -5,\n        }\n      }, {\n        selector: 'node.reaction.hover',\n        style: {\n          \"border-width\": this.pm('global', 'thickness', t => t * 1),\n          \"border-color\": this.p('global', 'hoverEdge'),\n        }\n      }, {\n        selector: 'node.reaction:selected',\n        style: {\n          \"border-width\": this.pm('global', 'thickness', t => t * 1.5),\n          \"border-color\": this.p('global', 'selectEdge'),\n        }\n      }, {\n        selector: 'node.reaction.flag',\n        style: {\n          // @ts-ignore\n          \"outline-width\": this.pm('global', 'thickness', t => t * 1.5),\n          \"outline-color\": this.p('global', 'flag'),\n        }\n      }, {\n        selector: 'node.association',\n        style: {\n          \"shape\": \"ellipse\",\n          \"background-color\": this.p('global', 'onSurface'),\n        }\n      }, {\n        selector: 'node.dissociation',\n        style: {\n          \"shape\": \"ellipse\",\n          \"border-style\": \"double\",\n          \"border-width\": this.pm('global', 'thickness', t => 3 * t)\n        }\n      }, {\n        selector: 'node.uncertain',\n        style: {\n          \"label\": \"?\",\n          \"text-valign\": \"center\",\n          \"text-margin-y\": 0,\n          \"font-weight\": 600\n        }\n      }, {\n        selector: 'node.omitted',\n        style: {\n          \"background-image\": OMMITED_ICON(this.properties),\n          \"background-fit\": \"cover\",\n          \"background-height\": \"100%\",\n          \"background-width\": \"100%\",\n        }\n      }, {\n        selector: 'node.loss-of-function',\n        style: {\n          \"border-style\": 'dashed',\n          //@ts-ignore\n          \"border-dash-pattern\": this.pm('global', 'thickness', t => [t, t * 2]),\n          \"border-cap\": \"round\"\n        }\n      },\n\n\n      // {\n      //   selector: 'node.RNA.Interactor, node.Protein.Interactor',\n      //   style: {\n      //     \"border-color\": this.p('interactor', 'fill'),\n      //     \"border-width\": this.p('global', 'thickness'),\n      //\n      //   }\n      // },\n      // {\n      //   selector: 'node.Molecule.Interactor',\n      //   style: {\n      //     \"color\": this.p(\"molecule\", 'stroke'),\n      //     \"background-color\": this.p(\"molecule\", 'fill'),\n      //     \"border-color\": this.p(\"interactor\", 'stroke'),\n      //     \"border-width\": this.p(\"global\", 'thickness'),\n      //     // @ts-ignore\n      //     \"corner-radius\": (node: cytoscape.NodeSingular) => Math.min(node.data('width'), node.data('height')) / 2,\n      //   }\n      // },\n\n\n      {\n        selector: 'edge',\n        style: {\n          \"curve-style\": \"straight\",\n          \"line-cap\": \"round\",\n          \"source-endpoint\": \"outside-to-node\",\n          \"arrow-scale\": 1.5,\n\n          'width': this.p('global', 'thickness'),\n          'color': this.p('global', 'onSurface'),\n          'line-color': this.p('global', 'onSurface'),\n          'target-arrow-color': this.p('global', 'onSurface'),\n          'mid-source-arrow-color': this.p('global', 'onSurface'),\n          'mid-target-arrow-color': this.p('global', 'onSurface'),\n          'source-arrow-color': this.p('global', 'onSurface'),\n          // @ts-ignore\n          'source-arrow-width': '100%',\n          // @ts-ignore\n          'target-arrow-width': '100%',\n        }\n      }, {\n        selector: 'edge.disease',\n        style: {\n          \"color\": this.p('global', 'negative'),\n          \"line-color\": this.p('global', 'negative'),\n          \"border-color\": this.p('global', 'negative'),\n          'target-arrow-color': this.p('global', 'negative'),\n          'source-arrow-color': this.p('global', 'negative'),\n        }\n      }, {\n        selector: \"edge.hover\",\n        style: {\n          \"line-color\": this.p('global', 'hoverEdge'),\n          \"width\": this.pm('global', 'thickness', t => t * 1.5),\n          \"arrow-scale\": 1,\n          \"source-arrow-color\": this.p('global', 'hoverEdge'),\n          \"target-arrow-color\": this.p('global', 'hoverEdge'),\n          // @ts-ignore\n          'source-arrow-width': '50%',\n          // @ts-ignore\n          'target-arrow-width': '50%',\n          \"z-index\": 2\n        }\n      }, {\n        selector: \"edge:selected\",\n        style: {\n          \"line-color\": this.p('global', 'selectEdge'),\n          \"width\": this.pm('global', 'thickness', t => t * 2),\n          \"arrow-scale\": 1,\n          \"source-arrow-color\": this.p('global', 'selectEdge'),\n          \"target-arrow-color\": this.p('global', 'selectEdge'),\n          // @ts-ignore\n          'source-arrow-width': '50%',\n          // @ts-ignore\n          'target-arrow-width': '50%',\n          \"z-index\": 3\n        }\n      },\n      {\n        selector: 'edge.consumption',\n        style: {\"target-endpoint\": \"inside-to-node\", \"source-endpoint\": \"outside-to-node\"}\n      }\n      , {\n        selector: 'edge.production',\n        style: {'target-arrow-shape': 'triangle'}\n      }, {\n        selector: 'edge.catalysis',\n        style: {\n          'target-arrow-shape': 'circle',\n          \"target-arrow-fill\": \"hollow\",\n          \"target-arrow-color\": this.p('global', 'positive')\n        }\n      }, {\n        selector: 'edge.positive-regulation',\n        style: {\n          'target-arrow-shape': 'triangle',\n          \"target-arrow-fill\": \"hollow\",\n          \"target-arrow-color\": this.p('global', 'positive')\n        }\n      }, {\n        selector: 'edge.negative-regulation',\n        style: {\n          'target-arrow-shape': 'tee',\n          \"line-cap\": \"butt\",\n          \"source-endpoint\": \"inside-to-node\",\n          \"target-arrow-color\": this.p('global', 'negative')\n        }\n      }, {\n        selector: 'edge.set-to-member',\n        style: {'target-arrow-shape': 'circle', \"line-style\": \"dashed\", \"line-dash-pattern\": [6, 10], \"opacity\": 0.5}\n      }, {\n        selector: 'edge[stoichiometry > 1]',\n        style: {\n          \"text-background-color\": this.p('global', 'surface'),\n          \"text-background-opacity\": 1,\n          \"text-border-width\": this.pm('global', 'thickness', t => t / 2),\n          \"text-border-opacity\": 1,\n          \"text-border-color\": this.p('global', 'onSurface'),\n          \"text-background-shape\": 'roundrectangle',\n          \"text-background-padding\": this.pm('global', 'thickness', t => t + 'px'),\n        }\n      }, {\n        selector: 'edge[stoichiometry > 1].incoming',\n        style: {\n          \"source-label\": \"data(stoichiometry)\",\n          \"source-text-offset\": 30,\n        }\n      }, {\n        selector: 'edge[stoichiometry > 1].outgoing',\n        style: {\n          \"target-label\": \"data(stoichiometry)\",\n          \"target-text-offset\": 35,\n        }\n      }, {\n        selector: \"edge.shadow[?color]\",\n        style: {\n          // @ts-ignore\n          \"underlay-color\": \"data(color)\",\n          \"underlay-padding\": this.p('shadow', 'padding'),\n          \"underlay-opacity\": this.pm('shadow', 'opacity', o => o[0][1] / 100),\n        }\n      }, {\n        selector: \"edge.flag\",\n        style: {\n          // @ts-ignore\n          \"underlay-color\": this.p('global', 'flag'),\n          \"underlay-padding\": 10,\n          \"underlay-opacity\": 1,\n        }\n      }, {\n        selector: \"edge[?weights]\",\n        style: {\n          // @ts-ignore\n          \"curve-style\": \"round-segments\",\n          \"segment-distances\": \"data(distances)\",\n          \"segment-weights\": \"data(weights)\",\n          \"segment-radius\": 30,\n          \"radius-type\": 'influence-radius',\n          // @ts-ignore\n          \"edge-distances\": \"endpoints\",\n        }\n      }, {\n        selector: \"edge[?sourceEndpoint]\",\n        style: {\n          // @ts-ignore\n          \"source-endpoint\": \"data(sourceEndpoint)\",\n        }\n      }, {\n        selector: \"edge[?targetEndpoint]\",\n        style: {\n          // @ts-ignore\n          \"target-endpoint\": \"data(targetEndpoint)\",\n        }\n      }, {\n        selector: \"edge[?sourceLabel]\",\n        style: {\n          \"source-label\": \"data(sourceLabel)\",\n          \"source-text-margin-y\": -12,\n          \"font-weight\": 400\n        }\n      }, {\n        selector: \"edge[?label]\",\n        style: {\n          \"label\": \"data(label)\",\n          \"text-margin-y\": 12,\n          \"font-weight\": 400\n        }\n      },\n      {\n        selector: 'edge.Interactor',\n        style: {\n          'line-color': this.p('interactor', 'stroke'),\n          'line-style': 'dashed',\n          'line-dash-pattern': [1, 8]\n        }\n      },\n      {\n        selector: 'edge.Interactor.disease',\n        style: {\n          'line-color': this.p('global', 'negativeContrast'),\n        }\n      },\n      {\n        selector: 'edge.Interactor.hover',\n        style: {\n          \"line-color\": this.p('global', 'hoverEdge')\n        }\n      },\n      {\n        selector: \"edge[?sourceOffset]\",\n        style: {\n          // @ts-ignore\n          \"source-text-offset\": \"data(sourceOffset)\",\n        }\n      },\n      {\n        selector: \"[?labelColor]\",\n        style: {\n          \"color\": (e: cytoscape.EdgeSingular) => extract(this.p('global', e.data(\"labelColor\")))\n        }\n      }, {\n        selector: \"node.debug\",\n        style: {\n          label: \"data(id)\",\n          \"text-outline-width\": 4,\n          \"text-outline-color\": 'black',\n          \"text-outline-opacity\": 1,\n          color: 'white'\n        }\n      },\n      {\n        selector: \"[?exp]\",\n        style: {\n          \"color\": this.p('global', 'surface'),\n          \"text-outline-width\": 2,\n          \"text-outline-color\": this.p('global', 'onSurface'),\n          \"text-outline-opacity\": 1,\n        }\n      },\n      {\n        selector: \"[?exp].Molecule\",\n        style: {\n          \"background-color\": this.p('global', 'onSurface')\n        }\n      },\n\n      {\n        selector: \"node.Legend.Label\",\n        style: {\n          \"label\": \"data(displayName)\",\n          \"text-halign\": \"center\",\n          \"text-valign\": \"center\",\n          \"font-size\": 24,\n          \"font-weight\": 400,\n          \"background-opacity\": 0,\n          \"color\": this.p('global', 'onSurface')\n        }\n      },\n      {\n        selector: \"node.Legend.Placeholder\",\n        style: {\n          \"background-opacity\": 0,\n          \"border-opacity\": 0,\n          width: 20,\n          height: 20,\n          shape: \"rectangle\"\n        }\n      },\n      {\n        selector: \"node.Legend.Placeholder[?displayName]\",\n        style: {\n          \"label\": \"data(displayName)\",\n          \"font-weight\": 400,\n        }\n      },\n      {\n        selector: '.trivial',\n        style: {\n          'opacity': 0,\n        }\n      },\n    ]\n  }\n\n  clearCache() {\n    this.imageBuilder.cache.clear!()\n    clearDrawersCache();\n  }\n\n  update(cy: cytoscape.Core) {\n    this.clearCache();\n    cy.style(this.getStyleSheet());\n    this.initSubPathwayColors();\n    this.interactivity.triggerZoom();\n  }\n\n  loadAnalysis(cy: cytoscape.Core, palette: Scale) {\n\n\n    // const paletteDef: [number, string][] | string = paletteType === 'unidirectional' ? extract(this.properties.analysis.unidirectionalPalette) : extract(this.properties.analysis.bidirectionalPalette);\n\n    // if (typeof paletteDef !== \"string\") {\n    //   this.currentPalette = scale(paletteDef.map(e => e[1]))\n    //     .domain(paletteDef.map(e => e[0]))\n    //     .mode('oklab')\n    // } else {\n      this.currentPalette = palette\n    // }\n\n    this.imageBuilder.cache.clear!();\n    resetGradients()\n    cy.style(this.getStyleSheet());\n  }\n}\n","/*\n * Public API Surface of reactome-cytoscape-style\n */\n\nexport {Style} from './lib/style';\nexport {UserProperties} from './lib/properties';\nexport {Interactivity} from './lib/interactivity';\nexport * as Types from './lib/types';\nexport {ReactomeEvent, ReactomeEventTarget} from './lib/model/reactome-event.model';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["ReactomeEventTypes","ReactomeEvent","CustomEvent","constructor","type","target","detail","isProvider","property","apply","undefined","extract","defaultable","object","setDefault","key","defaultValue","propertyExtractor","properties","group","propertyMapper","mapper","RouterModule","DiagramComponent","DiagramIteratorComponent","legacyGuard","routes","path","component","canActivate","runGuardsAndResolvers","AppRoutingModule","_","_2","_3","forRoot","bindToComponentInputs","imports","i1","exports","AppComponent","title","selectors","decls","vars","template","AppComponent_Template","rf","ctx","i0","element","BrowserModule","FormsModule","ReactiveFormsModule","CommonModule","HttpClientModule","RouterOutlet","BrowserAnimationsModule","MatButtonModule","MatSlideToggleModule","CdkDrag","CdkDragHandle","MatInputModule","MatSelectModule","MatProgressSpinnerModule","CustomInteractorDialogComponent","MatDialogModule","MatTabsModule","MatCheckboxModule","MatRadioModule","NgxMatFileInputModule","MatIconModule","MatListModule","AppModule","bootstrap","declarations","combineLatest","route","client","router","diagramId","diagramIndex","diagramIds","ngAfterViewInit","params","get","responseType","subscribe","diagrams","split","filter","s","length","next","previous","directiveInject","ActivatedRoute","i2","HttpClient","Router","viewQuery","DiagramIteratorComponent_Query","elementStart","listener","DiagramIteratorComponent_Template_div_keydown_arrowLeft_0_listener","DiagramIteratorComponent_Template_div_keydown_arrowRight_0_listener","DiagramIteratorComponent_Template_button_click_3_listener","text","elementEnd","DiagramIteratorComponent_Template_input_ngModelChange_8_listener","$event","DiagramIteratorComponent_Template_button_click_9_listener","advance","property","cytoscape","Style","delay","distinctUntilChanged","forkJoin","share","Subject","take","tap","FormControl","UntilDestroy","ResourceType","isDefined","brewer","scale","style","MatFormField","ctx_r11","paletteOptions","palette_r12","styleProp","tmp_1_0","gradient","template","DiagramComponent_ng_container_35_mat_optgroup_1_mat_option_3_Template","textInterpolate","group_r9","name","palettes","elementContainerStart","DiagramComponent_ng_container_35_mat_optgroup_1_Template","elementContainerEnd","valid","DiagramComponent_mat_option_43_Template_mat_option_click_0_listener","restoreView","_r17","nextContext","_r6","reference","resetView","open","DiagramComponent_mat_option_43_mat_spinner_5_Template","resource_r14","active","ctx_r7","isDataFromPsicquicLoading","selectedPsicquicResource","value","DiagramComponent_mat_selection_list_51_mat_list_option_1_Template_mat_list_option_click_0_listener","restoredCtx","_r21","resourceToken_r19","$implicit","ctx_r20","onCustomResourceChange","DiagramComponent_mat_selection_list_51_mat_list_option_1_Template_button_click_4_listener","ctx_r22","deleteResource","ctx_r18","isSelected","token","summary","DiagramComponent_mat_selection_list_51_mat_list_option_1_Template","ctx_r8","resourceTokens","PaletteSummary","_scale","mode","join","classes","n","colors","map","c","i","domain","min","max","diagram","dark","interactorsService","state","dialog","cdr","analysis","comparing","fit","psicquicResources","cys","Map","Object","keys","toLowerCase","palette","classRegex","ratio","replacedElementsPosition","lastIndex","underlayPadding","syncing","syncViewports","source","sourceContainer","targetContainer","updateReplacementVisibility","position","pan","sourceX","getBoundingClientRect","x","targetX","viewport","zoom","compareDragging","_reactomeEvents$","_ignore","reactomeEvents$","asObservable","pipe","prev","current","reactomeId","e","console","log","element","data","cy","container","id","flagging","onChange","flag$","forEach","flag","selecting","select$","select","interactoring","overlay$","getInteractors","analysing","analysis$","loadAnalysis","compareBackgroundSync","legend","event","src","tgt","cyCompare","replacedBy","replacements","getElementById","add","elements","applyEvent","interactorOpeningHandling","close","includes","reactomeStyle","reactomeStyleCompare","occurrenceNode","nodes","addInteractorNodes","removeInteractorNodes","interactivity","updateProteins","triggerZoom","initialiseReplaceElements","diagram2legend","matchingElement","not","reaction","first","connectedEdges","diagramSelect2state","reactomeIds","el","set","legend2state","unselect","hover","addClass","leave","removeClass","ngOnChanges","changes","loadDiagram","$dark","updateStyle","bind","cytoscapeContainer","nativeElement","compareContainer","legendContainer","values","addEventListener","shadow","padding","getLegend","getStyleSheet","layout","boxSelectionEnabled","bindToCytoscape","zoomingEnabled","panningEnabled","minZoom","bb","boundingBox","getPsicquicResources","getDiagram","some","node","edges","edge","clearCache","on","navigate","queryParamsHandling","loadCompare","stateToDiagram","batch","getPosition","is","x1","replacedElements","sort","a","b","toArray","addedElement","index","findIndex","splice","removedElement","indexOf","remove","maxZoom","setTimeout","getElements","tokens","collection","startsWith","or","matchArray","match","clazz","drug","and","selected","connectedNodes","accs","flagElements","toFlag","shadowNodes","shadowEdges","trivials","nonempty","setSubPathwayVisibility","visible","opacity","onZoom","off","affectedElements","extent","limitIndex","slice","resource","isCustom","isCustomResource","isPsicquic","pr","STATIC","r","reset","getInteractorData","interactors","addInteractorOccurrenceNode","resources","onPsicquicResourceChange","selectedResource","psicquicSelect","openCustomInteractorDialog","dialogRef","restoreFocus","afterClosed","result","componentInstance","push","detectChanges","sendPostRequest","removeData","fontSize","fontPadding","entities","foundEntities","pathways","pathwaysResults","p","result$","analysisProfile","analysisIndex","expNames","analysisEntityMap","flatMap","entity","mapsTo","diagramEntity","ids","exp","analysisPathwayMap","dbId","normalize","expression","hasExpression","leaves","leaf","identifier","pathwayData","pValue","found","total","validGroups","Set","has","changePalette","update","dragStart","dragEnd","dragMove","resize","updateLegend","logProteins","debug","analyse","example","DiagramService","DarkService","i3","InteractorService","i4","DiagramStateService","i5","MatDialog","ChangeDetectorRef","i6","AnalysisService","i7","DiagramComponent_Query","DiagramComponent_Template_div_mouseup_6_listener","DiagramComponent_Template_div_mouseleave_6_listener","DiagramComponent_Template_div_mousemove_6_listener","_r23","_r2","DiagramComponent_Template_span_mousedown_7_listener","DiagramComponent_Template_div_cdkDragMoved_11_listener","DiagramComponent_Template_button_click_17_listener","DiagramComponent_Template_button_click_19_listener","DISGENET","DiagramComponent_Template_button_click_21_listener","DiagramComponent_Template_button_click_23_listener","DiagramComponent_Template_button_click_25_listener","DiagramComponent_Template_button_click_27_listener","DiagramComponent_Template_mat_select_valueChange_32_listener","DiagramComponent_Template_mat_select_selectionChange_32_listener","DiagramComponent_ng_container_35_Template","DiagramComponent_Template_mat_select_selectionChange_39_listener","DiagramComponent_mat_option_43_Template","DiagramComponent_Template_button_click_44_listener","DiagramComponent_Template_mat_slide_toggle_ngModelChange_46_listener","isDark","DiagramComponent_mat_selection_list_51_Template","classProp","pureFunction1","_c4","_r0","clientHeight","tmp_14_0","pipeBind1","__decorate","checkProperties","inject","URL_PATTERN","fragment","queryParams","groups","param","Validators","merge","takeUntilDestroyed","MAT_DIALOG_DATA","InputCategory","Resource","ctx_r0","errorMessage","item_r6","i_r7","textInterpolate1","content","CustomInteractorDialogComponent_mat_form_field_15_Template_ngx_mat_file_input_change_1_listener","_r9","onFileChange","interactorService","fb","required","pattern","tabId","selectedValue","isDataLoading","items","formGroupValidator","control","fileValue","form","contentValue","urlValue","url","psicquicUrlValue","psicquicUrl","invalid","resourceForm","validators","statusChanges","valueChanges","updateErrorMessage","ngOnInit","hasError","onTabChange","tab","ariaLabelledby","onItemChange","inputElement","files","file","patchValue","submit","userInput","getInputs","getInteractorsFromToken","input","formValue","UPLOAD_URL","prepareFormData","UPLOAD_PSICQUIC_URL","formControl","formData","FormData","append","MatDialogRef","FormBuilder","consts","CustomInteractorDialogComponent_Template","CustomInteractorDialogComponent_Template_input_blur_8_listener","CustomInteractorDialogComponent_mat_error_9_Template","CustomInteractorDialogComponent_Template_mat_tab_group_selectedTabChange_10_listener","CustomInteractorDialogComponent_Template_mat_radio_group_change_13_listener","CustomInteractorDialogComponent_mat_radio_button_14_Template","CustomInteractorDialogComponent_mat_form_field_15_Template","CustomInteractorDialogComponent_mat_form_field_16_Template","CustomInteractorDialogComponent_mat_form_field_17_Template","CustomInteractorDialogComponent_Template_button_click_29_listener","CustomInteractorDialogComponent_mat_spinner_32_Template","tmp_2_0","tmp_7_0","InteractorsLayout","MAX_INTERACTORS","BOX_WIDTH","BOX_HEIGHT","_4","SEPARATION","Math","round","_5","MIN_HEIGHT","_6","MIN_WIDTH","getNumberOfInteractorsToDraw","getSegmentOrigin","edgeIndex","center","width","height","y","getCentre","minX","maxX","minY","maxY","interpolateInLayout","segment","pos","totalPositions","from","to","targetNode","interactorIndex","numberToDraw","centerPosition","lp","LayoutParameter","calculate","edgeNodes","nodeOnTop","nodeCount","prevNodeCount","nodePerEdges","nodeOnRight","nodeOnBottom","nodeOnLeft","edgePos","rationalNodePerEdge","baseNodePerEdge","floor","remaining","HttpHeaders","HttpParams","switchMap","environment","http","diagramService","PREFIX_INTERACTOR","host","PREFIX_DISEASE","STATIC_URL","PSICQUIC_RESOURCE_URL","PSICQUIC_URL","TOKEN_URL","DISGENET_URL","DEFAULT_INTERACTOR_WIDTH","DEFAULT_DISGENET_WIDTH","INTERACTOR_PADDING","CHAR_WIDTH","CHAR_HEIGHT","GENE_DECORATION_HEIGHT","identifiers","cyToSelectedResource","getAllIdentifiers","getIdentifiersFromGraph","updateIdentifiersIfNeeded","graphNodes","schemaClass","post","headers","previousResource","createInteractorOccurrenceNode","interactorEntity","count","acc","entityNode","displayName","pannable","grabbable","closedNeighborhood","interactor","empty","interactorsData","numberToAdd","dynamicInteractors","existingInteractors","getAllInteractors","allNodes","createInteractorNodes","createInteractorEdges","displayInteractors","diagramNodes","existingNodes","interactorNodes","interactorLayout","alias","defaultType","nodeTypeMap","replace","html","getStructureVideoHtml","accURL","score","evidences","evidenceURLs","evidencesURL","selectable","resourceClass","interactorEdges","targetNodes","edgeToTarget","interactorsToDisplay","layoutOptions","run","removeInteractorEdges","edgesToRemove","getInteractorToken","body","getInteractorsWithToken","psiResource","isFromPSICQUIC","inject","factory","fac","providedIn","catchError","of","state$","pathway","foundInteractors","pathwayIds","BehaviorSubject","_isDark","$_dark","_body","document","querySelector","localValue","localStorage","getItem","JSON","parse","window","matchMedia","media","matches","setItem","stringify","classList","isArray","isBoolean","propagate","otherTokens","flagInteractors","overlay","_state$","reduce","prop","v1","v2","toString","v","queryParamMap","mainToken","find","formerValue","rawValue","charAt","parseInt","onPropertyModified","entries","Array","array","cytoscapeFcose","use","posToStr","pointToStr","point","equal","pos1","pos2","avg","positions","sum","squaredDist","pow","dist","sqrt","closestToAverage","average","closest","extraLine","reverseExtraLine","reactionTypeMap","edgeTypeMap","edgeTypeToStr","linkClassMap","COMPARTMENT_SHIFT","random","pick","getNormalPathway","graph","forNormalDraw","stableId","normalPathwayId","normalDiagram","normalGraph","shadows","isFadeOut","subpathways","err","mergedResponse","reactionType","connectors","con","renderableClass","links","link","idToEdges","idToNodes","reactomeIdToEdge","edgeIds","forwardArray","segments","assert","size","backwardArray","subpathwayIds","eventIdToSubPathwayId","subpathway","events","entry","subpathwayIdToEventIds","dbIdToGraphNode","mappingList","children","idToGraphNodes","idToGraphEdges","getLeaves","child","dbIdToGraphEdge","hasFadeOut","normalNodes","specialNodes","posToNormalNode","posToSpecialNode","normalEdges","specialEdges","posToNormalEdge","posToSpecialEdge","compartmentNodes","compartments","item","propToRects","left","top","right","bottom","innerCR","outerCR","insets","rects","smallest","abs","Number","MAX_SAFE_INTEGER","layers","textX","textPosition","textY","radius","replacementMap","reactionNodes","replacement","inputs","output","outputs","isBackground","reactionId","entityNodes","isDisease","isCrossed","trivial","needDashedBorder","overlapLimited","connector","preferredId","nodeAttachments","ptm","nodeId","nodeReactomeId","label","shape","centre","triggerPosition","avoidOverlap","T","ARROW_MULT","EDGE_MARGIN","REACTION_RADIUS","MIN_DIST","edgeId","reactionP","nodeP","sourceP","targetP","points","reverse","addEdgeInfo","shift","pop","endShape","relatives","absoluteToRelative","d","otherConnector","samePoint","getEdgeId","stoichiometry","weights","distances","sourceEndpoint","endpoint","targetEndpoint","linkEdges","uniprotId","s3","warn","direction","stop","stopPos","at","unshift","toConvert","mainVector","orthoVector","transform","inv","coord","absolute","relative","multiply","randomNetwork","amount","peTypes","reactionTypes","physicalEntities","parent","reactions","inOut","additionalIn","p1","p2","nodeA","nodeB","limit","rectA","getRect","rectB","o","area","overlap","rect","halfWidth","halfHeight","definitions","createElement","includeLabels","includeNodes","w","h","nodeRepulsion","animate","packComponents","randomize","tile","def","destroy","production","__NgCli_bootstrap_1","platformBrowser","bootstrapModule","catch","error","gene","disease","lossOfFunction","t","global","thickness","dHeight","decorationHeight","dWidth","decorationExtraWidth","headSize","arrowHeadSize","arrowRadius","fill","stroke","negativeContrast","selectNode","hoverNode","hh","borderRadius","oR","iR","t_2","t2","background","requireGradient","decorators","molecule","thick","ht","oRx","protein","rna","genomeEncodedEntity","complex","bottomR","bottomRadius","topR","topRadius","topOR","topIR","bottomOR","bottomIR","cut","cut2","delta","stateHeight","defs","entitySet","r2","bracesOffset","realDashLength","hidingLength","idealDashLength","dashNumber","t1_5","cell","cellThick","interactingPathway","realWidth","diseaseInteractor","negative","decorationWidth","t4","midH","subPathway","imageBuilder","memoize","classToDrawers","aggregate","defaultBg","provider","exps","drawerParams","hasClass","crossed","drawer","RX","Pathway","CROSS","expToGradient","currentPalette","l","addGradient","svgStr","isNumber","aggregated","svgText","_expToGradient","stops","notFoundColor","notFound","start","color","hex","resetGradients","cache","clear","svg","viewPortWidth","viewPortHeight","encodeURIComponent","dim","clearDrawersCache","OMMITED_ICON","toAggregate","onPrimary","onSurface","setDefaults","css","getPropertyValue","compartment","parseFloat","surface","modification","structure","font","features","Layers","Interactivity","applyToReaction","action","stateKey","reactionNode","expandReaction","margin","ungrabify","panify","initHover","initSelect","initClick","initStructureVideo","initStructureMolecule","initZoom","hoverReaction","col","deHoverReaction","dispatchEvent","mapped","selectReaction","openClass","eventType","toggleClass","isNode","_this","layersPlugin","videoLayer","renderPerNode","elem","render","init","innerHTML","display","video","throttle","isElementInViewport","readyState","HAVE_NOTHING","networkState","NETWORK_IDLE","load","visibility","uniqueElements","checkBounds","selector","updateOn","queryEachTime","_ref","_asyncToGenerator","videoId","videoElement","HAVE_ENOUGH_DATA","play","_x","arguments","pause","moleculeLayer","proteins","shadowLabels","labelOpacity","baseFontSize","structureOpacityArray","zoomStart","zoomEnd","zoomLevel","z","shadowLabelOpacity","interpolate","trivialOpacity","shadowOpacity","videoOpacity","maxWidth","P","lerp","p0","hovering","deHovering","innerHeight","documentElement","innerWidth","clientWidth","getComputedStyle","pm","initSubPathwayColors","subPathways","dH","chroma","hsl","luminosity","ct"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}